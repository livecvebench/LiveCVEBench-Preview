instruction: |-
  ImageMagick is a widely-used image processing library that supports reading and
  writing various image formats including BMP files.

  When processing certain malformed BMP files with extremely large width values
  (e.g., width=536870912) combined with high bits-per-pixel settings (32 bpp),
  the application crashes on 32-bit systems. The crash occurs during image loading
  before any actual pixel processing begins.

  Users report seeing either:
  - Segmentation faults during BMP file processing
  - Memory corruption errors
  - The process being terminated unexpectedly

  The issue appears to be related to dimension validation in the BMP decoder. The
  validation check that should catch these malformed dimensions seems to run too
  late in the processing pipeline, after arithmetic operations have already been
  performed on the dimension values.

  We expect the application to gracefully reject such malformed BMP files with an
  appropriate error message rather than crashing.

  Note: This affects 32-bit builds. To reproduce, ensure ImageMagick resource
  limits are increased (MAGICK_WIDTH_LIMIT, MAGICK_HEIGHT_LIMIT, MAGICK_AREA_LIMIT
  environment variables).

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: bug-fix
tags:
  - imagemagick
  - bmp
  - image-processing
  - validation
  - integer-arithmetic
parser_name: pytest

run_tests_in_same_shell: false
