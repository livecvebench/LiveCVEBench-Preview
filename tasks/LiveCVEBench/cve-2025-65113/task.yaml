instruction: |-
  ClipBucket v5 is an open-source video sharing platform that allows users to upload,
  share, and manage video content. The platform includes a content moderation system
  that allows users to flag inappropriate content for review.

  We've noticed that anyone can flag content on our site without being logged in.
  When I try to flag a video or user profile from an incognito browser window
  (where I'm not logged in), the flag still gets submitted successfully!

  This is a big problem because:
  - Trolls can mass-flag legitimate content without any accountability
  - We can't track who is submitting flags for moderation purposes
  - Our moderation queue is getting flooded with anonymous reports

  Expected behavior: The system should require users to be logged in before they
  can flag any content. If someone tries to flag content without being logged in,
  they should see an error message asking them to log in first.

  This affects all types of flagging - videos, photos, user profiles, and collections
  can all be flagged anonymously right now.

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: easy
category: bug-fix
tags:
  - php
  - authentication
  - ajax
  - authorization
parser_name: pytest
run_tests_in_same_shell: false
max_test_timeout_sec: 120.0
