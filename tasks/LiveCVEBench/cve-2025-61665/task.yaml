instruction: |-
  WeGIA is an open source web manager designed for charitable institutions to
  manage member information, donations, and institutional data.

  We have a member reports API endpoint at `/html/socio/sistema/get_relatorios_socios.php`
  that returns member data for generating reports. The endpoint accepts query parameters
  to filter results by member type, status, tag, and contribution amount.

  The problem is that this endpoint can be accessed by anyone without logging in.
  When we make a request like:

    GET /WeGIA/html/socio/sistema/get_relatorios_socios.php?tipo_socio=x&tipo_pessoa=x&operador=maior_q&valor=&tag=x&status=x

  It returns sensitive member information (names, phone numbers, identification
  numbers, email addresses, contribution amounts) as a JSON array without requiring
  any authentication.

  We expect that only authenticated users with appropriate permissions should be
  able to access member report data. Unauthenticated requests should receive an
  error response instead of the member data.

  The application already has an authentication system using PHP sessions and a
  permission system via the `permissao()` function. These should be used to protect
  this endpoint.

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: security
tags:
  - php
  - access-control
  - authentication
  - api
parser_name: pytest
run_tests_in_same_shell: false
