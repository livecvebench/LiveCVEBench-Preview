instruction: |-
  Soft Serve is a self-hostable Git server for the command line. The application
  allows repository administrators to configure webhooks that are triggered when
  certain events occur (such as pushes to a repository).

  When creating or updating webhooks via SSH (e.g., `ssh -p 23231 localhost webhook
  create my-repo http://example.com/hook --events push --active`), the server
  accepts any URL without proper validation. This means webhooks can be configured
  to point to internal network addresses like:
  - localhost or 127.0.0.1
  - Private network ranges (10.x.x.x, 172.16.x.x, 192.168.x.x)
  - Link-local addresses (169.254.x.x)

  When these webhooks are triggered, the server makes HTTP requests to these
  internal addresses, which could expose internal services or sensitive data.

  The application should validate webhook URLs before storing them. URLs pointing
  to localhost, private IP ranges, link-local addresses, or other reserved/internal
  IP addresses should be rejected with an appropriate error message like "webhook
  URL cannot resolve to private or internal IP addresses".

  Additionally, the HTTP client used to deliver webhooks should validate the
  resolved IP address before making the connection to prevent DNS rebinding attacks.

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: bug-fix
tags:
  - go
  - webhook
  - url-validation
  - input-validation
  - network
parser_name: pytest

run_tests_in_same_shell: false
max_test_timeout_sec: 120.0
