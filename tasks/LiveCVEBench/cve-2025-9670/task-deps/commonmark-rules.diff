--- .tmp/commonmark-rules-v7.2.0.js	2025-12-29 18:57:48
+++ .tmp/commonmark-rules-v7.2.2.js	2025-12-29 18:57:50
@@ -1,4 +1,4 @@
-import { repeat } from './utilities'
+import { repeat, trimNewlines } from './utilities'
 
 var rules = {}
 
@@ -39,8 +39,7 @@
   filter: 'blockquote',
 
   replacement: function (content) {
-    content = content.replace(/^\n+|\n+$/g, '')
-    content = content.replace(/^/gm, '> ')
+    content = trimNewlines(content).replace(/^/gm, '> ')
     return '\n\n' + content + '\n\n'
   }
 }
@@ -62,10 +61,6 @@
   filter: 'li',
 
   replacement: function (content, node, options) {
-    content = content
-      .replace(/^\n+/, '') // remove leading newlines
-      .replace(/\n+$/, '\n') // replace trailing newlines with just a single one
-      .replace(/\n/gm, '\n    ') // indent
     var prefix = options.bulletListMarker + '   '
     var parent = node.parentNode
     if (parent.nodeName === 'OL') {
@@ -73,8 +68,11 @@
       var index = Array.prototype.indexOf.call(parent.children, node)
       prefix = (start ? Number(start) + index : index + 1) + '.  '
     }
+    var isParagraph = /\n$/.test(content)
+    content = trimNewlines(content) + (isParagraph ? '\n' : '')
+    content = content.replace(/\n/gm, '\n' + ' '.repeat(prefix.length)) // indent
     return (
-      prefix + content + (node.nextSibling && !/\n$/.test(content) ? '\n' : '')
+      prefix + content + (node.nextSibling ? '\n' : '')
     )
   }
 }
