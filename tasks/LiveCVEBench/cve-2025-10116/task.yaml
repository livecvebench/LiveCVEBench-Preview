instruction: |-
  SiempreCMS is a lightweight content management system written in PHP. The admin
  panel includes a file upload feature at `/docs/admin/file_upload.php` that allows
  administrators to upload images and documents to the media directory.

  The upload endpoint accepts a `folder-path` parameter to specify the destination
  directory. However, users have reported that files can be uploaded to unexpected
  locations outside the designated media directory. For example, when uploading
  files with certain folder path values, the files appear in the modules directory
  or other unintended locations on the server.

  The upload feature should only allow files to be placed within the `/docs/media/`
  directory and its subdirectories. Any attempt to specify a path outside this
  directory should be rejected with an appropriate error message.

  The application runs with default credentials (admin/admin) for testing purposes.

difficulty: medium
category: security
tags:
  - php
  - file-upload
  - path-validation
  - cms
parser_name: pytest

run_tests_in_same_shell: false
