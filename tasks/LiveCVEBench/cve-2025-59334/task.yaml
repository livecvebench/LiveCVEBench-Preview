instruction: |-
  Linkr is a lightweight file distribution tool that downloads packages from web
  servers. It uses `.linkr` manifest files (JSON format) that describe a package's
  files with their download URLs and checksums. Users can extract packages by
  running `python Linkr.py extract <manifest.linkr> <output_folder>`.

  We've discovered an issue with how manifest files are handled during extraction.
  When a `.linkr` manifest file is modified after being created (e.g., by adding
  new file entries pointing to different URLs), the extractor processes all entries
  without detecting that the manifest has been altered. This means files could be
  downloaded from unintended sources if someone modifies the manifest between
  creation and extraction.

  For example, if a user receives a `.linkr` file and it gets modified in transit
  (additional file entries added, or URLs changed), the extractor will still
  download all files listed without any warning or verification that the manifest
  is authentic.

  Expected behavior: The extractor should verify that the manifest file has not
  been modified before processing it. The manifest should include a reference to
  its authoritative source (via a `LINKR_ADDRESS` field containing URLs where the
  original manifest is hosted), and the extractor should compare the local
  manifest's checksum against the remote copy before proceeding with extraction.

difficulty: medium
category: security
tags:
  - python
  - integrity-verification
  - file-distribution
parser_name: pytest

run_tests_in_same_shell: false
