instruction: |-
  File Browser is a web-based file management application written in Go. It allows
  users to manage files through a web interface and includes a command execution
  feature that lets administrators grant specific command access to users.

  The command execution feature is intended to allow only pre-approved commands from
  a user's allowlist. However, users report that when they have a command like "find"
  in their allowlist, they can execute additional unintended operations by passing
  arguments. For example, a user with only "find" in their allowlist can run:

    find . -exec whoami \; -quit

  This executes "whoami" even though it's not in the allowlist. The command allowlist
  validation is not working as expected - it appears to allow commands as long as
  the first word matches a pattern in the list, without properly restricting what
  arguments can be passed.

  Expected behavior: The command allowlist should enforce exact matching. If "find"
  is in the allowlist, only the literal command "find" (without additional arguments
  that can spawn other processes) should be permitted. Commands like "find -exec"
  that can execute arbitrary subcommands should be blocked.

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: bug-fix
tags:
  - go
  - command-validation
  - allowlist
  - file-browser
parser_name: pytest

run_tests_in_same_shell: false
