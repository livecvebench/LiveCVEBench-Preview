#!/bin/bash
# From ghcr.io/anonymous2578-data/cve-2025-24976:latest
# bash /workspace/fix-run.sh
set -e

cd /workspace/distribution
git apply --whitespace=nowarn /tests/test.patch 
go test -timeout 30s -run ^TestVerifyJWKWithTrustedKey$ github.com/distribution/distribution/v3/registry/auth/token

cd /workspace
#!/bin/bash
# From ghcr.io/anonymous2578-data/cve-2025-24976:latest
# bash /workspace/unit_test.sh
set -e

cd /workspace/distribution
go test -timeout 30s -run '^(TestTokenVerify|TestAccessController|TestLeeway|TestNewAccessControllerPemBlock)$' github.com/distribution/distribution/v3/registry/auth/token