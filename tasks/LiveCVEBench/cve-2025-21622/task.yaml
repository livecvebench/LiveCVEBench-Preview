instruction: |-
  This is a PHP video hosting platform that allows users to upload and manage video content.
  Users can customize their profiles by setting avatars, either by uploading image files or
  providing URLs to external images.

  There is a security issue in the avatar deletion functionality. When a user updates their
  profile to remove their avatar, the application deletes a file from the server's filesystem.
  However, the deletion logic uses untrusted user input to determine which file to delete,
  without properly validating or sanitizing the path. This allows malicious users to craft
  special input values that cause the application to delete files outside the intended
  avatars directory.

  For example, a user can set a crafted value containing path traversal sequences, and when
  they trigger avatar deletion, the application deletes an arbitrary file from the server
  rather than just their avatar image.

  Expected behavior: Avatar deletion should only remove files from the avatars directory and
  should not be able to affect files elsewhere on the system. The application should properly
  validate and restrict file paths to prevent unauthorized file deletion.

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: security
tags:
  - php
  - path-traversal
  - file-deletion
  - input-validation
parser_name: pytest

run_tests_in_same_shell: false
