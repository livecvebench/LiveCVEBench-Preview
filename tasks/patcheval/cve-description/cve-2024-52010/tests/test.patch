diff --git a/src/mod/sshprox/sshprox_test.go b/src/mod/sshprox/sshprox_test.go
new file mode 100644
index 0000000..3e562be
--- /dev/null
+++ b/src/mod/sshprox/sshprox_test.go
@@ -0,0 +1,58 @@
+package sshprox
+
+import (
+       "testing"
+)
+
+func TestCreateNewConnection(t *testing.T) {
+       tests := []struct {
+               username    string
+               remoteAddr  string
+               expectError bool
+       }{
+               {"validuser", "127.0.0.1", false},
+               {"valid.user", "example.com", false},
+               {"; bash ;", "example.com", true},
+               {"valid-user", "example.com", false},
+               {"invalid user", "127.0.0.1", true},
+               {"validuser", "invalid address", true},
+               {"invalid@user", "127.0.0.1", true},
+               {"validuser", "invalid@address", true},
+               {"injection; rm -rf /", "127.0.0.1", true},
+               {"validuser", "127.0.0.1; rm -rf /", true},
+               {"$(reboot)", "127.0.0.1", true},
+               {"validuser", "$(reboot)", true},
+               {"validuser", "127.0.0.1; $(reboot)", true},
+               {"validuser", "127.0.0.1 | ls", true},
+               {"validuser", "127.0.0.1 & ls", true},
+               {"validuser", "127.0.0.1 && ls", true},
+               {"validuser", "127.0.0.1 |& ls", true},
+               {"validuser", "127.0.0.1 ; ls", true},
+               {"validuser", "2001:0db8:85a3:0000:0000:8a2e:0370:7334", false},
+               {"validuser", "2001:db8::ff00:42:8329", false},
+               {"validuser", "2001:db8:0:1234:0:567:8:1", false},
+               {"validuser", "2001:db8::1234:0:567:8:1", false},
+               {"validuser", "2001:db8:0:0:0:0:2:1", false},
+               {"validuser", "2001:db8::2:1", false},
+               {"validuser", "2001:db8:0:0:8:800:200c:417a", false},
+               {"validuser", "2001:db8::8:800:200c:417a", false},
+               {"validuser", "2001:db8:0:0:8:800:200c:417a; rm -rf /", true},
+               {"validuser", "2001:db8::8:800:200c:417a; rm -rf /", true},
+       }
+
+       for _, test := range tests {
+               i := &Instance{
+                       // For testing, we can set a fake executable path; in real use, replace with a real path
+                       ExecPath: "/tmp/fake-gotty-binary",
+                       Manager:  &MockManager{}, // MockManager is a mock struct that implements the Manager interface
+               }
+               // CreateNewConnection internally calls ValidateUsernameAndRemoteAddr
+               err := i.CreateNewConnection(8080, test.username, test.remoteAddr, 22)
+               if test.expectError && err == nil {
+                       t.Errorf("Expected error for username=%q remoteAddr=%q, but got none", test.username, test.remoteAddr)
+               }
+               if !test.expectError && err != nil {
+                       t.Errorf("Did not expect error for username=%q remoteAddr=%q, got %v", test.username, test.remoteAddr, err)
+               }
+       }
+}
