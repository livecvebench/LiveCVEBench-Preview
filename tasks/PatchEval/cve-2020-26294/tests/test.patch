diff --git a/template/native/render_test.go b/template/native/render_test.go
index b6f4dede..941624d3 100644
--- a/template/native/render_test.go
+++ b/template/native/render_test.go
@@ -6,6 +6,7 @@ package native
 
 import (
 	"io/ioutil"
+	"reflect"
 	"testing"
 
 	"github.com/go-vela/types/raw"
@@ -82,3 +83,43 @@ func TestNative_Render(t *testing.T) {
 		})
 	}
 }
+
+func TestNative_Render_DisallowedFunc_Env(t *testing.T) {
+	// setup types
+	want := yaml.StepSlice{}
+
+	// run test
+	tmpl, err := ioutil.ReadFile("testdata/disallowed/tmpl_env.yml")
+	if err != nil {
+		t.Errorf("Reading file returned err: %v", err)
+	}
+
+	got, err := Render(string(tmpl), &yaml.Step{})
+	if err == nil {
+		t.Errorf("Render should have returned err")
+	}
+
+	if !reflect.DeepEqual(got, want) {
+		t.Errorf("Render is %v, want %v", got, want)
+	}
+}
+
+func TestNative_Render_DisallowedFunc_ExpandEnv(t *testing.T) {
+	// setup types
+	want := yaml.StepSlice{}
+
+	// run test
+	tmpl, err := ioutil.ReadFile("testdata/disallowed/tmpl_expandenv.yml")
+	if err != nil {
+		t.Errorf("Reading file returned err: %v", err)
+	}
+
+	got, err := Render(string(tmpl), &yaml.Step{})
+	if err == nil {
+		t.Errorf("Render should have returned err")
+	}
+
+	if !reflect.DeepEqual(got, want) {
+		t.Errorf("Render is %v, want %v", got, want)
+	}
+}
diff --git a/template/native/testdata/disallowed/tmpl_env.yml b/template/native/testdata/disallowed/tmpl_env.yml
new file mode 100644
index 00000000..c6eb1aa0
--- /dev/null
+++ b/template/native/testdata/disallowed/tmpl_env.yml
@@ -0,0 +1,8 @@
+metadata:
+  template: true
+
+steps:
+  - name: echo
+    commands:
+      - echo {{ env "VELA_SOURCE_CLIENT" }}
+    image: alpine:latest
\ No newline at end of file
diff --git a/template/native/testdata/disallowed/tmpl_expandenv.yml b/template/native/testdata/disallowed/tmpl_expandenv.yml
new file mode 100644
index 00000000..3c0e390f
--- /dev/null
+++ b/template/native/testdata/disallowed/tmpl_expandenv.yml
@@ -0,0 +1,8 @@
+metadata:
+  template: true
+
+steps:
+  - name: echo
+    commands:
+      - echo {{ expandenv "Your client id is set to $VELA_SOURCE_CLIENT" }}
+    image: alpine:latest
\ No newline at end of file
