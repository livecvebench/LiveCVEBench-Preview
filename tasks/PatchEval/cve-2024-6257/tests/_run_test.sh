#!/bin/bash
# From ghcr.io/anonymous2578-data/cve-2024-6257:latest
# bash /workspace/fix-run.sh
set -e

cd /workspace/go-getter
git apply --whitespace=nowarn /tests/test.patch 
go test   -timeout 30s -run ^TestGitGetter_BadRemoteUrl$ github.com/hashicorp/go-getter

cd /workspace
#!/bin/bash
# From ghcr.io/anonymous2578-data/cve-2024-6257:latest
# bash /workspace/unit_test.sh
set -e

cd /workspace/go-getter
go test -timeout 30s -run '^(TestGitGetter_gitVersion|TestGitGetter_tag|TestGitGetter_sshSCPStyleInvalidScheme|TestGitGetter_shallowClone|TestGitGetter_setupGitEnvWithNoKeyFile|TestGitGetter_commitID|TestGitGetter_branch|TestGitGetter_shallowCloneWithTag|TestGitGetter_GetFile|TestGitGetter_submodule|TestGitGetter_subdirectory|TestGitGetter_shallowCloneWithCommitID|TestGitGetter_setupGitEnv_sshKey|TestGitGetter_impl|TestGitGetter|TestGitGetter_branchUpdate|TestGitGetter_subdirectory_symlink|TestGitGetter_remoteWithoutMaster|TestGitGetter_setupGitEnvWithExisting_sshKey)$' github.com/hashicorp/go-getter