instruction: |-
  This application is a data analytics platform (Redash) that allows users to execute
  Python queries for data analysis. The system uses a sandbox library (RestrictedPython)
  to restrict what Python code can do, preventing access to dangerous operations.

  However, users have discovered that the Python query execution feature allows access
  to Python internal attributes that should be restricted. Specifically, when users
  execute Python queries, they can access attributes that start with underscores (like
  accessing object metadata) which should be blocked by the sandbox.

  For example, executing a query that accesses internal object attributes succeeds
  when it should fail with an AttributeError. This allows users to bypass the intended
  sandbox restrictions and potentially access parts of the Python runtime that should
  be forbidden.

  The vulnerable code is in the Python query runner implementation. The issue is related
  to how attribute access is controlled in the sandbox environment. The sandbox library
  provides secure alternatives for attribute access functions, but they may not be
  properly utilized.

  We expect the application to:
  - Block access to attributes starting with underscores (like internal Python attributes)
  - Raise AttributeError when users try to access restricted attributes
  - Continue to allow normal Python operations (arithmetic, data manipulation, etc.)

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: security
tags:
  - python
  - sandbox
  - restricted-execution
  - attribute-access

parser_name: pytest

run_tests_in_same_shell: false
