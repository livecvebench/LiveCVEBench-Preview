<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="jehc.djshi.workflow.dao.LcApplyDao">
	<!--初始化分页-->
	<select id="getLcApplyListByCondition" resultType="jehc.djshi.workflow.model.LcApply" parameterType="map">
		SELECT
			lc_apply_id AS lcApplyId,
			title,
			model_key AS modelKey,
			proc_inst_id AS procInstId,
			proc_def_id AS procDefId,
			deployment_id AS deploymentId,
			lc_url AS lcUrl,
			business_key AS businessKey,
			status,
			completed,
			remark,
			create_id AS createId,
			create_by AS createBy,
			update_id AS updateId,
			create_time AS createTime,
			update_time AS updateTime
		FROM
			lc_apply
		WHERE 1=1
			AND del_flag = 0
		<if test="null != title">
			AND instr(title,#{title})
		</if>
		<if test="null != procInstId">
			AND proc_inst_id = #{procInstId }
		</if>
		<if test="null != procDefId">
			AND proc_def_id = #{procDefId }
		</if>
		<if test="null != deploymentId">
			AND deployment_id = #{deploymentId }
		</if>
		ORDER BY create_time DESC
	</select>
	
	<!--根据实例编号查找集合-->
	<select id="getLcApplyList" resultType="jehc.djshi.workflow.model.LcApply" parameterType="map">
		SELECT
			lc_apply_id AS lcApplyId,
			title,
			model_key AS modelKey,
			proc_inst_id AS procInstId,
			proc_def_id AS procDefId,
			deployment_id AS deploymentId,
			lc_url AS lcUrl,
			business_key AS businessKey,
			status,
			completed,
			remark,
			create_id AS createId,
			create_by AS createBy,
			update_id AS updateId,
			create_time AS createTime,
			update_time AS updateTime
		FROM 
			lc_apply
		WHERE 
			AND proc_inst_id IN
			<foreach item="item" index="index" collection="procInstId" open="(" separator="," close=")">
				#{item}
			</foreach>
	</select>

	<!--查询对象-->
	<select id="getLcApplyById" resultType="jehc.djshi.workflow.model.LcApply" parameterType="string">
		SELECT
			lc_apply_id AS lcApplyId,
			title,
			model_key AS modelKey,
			proc_inst_id AS procInstId,
			proc_def_id AS procDefId,
			deployment_id AS deploymentId,
			lc_url AS lcUrl,
			business_key AS businessKey,
			status,
			completed,
			remark,
			create_id AS createId,
			create_by AS createBy,
			update_id AS updateId,
			create_time AS createTime,
			update_time AS updateTime
		FROM 
			lc_apply
		WHERE lc_apply_id=#{lcApplyId}
	</select>

	<!--添加-->
	<insert id="addLcApply" parameterType="jehc.djshi.workflow.model.LcApply">
		INSERT INTO
			lc_apply
			(
			lc_apply_id,
			title,
			model_key,
			proc_inst_id,
			proc_def_id,
			deployment_id,
			lc_url,
			business_key,
			create_by,
			status,
			completed,
			remark,
			create_id,
			update_id,
			del_flag,
			create_time,
			update_time
			)
			VALUES
			(
			#{lcApplyId},
			#{title},
			#{modelKey},
			#{procInstId},
			#{procDefId},
			#{deploymentId},
			#{lcUrl},
			#{businessKey},
			#{createBy},
			#{status},
			#{completed},
			#{remark},
			#{createId},
			#{updateId},
			0,
			#{createTime},
			#{updateTime}
			)
	</insert>

	<!--修改-->
	<update id="updateLcApply" parameterType="jehc.djshi.workflow.model.LcApply">
		UPDATE
			lc_apply
		<set>
			<if test="null != status">
				status = #{status},
			</if>
			<if test="null != completed">
				completed = #{completed},
			</if>
		</set>
		WHERE lc_apply_id = #{lcApplyId}
	</update>

	<!--删除-->
	<delete id="delLcApply" parameterType="map">
		UPDATE lc_apply SET del_flag = 0 WHERE lc_apply_id IN
		<foreach item="item" index="index" collection="lc_apply_id" open="(" separator="," close=")">
			#{item}
		</foreach>
	</delete>
</mapper>