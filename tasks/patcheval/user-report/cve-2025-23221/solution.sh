cat <<'EOF' > fix.patch
diff --git a/src/webfinger/lookup.ts b/src/webfinger/lookup.ts
index 45952a3a..5364cb27 100644
--- a/src/webfinger/lookup.ts
+++ b/src/webfinger/lookup.ts
@@ -1,4 +1,5 @@
 import { getLogger } from "@logtape/logtape";
+import { validatePublicUrl } from "../runtime/url.ts";
 import type { ResourceDescriptor } from "./jrd.ts";
 
 const logger = getLogger(["fedify", "webfinger", "lookup"]);
@@ -35,6 +36,7 @@ export async function lookupWebFinger(
       { url: url.href },
     );
     let response: Response;
+    await validatePublicUrl(url.href);
     try {
       response = await fetch(url, {
         headers: { Accept: "application/jrd+json" },

EOF

cd /app/fedify
git apply --whitespace=nowarn  /app/fix.patch