instruction: |-
  When using cookie authentication for websocket connections, the server crashes if the Cookie header is malformed or invalid. Sending a websocket upgrade request with an improperly formatted cookie causes the entire Node process to error out and exit. The library should gracefully handle invalid cookie headers and return an appropriate error response instead of crashing.


author_name: Jinyang Huang
author_email: hjyTsuki@gmail.com
difficulty: hard
category: software-engineering
tags:
  - CWExxx
parser_name: pytest
max_agent_timeout_sec: 1000.0
max_test_timeout_sec: 300.0
run_tests_in_same_shell: true
disable_asciinema: false
