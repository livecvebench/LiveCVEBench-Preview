instruction: |-
  This is a self-hosted RSS feed aggregator application. Users can subscribe to RSS feeds,
  organize them into categories, apply tags/labels to articles, and track unread counts.

  We've received reports that certain internal API endpoints are returning data without
  properly verifying user sessions. Specifically:

  1. The feed refresh status endpoint returns feed names, IDs, and update timestamps
     to any visitor, even without logging in.

  2. The unread counts endpoint returns detailed statistics about feeds and tags
     to unauthenticated users.

  3. The tag management page displays tag names and filter configurations
     to anyone who guesses valid tag IDs (1, 2, 3, etc.).

  This behavior is unexpected. These endpoints should require an active user session
  before returning any data. Unauthenticated requests to these endpoints should receive
  a 403 Forbidden response instead of the sensitive user data.

  The relevant controller files are located in the app/Controllers/ directory. The
  application uses an authentication helper method (FreshRSS_Auth::hasAccess()) that
  returns true only for authenticated users with valid sessions. Some endpoints already
  use this pattern correctly - you can reference those as examples.

  Note: For certain public-facing features, the application has system configuration
  options (allow_anonymous and allow_anonymous_refresh) that may permit anonymous access.
  These should be respected where appropriate (e.g., allowing anonymous users to trigger
  feed refresh if both options are enabled).

difficulty: medium
category: security
tags:
  - php
  - access-control
  - api
  - authentication
parser_name: pytest
run_tests_in_same_shell: false
max_test_timeout_sec: 180
