instruction: |-
  This is ProcessWire CMS, a content management system built in PHP. The application
  includes a file management utility with ZIP archive extraction functionality.

  Users have reported that when uploading ZIP files through the Language Support
  feature (Setup > Languages > [Language] > Site Translation Files), the system
  becomes unresponsive. After attempting to process certain ZIP files, the server
  experiences severe resource exhaustion:

  - CPU usage spikes to 100% and remains high for extended periods
  - Disk space fills up rapidly during extraction
  - PHP-FPM workers become blocked, causing the entire site to hang
  - Eventually the process is killed by OOM or disk full errors

  The ZIP files causing this issue are small in compressed size but appear to contain
  many files or have unusually high compression ratios. For example, a 7MB ZIP file
  caused over 6GB of disk usage before the extraction was forcefully terminated.

  We expect the application to validate archive contents before extraction and reject
  files that exceed reasonable resource limits (e.g., maximum file count, maximum
  uncompressed size).

  The relevant code is in `wire/core/WireFileTools.php`, specifically the `unzip()`
  method which handles ZIP file extraction.

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: security
tags:
  - php
  - resource-exhaustion
  - zip-extraction
  - input-validation
parser_name: pytest

run_tests_in_same_shell: false
