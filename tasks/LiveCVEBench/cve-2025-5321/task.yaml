instruction: |-
  Aim is an open-source, self-hosted machine learning experiment tracking tool. It
  provides a web UI for exploring experiments and an SDK for tracking metrics,
  hyperparameters, and metadata from ML training runs.

  The system allows users to query experiments using a Python-like expression language
  (AimQL). For example, users can filter runs with queries like `run.name == "experiment_1"`
  or `run.hparams.learning_rate < 0.01`.

  Users have reported that certain complex query expressions cause unexpected server
  behavior. When queries access nested object attributes in unusual patterns (e.g.,
  traversing through internal object chains), the server may execute unintended
  operations instead of returning query results.

  For example, a query like `run.db.runs().session.bind.dialect.dbapi.datetime.sys.modules`
  appears to traverse internal implementation details rather than being properly restricted
  to the intended query interface.

  The expected behavior is that the query sandbox should restrict access to only safe
  query operations. Internal objects like database connections, sessions, and system
  modules should not be accessible through the query interface.

  Legitimate queries like `run.name == "test"`, `run.hparams.lr < 0.01`, and
  `run.archived == False` must continue to work correctly after any fixes.

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: security
tags:
  - python
  - sandbox
  - query-parsing
  - restrictedrython
parser_name: pytest

run_tests_in_same_shell: false
