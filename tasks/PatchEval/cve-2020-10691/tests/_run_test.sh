#!/bin/bash
# From ghcr.io/anonymous2578-data/cve-2020-10691:latest
# bash /workspace/fix-run.sh
set -e

cd /workspace/ansible
git apply --whitespace=nowarn /tests/test.patch 
/workspace/PoC_env/CVE-2020-10691/bin/ansible-test integration ansible-galaxy-collection --python 3.8 --tags "bad_tarball" --allow-disabled && /workspace/PoC_env/CVE-2020-10691/bin/pytest test/units/galaxy/test_collection.py::test_extract_tar_file_outside_dir
cd /workspace
#!/bin/bash
# From ghcr.io/anonymous2578-data/cve-2020-10691:latest
# bash /workspace/unit_test.sh
set -e

cd /workspace/ansible
/workspace/PoC_env/CVE-2020-10691/bin/ansible-test integration ansible-galaxy-collection --python 3.8 --tags "bad_tarball" --allow-disabled && /workspace/PoC_env/CVE-2020-10691/bin/pytest test/units/galaxy/test_collection.py