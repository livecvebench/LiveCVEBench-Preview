#!/bin/bash
# From ghcr.io/anonymous2578-data/cve-2021-29417:latest
# bash /workspace/fix-run.sh
set -e

cd /workspace/gitjacker
rm -rf ./internal/pkg/gitjacker/retriever_test.go
go mod vendor
git apply --whitespace=nowarn /tests/test.patch 
go test   -timeout 30s -run ^TestDownloadFile_PathTraversal$ github.com/liamg/gitjacker/internal/pkg/gitjacker

cd /workspace
#!/bin/bash
# From ghcr.io/anonymous2578-data/cve-2021-29417:latest
# bash /workspace/unit_test.sh
set -e

cd /workspace/gitjacker
go mod vendor
cd internal/pkg/gitjacker && go test   -timeout 30s -v github.com/liamg/gitjacker/internal/pkg/gitjacker