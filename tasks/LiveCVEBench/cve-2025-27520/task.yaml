instruction: |-
  This application is a machine learning model serving API built with BentoML.
  It exposes endpoints for processing data via HTTP requests.

  We've discovered that the server accepts certain non-standard content types that
  could lead to unexpected behavior. Specifically, when a client sends a POST request
  with `Content-Type: application/vnd.bentoml+pickle`, the server processes the
  request body without proper validation.

  This is problematic because the pickle format can embed executable code that runs
  during deserialization. While this content type might be useful for internal
  worker-to-worker communication, it should not be accepted on the main server
  endpoint that handles external requests.

  We expect the main server to reject requests with this content type and return
  an appropriate HTTP 415 (Unsupported Media Type) error, while continuing to
  accept standard JSON requests normally.

  The fix should be implemented in the server's API endpoint handling code to block
  this specific content type on the main server before any deserialization occurs.

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: security
tags:
  - python
  - bentoml
  - deserialization
  - content-type-validation
  - http
parser_name: pytest
