instruction: |-
  This application provides a file parsing service that allows users to request
  parsing of documents stored on the server. Users can provide file paths through
  the `/api/files/parse` API endpoint.

  When sending requests to parse files with paths like `/api/files/serve/../../../etc/passwd`,
  the application unexpectedly returns the contents of system files that should not be
  accessible. For example, when a user submits a request with a path containing `../`
  sequences, they can read files outside the designated uploads directory.

  Example problematic request:
  ```
  POST /api/files/parse
  Content-Type: application/json

  {"filePath": "/api/files/serve/../../../etc/passwd"}
  ```

  This returns the contents of `/etc/passwd` instead of returning an error. The
  application should only allow access to files within the configured uploads
  directory and reject any paths that attempt to traverse outside this directory.

  Expected behavior: The API should return an error like "Access denied" when
  users attempt to access paths containing directory traversal sequences (`..`)
  or paths that resolve outside the uploads directory.

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: security
tags:
  - path-traversal
  - input-validation
  - file-access
  - nextjs
  - typescript
parser_name: pytest

run_tests_in_same_shell: false
max_test_timeout_sec: 120.0
