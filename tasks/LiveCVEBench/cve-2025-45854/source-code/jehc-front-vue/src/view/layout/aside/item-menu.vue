<template>
    <div class="menuReplaceId">
    <template v-for="(item,i) in menuDataList">
        <li :key="i" v-if="null != item.children && item.children.length > 0"
            aria-haspopup="true"
            data-menu-toggle="hover"
            class="menu-item menu-item-submenu"
            v-bind:class="{ 'menu-item-open': hasActiveChildren(item.componentOpenStyle) }"
            >
            <a href="#" class="menu-link menu-toggle">
                <i class="menu-icon " :class="item.componentIcon"></i>
                <span class="menu-text">{{item.label  }}</span>
                <i class="menu-arrow icon-xs"></i>
            </a>
            <div class="menu-submenu">
                <span class="menu-arrow icon-xs"></span>
                <ul class="menu-subnav">
                    <li aria-haspopup="true" class="menu-item menu-item-parent">
                        <span class="menu-link">
                        <span class="menu-text">{{item.label  }}</span>
                        </span>
                    </li>                     
                    <itemMenu :menuDataList="item.children"></itemMenu>                        
                </ul>
            </div>
        </li>
        <router-link v-else                
            :to="null !== item.componentRouterTo?item.componentRouter :'/dashboard'"
            v-slot="{ href, navigate, isActive, isExactActive }"
            :key= "i+1000"
            >
            <li
                aria-haspopup="true"
                data-menu-toggle="hover"
                class="menu-item"
                :class="[
                isActive && 'menu-item-active',
                isExactActive && 'menu-item-active'
                ]"
            >
                <a :href="href" class="menu-link" @click="navigate">
                    <!--text-dark-50样式也漂亮-->      
                    <i class="menu-icon text-dark-50" :class="item.componentIcon">                    
                    <!-- <i class="menu-icon " :class="item.component_icon"> -->
                    <span></span>
                    </i>
                    <span class="menu-text">{{item.name}}</span>
                </a>
            </li>
        </router-link>
    </template> 
</div>
</template>   
<script>
export default {
    name: "itemMenu",
    props: {
        menuDataList: []
    },
    watch:{
        menuDataList:{
            handler(newVal){
                this.$nextTick(() => {        
                    const list = document.querySelectorAll('.menuReplaceId')
                    for(let i in list){
                        let node = list[i];
                        if(node instanceof HTMLElement){
                        node.replaceWith(...node.childNodes)
                        }
                    }
                });
            }
            
        }
    },
    mounted() {
    //    console.log(this.menuDataList);
       
    },
    methods: {
        hasActiveChildren(match) {
            return this.$route["path"].indexOf(match) !== -1;
        },
    }
};
</script>