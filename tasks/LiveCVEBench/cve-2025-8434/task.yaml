instruction: |-
  This is a PHP-based movie streaming application called NeonFlix that allows
  administrators to upload movie content (metadata, poster images, and video files).

  Users have reported that non-admin users can directly access the admin movie
  upload page by navigating to /admin.php, even though they don't see the "Add movie"
  link in the navigation menu. Similarly, the backend endpoint /backend/admin_control.php
  that handles the movie upload form submissions accepts requests from anyone.

  The navigation menu currently only shows the admin link when the user has admin
  privileges (checked via session), but this client-side check doesn't prevent
  direct URL access. The admin.php page and backend/admin_control.php file start
  a session but never verify the user's admin status before displaying the form
  or processing uploads.

  Expected behavior:
  - Only authenticated admin users should be able to view the admin.php page
  - Non-admin users accessing admin.php should be redirected to user-login.php
  - The backend/admin_control.php endpoint should reject requests from non-admin
    users with an appropriate error response
  - Legitimate admin functionality should continue to work normally

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: bug-fix
tags:
  - php
  - authorization
  - access-control
  - session
parser_name: pytest

run_tests_in_same_shell: false
