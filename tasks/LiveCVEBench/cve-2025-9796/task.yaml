instruction: |-
  I'm using JeeSite's input sanitization utility and found an issue with the
  xssFilter function. The filter is supposed to prevent dangerous content in
  user input, but it seems to have an incomplete protocol blacklist.

  When I submit content that starts with "<!--HTML-->" (which preserves HTML
  formatting in our application), I noticed that certain protocol URIs in src
  and href attributes are passing through when they shouldn't.

  For example, if I enter content like:
  <!--HTML-->Test<embed src="data:text/html;base64,PHNjcmlwdD5hbGVydCg5KTwvc2NyaXB0Pgo=">

  The filter removes "javascript:" and "vbscript:" protocols correctly, but
  the "data:" protocol passes through unfiltered. Since "data:" URIs can
  embed content directly in the URL, this seems inconsistent with how the
  other protocols are handled.

  I would expect the filter to treat "data:" the same way it treats
  "javascript:" and "vbscript:" - blocking it in href and src attributes to
  be consistent with the existing filtering approach.

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: easy
category: security
tags:
  - java
  - input-validation
  - regex
parser_name: pytest

run_tests_in_same_shell: false
max_test_timeout_sec: 120.0
