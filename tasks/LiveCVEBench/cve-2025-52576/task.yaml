instruction: |-
  This application is Kanboard, a project management software that provides a web-based
  interface with user authentication.

  Users report inconsistent CAPTCHA behavior on the login page. When attempting to log in
  with certain usernames and providing incorrect passwords multiple times (3+ attempts),
  a CAPTCHA challenge appears. However, when using other usernames, the CAPTCHA never
  appears no matter how many failed attempts are made.

  Additionally, the rate-limiting system appears to be ineffective. Users behind load
  balancers or proxies report that failed login tracking does not work correctly - the
  system seems to be tracking attempts inconsistently.

  Expected behavior:
  - CAPTCHA should appear consistently after 3 failed login attempts, regardless of which
    username is entered
  - Failed login attempts should be tracked properly by the client's IP address
  - Error messages should not reveal whether specific errors occurred (e.g., distinguish
    between CAPTCHA failure vs credential failure)

  The authentication logic is primarily located in:
  - app/Controller/AuthController.php
  - app/Validator/AuthValidator.php
  - app/Subscriber/AuthSubscriber.php

difficulty: medium
category: bug-fix
tags:
  - php
  - authentication
  - captcha
  - rate-limiting
parser_name: pytest

run_tests_in_same_shell: false
