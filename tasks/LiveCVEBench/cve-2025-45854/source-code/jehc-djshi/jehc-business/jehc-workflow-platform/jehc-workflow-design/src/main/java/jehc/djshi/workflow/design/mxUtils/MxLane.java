package jehc.djshi.workflow.design.mxUtils;

import jehc.djshi.workflow.design.mxUtils.communal.MxUtils;
import lombok.extern.slf4j.Slf4j;
import org.dom4j.Element;

import java.util.List;
import java.util.Map;
/**
 * @Desc 泳道
 * @Author 邓纯杰
 * @CreateTime 2012-12-12 12:12:12
 */
@Slf4j
public class MxLane {
	/**
	 *  泳道操作
	 * @param root
	 * @param mxCellList
	 * @param mxCell
	 * @return
	 */
	public static String lane(Element root,List mxCellList,Element mxCell){
		String lane_node = "";
		/////////////基本属性开始/////////////
 		String name = mxCell.attributeValue("value");
 		String nodeID = mxCell.attributeValue("nodeID");
 		/////////////基本属性结束/////////////
 		
 		//节点中其他基本属性
 		//获取mxCell节点下的mxGeometry节点
        Element mxGeometry = mxCell.element("mxGeometry"); 
        String x = mxGeometry.attributeValue("x");
        String y = mxGeometry.attributeValue("y");
        if(null == y || "".equals(y)){
        	y = "0";
        }
        if(null == x || "".equals(x)){
        	x = "0";
        }
		//开区间
        lane_node+="<lane id='"+nodeID+"' name='"+name+"'>";
		//闭区间
        lane_node += "</lane>";
		return lane_node;
	}
	
	/**
	 *  泳道bpmndi（泳道没有连线）
	 * @param root
	 * @param mxCellList
	 * @param mxCell
	 * @return
	 */
	public static String laneBpmndi(Element root,List mxCellList,Element mxCell){
		String nodeID = mxCell.attributeValue("nodeID");
		Map<String, Object> xyMap = MxUtils.resultBoundsXY(mxCellList, mxCell);
        String x = xyMap.get("x").toString();
        String y = xyMap.get("y").toString();
        String width = xyMap.get("width").toString();
        String height = xyMap.get("height").toString();
		String bpmndi="";
		bpmndi += "<bpmndi:BPMNShape bpmnElement='"+nodeID+"' id='BPMNShape_"+nodeID+"'>";
        bpmndi += "<omgdc:Bounds height='"+height+"' width='"+width+"' x='"+x+"' y='"+y+"'></omgdc:Bounds>";
        bpmndi += "</bpmndi:BPMNShape>";
		return bpmndi;
	}
}
