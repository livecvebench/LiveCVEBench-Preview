#!/bin/bash
set -e

cd /app/helm
git apply --whitespace=nowarn /tests/test.patch
go test    -timeout 30s -run ^TestValidate$ helm.sh/helm/v3/pkg/chart
go test -timeout 30s -run '^(TestBuild_WithoutOptionalFields|TestSaveDir|TestKey|TestNormalizeURL|TestValidateChartVersion|TestBuild_WithCondition|TestVersionEquals|TestValidateChartName|TestSavePreservesTimestamps|TestValidateChartYamlFormat|TestChartfile|TestValidateChartSources|TestValidate_sanitize|TestGetRepoNames|TestBuild_WithRepositoryAlias|TestErrRepoNotFound_Error|TestBuild_WithSemVerRange|TestValidateChartYamlNotDirectory|TestValidate|TestSave|TestFindChartURL|TestBuild_WithTags|TestBuild_WithAlias|TestValidateChartIconURL|TestValidateChartIconPresence|TestUpdateWithNoRepo|TestUpdateBeforeBuild|TestValidateChartMaintainer|TestDownloadAll)$' helm.sh/helm/v3/pkg/chart

