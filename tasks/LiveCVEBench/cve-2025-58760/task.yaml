instruction: |-
  Tautulli is a monitoring and tracking tool for Plex Media Server. It provides a web
  interface with various features including image serving for media thumbnails and
  interface icons.

  Users are reporting that the /image endpoint is serving files outside of the expected
  directory. When certain URL path patterns are used (e.g., paths containing ".."
  directory references), the server returns unexpected file contents instead of images.

  For example, a request to /image/images/../../../config.ini returns the configuration
  file contents rather than an image, which exposes sensitive application data. Similarly,
  requests with deeply nested ".." sequences can access files anywhere on the filesystem.

  The image serving functionality should only serve files from the designated image
  directories and should reject any requests that attempt to access paths outside
  those directories.

  Expected behavior:
  - Requests for valid images like /image/images/logo.png should return the image
  - Requests with directory traversal patterns should be rejected (return empty response)
  - The fix should apply to both the /image endpoint and the image proxy functionality

difficulty: medium
category: security
tags:
  - python
  - web
  - cherrypy
  - path-validation
parser_name: pytest

run_tests_in_same_shell: false

max_test_timeout_sec: 180.0
