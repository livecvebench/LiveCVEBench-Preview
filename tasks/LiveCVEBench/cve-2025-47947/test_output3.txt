============================= test session starts ==============================
platform linux -- Python 3.13.5, pytest-9.0.2, pluggy-1.6.0 -- /tests/.venv/bin/python
cachedir: .pytest_cache
rootdir: /tests
configfile: pyproject.toml
collecting ... collected 8 items

test_vuln.py::TestSanitizationEntryCount::test_sanitization_entry_count_linear FAILED [ 12%]
test_vuln.py::TestSanitizationEntryCount::test_larger_array_scaling FAILED [ 25%]
test_vuln.py::TestSanitizationEntryCount::test_growth_ratio PASSED       [ 37%]
test_vuln.py::TestVulnerabilityDetection::test_duplicate_warnings_per_request FAILED [ 50%]
test_vuln.py::TestVulnerabilityDetection::test_multiple_arrays_scaling FAILED [ 62%]
test_vuln.py::TestBasicFunctionality::test_server_responds PASSED        [ 75%]
test_vuln.py::TestBasicFunctionality::test_json_accepted PASSED          [ 87%]
test_vuln.py::TestBasicFunctionality::test_small_array_works PASSED      [100%]

=================================== FAILURES ===================================
_______ TestSanitizationEntryCount.test_sanitization_entry_count_linear ________
test_vuln.py:152: in test_sanitization_entry_count_linear
    assert entry_count < max_expected, \
E   AssertionError: Too many sanitization entries: 200 (expected < 150). This indicates O(nÂ²) behavior from CVE-2025-47947 vulnerability.
E   assert 200 < 150
_____________ TestSanitizationEntryCount.test_larger_array_scaling _____________
test_vuln.py:178: in test_larger_array_scaling
    assert entry_count < max_expected, \
E   AssertionError: Excessive sanitization entries: 400 (expected < 300). N=100 elements should not produce 400 entries (indicates duplicates).
E   assert 400 < 300
________ TestVulnerabilityDetection.test_duplicate_warnings_per_request ________
test_vuln.py:261: in test_duplicate_warnings_per_request
    assert total_warnings < max_expected, \
E   AssertionError: Detected 120 warning entries for 30 elements. Expected < 120. Excessive duplicates indicate vulnerability.
E   assert 120 < 120
___________ TestVulnerabilityDetection.test_multiple_arrays_scaling ____________
test_vuln.py:289: in test_multiple_arrays_scaling
    assert entry_count < max_expected, \
E   AssertionError: Multiple arrays produced 360 entries for 90 elements. Expected linear scaling, got excessive duplicates.
E   assert 360 < 360
==================================== PASSES ====================================
=========================== short test summary info ============================
PASSED test_vuln.py::TestSanitizationEntryCount::test_growth_ratio
PASSED test_vuln.py::TestBasicFunctionality::test_server_responds
PASSED test_vuln.py::TestBasicFunctionality::test_json_accepted
PASSED test_vuln.py::TestBasicFunctionality::test_small_array_works
FAILED test_vuln.py::TestSanitizationEntryCount::test_sanitization_entry_count_linear
FAILED test_vuln.py::TestSanitizationEntryCount::test_larger_array_scaling - ...
FAILED test_vuln.py::TestVulnerabilityDetection::test_duplicate_warnings_per_request
FAILED test_vuln.py::TestVulnerabilityDetection::test_multiple_arrays_scaling
========================= 4 failed, 4 passed in 17.27s =========================
