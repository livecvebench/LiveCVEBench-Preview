instruction: |-
  This is a mathematical expression evaluation service using the expr-eval
  library. Users can submit expressions like "2 + 3" or "sin(x) * 2" for
  calculation.

  When users include certain special variable names in their expressions,
  unexpected behavior occurs. For example:

  `Parser.evaluate('Object = constructor; Object.assign(__proto__, {test: 1})')`

  After this expression runs, unrelated objects in the application suddenly
  have properties they shouldn't have - a new empty `{}` object now has
  a `.test` property equal to 1.

  Similarly, expressions like `Parser.evaluate('constructor')` or
  `Parser.evaluate('__proto__')` return internal JavaScript objects instead
  of throwing errors for undefined variables.

  Expected behavior:
  - Expressions containing `constructor`, `__proto__`, or `prototype` should
    throw an error and not be evaluated
  - The parser should not expose access to JavaScript internal objects
  - New objects should not inherit properties from malicious expressions

difficulty: medium
category: security
tags:
  - javascript
  - nodejs
  - input-validation
  - expression-parser
parser_name: pytest

run_tests_in_same_shell: false
