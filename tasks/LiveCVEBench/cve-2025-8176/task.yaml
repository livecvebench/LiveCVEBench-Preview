instruction: |-
  This repository contains LibTIFF, a library for reading and writing TIFF image files.
  The `tiffmedian` tool applies median cut color quantization to RGB TIFF images.

  When using the Floyd-Steinberg dithering option (`-f` flag), there are two bugs
  in the image processing:

  1. The first scanline (row 0) of the input image is being skipped during
     processing. When running `tiffmedian -f input.tif output.tif`, the output
     image is missing its first row of pixel data - the colors from line 0 don't
     appear correctly in the quantized output.

  2. When the tool encounters an error reading a scanline (e.g., from a truncated
     or corrupted TIFF file), it silently continues processing instead of reporting
     the error. This makes debugging difficult since the user receives no feedback
     about incomplete data.

  Expected behavior:
  - All scanlines (starting from row 0) should be processed correctly
  - Read errors should be reported to stderr and cause the tool to exit with a
    failure code
  - The output image should have the same number of rows as the input image

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: bug-fix
tags:
  - libtiff
  - c
  - image-processing
  - off-by-one
  - error-handling
parser_name: pytest

run_tests_in_same_shell: false
max_test_timeout_sec: 120.0
