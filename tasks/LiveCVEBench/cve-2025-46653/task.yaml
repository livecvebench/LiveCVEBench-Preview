instruction: |-
  I'm using a Node.js file upload service that uses the formidable library to handle
  multipart uploads. I noticed something concerning about how uploaded files are named.

  When I upload multiple files in quick succession, the generated filenames follow a
  very predictable pattern. For example, after uploading three files:

  - `k5h7j2m9p4q8r1t6v3w0x00.txt`
  - `k5h7j2m9p4q8r1t6v3w0x01.txt`
  - `k5h7j2m9p4q8r1t6v3w0x02.txt`

  The first 23 characters are identical, and only the last 2 characters change -
  incrementing like a hexadecimal counter (00, 01, 02, ..., ff).

  This means if an attacker uploads one file and sees its name, they can easily
  guess the filenames of up to 255 other files uploaded around the same time by
  simply trying different hex suffixes with the same prefix.

  Expected behavior:
  - Each uploaded file should receive a completely random, unpredictable filename
  - Knowing one filename should not help predict any other filenames
  - The filename generation should not use a simple incrementing counter

difficulty: medium
category: security
tags:
  - nodejs
  - file-upload
  - randomness
  - formidable
parser_name: pytest

run_tests_in_same_shell: false
