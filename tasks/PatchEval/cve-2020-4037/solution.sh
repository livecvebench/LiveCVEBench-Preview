cat <<'EOF' > /workspace/fix.patch
diff --git a/oauthproxy.go b/oauthproxy.go
index 8c303df862..d5e7184454 100644
--- a/oauthproxy.go
+++ b/oauthproxy.go
@@ -63,7 +63,7 @@ var (
 
 	// Used to check final redirects are not susceptible to open redirects.
 	// Matches //, /\ and both of these with whitespace in between (eg / / or / \).
-	invalidRedirectRegex = regexp.MustCompile(`^/(\s|\v)?(/|\\)`)
+	invalidRedirectRegex = regexp.MustCompile(`[/\\](?:[\s\v]*|\.{1,2})[/\\]`)
 )
 
 // OAuthProxy is the main authentication proxy


EOF

cd /workspace/oauth2-proxy
git apply --whitespace=nowarn  /workspace/fix.patch