instruction: |-
  H2O is a high-performance HTTP/2 server written in C. It includes built-in DoS
  mitigation that tracks a "reset budget" per connection - when clients send too
  many requests that result in stream resets, the server should throttle or
  terminate the misbehaving connection.

  There's an issue with the reset budget accounting. When a client explicitly
  sends an RST_STREAM frame to cancel a request, the server correctly decrements
  the reset budget. However, when the server itself sends an RST_STREAM due to
  protocol violations by the client (e.g., sending a WINDOW_UPDATE with zero
  increment, sending DATA after END_STREAM, or other malformed frames), this is
  not counted against the reset budget.

  This creates a problem: a malicious client can send many malformed frames that
  trigger server-initiated resets, but since these resets don't decrement the
  budget, the DoS mitigation never kicks in. The server continues processing
  resources for each stream before detecting the protocol violation, while the
  reset budget actually increases (since non-client-reset streams add to the
  budget).

  The expected behavior is that any stream reset caused by client misbehavior
  (whether the client sends RST_STREAM directly, or sends invalid frames that
  cause the server to send RST_STREAM) should count against the connection's
  reset budget. This way the DoS mitigation properly protects against all forms
  of reset-based resource exhaustion attacks.

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: hard
category: security
tags:
  - http2
  - dos-mitigation
  - c
  - networking
parser_name: pytest

run_tests_in_same_shell: false
