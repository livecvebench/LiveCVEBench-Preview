cat <<'EOF' > /workspace/fix.patch
diff --git a/gin.go b/gin.go
index 32dae2497f..99ba489fae 100644
--- a/gin.go
+++ b/gin.go
@@ -9,9 +9,9 @@ import (
 	"html/template"
 	"net"
 	"net/http"
-	"net/url"
 	"os"
 	"path"
+	"regexp"
 	"strings"
 	"sync"
 
@@ -669,8 +669,8 @@ func redirectTrailingSlash(c *Context) {
 	req := c.Request
 	p := req.URL.Path
 	if prefix := path.Clean(c.Request.Header.Get("X-Forwarded-Prefix")); prefix != "." {
-		prefix = url.QueryEscape(prefix)
-		prefix = strings.ReplaceAll(prefix, "%2F", "/")
+		reg := regexp.MustCompile("[^a-zA-Z0-9/-]+")
+		prefix = reg.ReplaceAllString(prefix, "")
 
 		p = prefix + "/" + req.URL.Path
 	}
    

EOF

cd /workspace/gin
git apply --whitespace=nowarn  /workspace/fix.patch