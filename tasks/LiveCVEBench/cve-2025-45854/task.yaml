instruction: |-
  This application is a Business Process Management (BPM) platform built with Spring Boot
  that provides various features for workflow management. It includes a monitoring module
  with endpoints for system diagnostics.

  A security review has found that the server monitoring endpoints allow unrestricted access
  to certain administrative functions without requiring user authentication. Specifically,
  the diagnostic command execution endpoint at `/actuator/info/executeExec` can be accessed
  by anyone without logging in. This endpoint is intended for internal diagnostics such as
  checking system memory usage (e.g., running `free -m`), but currently accepts requests
  from unauthenticated users.

  When sending a POST request to this endpoint with a JSON body like `{"0": "whoami"}`,
  the server executes the command and returns the output in the response, even though
  the user has not logged in. The response typically looks like:
  `{"success": true, "data": "root\n", "message": null}`

  We expect that administrative endpoints like this should require proper authentication
  before accepting requests. Unauthenticated requests should receive a 401 Unauthorized
  or 403 Forbidden response instead of executing the requested operation.

  The same issue exists in the server-side proxy endpoint at `/actuator/server/executeExec`.
  Both endpoints need to be fixed to require authentication.

  Note: Look at how authentication is controlled via the @Auth annotation in this codebase.
  Other endpoints use similar patterns that may provide guidance on the correct configuration.

difficulty: medium
category: security
tags:
  - spring-boot
  - authentication
  - authorization
  - java
  - actuator
parser_name: pytest

run_tests_in_same_shell: false
