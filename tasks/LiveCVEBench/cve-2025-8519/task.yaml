instruction: |-
  This application is Vvveb CMS, a drag-and-drop website builder with a visual page
  editor. The editor allows users with "Edit website" permissions to modify pages
  through a web interface.

  When accessing the page editor, users can specify which page to edit via URL
  parameters (e.g., `url=index.html&template=index.html`). However, the editor does
  not properly validate these parameters, causing unexpected behavior:

  1. When requesting files with non-.html extensions (e.g., `url=package.json`), the
     editor loads and exposes the file contents instead of rejecting the request.

  2. When requesting files that don't exist in the theme folder, the editor still
     attempts to process the request instead of returning a proper error.

  3. The `template` parameter similarly lacks validation, allowing references to
     files outside the theme folder.

  These issues cause the editor to behave incorrectly and potentially expose
  configuration or internal files. The editor should:
  - Only accept `.html` files through the `url` parameter
  - Verify that requested files exist within the theme folder
  - Block path traversal attempts (e.g., `..` or `//` in paths)
  - Return a 404 Not Found response for invalid requests

difficulty: medium
category: security
tags:
  - php
  - cms
  - input-validation
  - file-access
parser_name: pytest

run_tests_in_same_shell: false
