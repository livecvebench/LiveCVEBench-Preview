instruction: |-
  We're running an Erlang/OTP SSH server for remote administration and automated
  deployment tasks. During security testing, we discovered that our server is
  allowing commands to run even without proper authentication.

  The issue is:
  - When connecting to the SSH server, commands can be executed before logging in
  - A user doesn't need to provide valid credentials to run commands
  - The server should require authentication before allowing any command execution

  We tested by connecting with netcat and sending raw SSH protocol messages. Even
  without completing any login or authentication handshake, we were able to make
  the server execute Erlang commands which in turn could run system commands.

  This is a serious security issue - anyone on the network who can reach the SSH
  port could execute arbitrary commands on our server without knowing any passwords.

  Expected behavior: The server should refuse to process any session or channel
  requests until the user has successfully authenticated with valid credentials.

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: hard
category: security
tags:
  - erlang
  - ssh
  - protocol-compliance
  - authentication
parser_name: pytest

run_tests_in_same_shell: false
