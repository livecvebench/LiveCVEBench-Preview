instruction: |-
  This application is a Rust library for asynchronously reading and writing TAR archives
  using Tokio. It provides functionality to parse tar files and extract their entries.

  There is a bug in how the parser handles files with PAX extended headers. When a tar
  entry has both a PAX header specifying a size value and a standard (ustar) header with
  a different size value (often zero), the parser incorrectly uses the standard header
  size for position calculations instead of the PAX-specified size.

  This causes the parser to read incorrect data for subsequent entries. For example,
  when processing an archive where:
  - A file has a PAX header declaring size=1024
  - The same file's ustar header has size=0

  The parser skips 0 bytes instead of 1024, then tries to read the next header from
  within the file's content data. This results in corrupted extraction where file
  contents may be misinterpreted as tar headers.

  Expected behavior: The PAX extension size should take precedence over the ustar
  header size when calculating the position of the next entry in the archive.

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: hard
category: bug-fix
tags:
  - rust
  - async
  - tar
  - parsing
  - pax-headers

parser_name: pytest
run_tests_in_same_shell: false

max_test_timeout_sec: 120.0
