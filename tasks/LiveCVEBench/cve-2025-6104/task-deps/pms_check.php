<?php
/**
 * PMS Check Script - Property Management System Integration
 * Part of UniBox Controller billing module
 */

// Partial Code Purpose:
# title : Function for ping
# author : UniBox Developers
# note  : Used for PMS connectivity check

function PmsCheck($target) {
    $result = array();

    $cmd_result = shell_exec("ping -c 3 -w 3 " . $target);

    /* Get Results from Ping */
    $result = explode("\n", $cmd_result);

    if (isset($result[1])) {
        return "<?xml color=green>Response : PMS test success</font>";
    } else {
        return "<?xml color=red>Response : PMS test failed</font>";
    }
}

$target = isset($_REQUEST['ipaddress']) ? $_REQUEST['ipaddress'] : '';

if (!empty($target)) {
    echo PmsCheck($target);
} else {
    echo "<?xml color=red>Response : PMS test failed - No IP address provided</font>";
}
?>
