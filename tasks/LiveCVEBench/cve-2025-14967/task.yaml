instruction: |-
  I am managing student records using the "Student Management System".
  I use the Candidates Report page (`/candidates_report.php`) to check promotion candidates by school year.

  The URL typically looks like: `candidates_report.php?school_year=2019-2020`.

  I noticed that the `school_year` parameter seems vulnerable to SQL injection.
  - When I append a single quote (`'`), the page breaks or shows errors.
  - When I try `school_year=2019-2020' AND SLEEP(5)-- -`, the page takes 5 seconds to load.
  - I suspect I can dump the entire database using UNION queries.

  The application should properly sanitize the `school_year` input to prevent SQL injection.
  It should treat the input as a literal string value, not executable SQL code.

  Expected behavior:
  - The application should be immune to SQL injection attacks (Time-based, UNION-based, etc.).
  - Invalid or malicious input in `school_year` should not affect the database query structure.
  - Valid school years (e.g., "2019-2020") should still return the correct report.

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: easy
category: security
tags:
  - php
  - mysql
  - sql-injection
  - input-validation
parser_name: pytest
run_tests_in_same_shell: false
