instruction: |-
  I'm using the Elysia TypeScript framework (on Bun runtime) for a web application
  that provides REST API endpoints with cookie support. The application accepts
  requests via:

  `GET /` (with cookie configuration)

  I discovered that the framework uses ahead-of-time (AOT) compilation to generate
  optimized request handlers, and cookie configuration values are embedded directly
  into the generated JavaScript code without proper escaping.

  For example, if I start the server with an environment variable like:

  COOKIE_SECRET="test\+console.log('INJECTED')+\" bun run app.ts

  The backtick breaks out of the template literal context in the generated code,
  allowing arbitrary JavaScript execution. This happens because the framework
  blindly interpolates configuration values into code strings during compilation.

  This allows an attacker who can control cookie configuration values (via
  environment variables or configuration files) to inject arbitrary code into
  the application (Code Injection), potentially leading to remote code execution.

  Expected behavior:
  - Cookie configuration values must be properly escaped before code generation
  - Reject or escape backticks (`) in configuration values
  - Reject or escape template literal syntax (${...}) to prevent expression injection
  - The application should be immune to code injection through configuration values

difficulty: medium
category: security
tags:
  - typescript
  - bun
  - web-framework
  - code-generation
  - string-escaping
parser_name: pytest
run_tests_in_same_shell: false
