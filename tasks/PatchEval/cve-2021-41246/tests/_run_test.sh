#!/bin/bash
# From ghcr.io/anonymous2578-data/cve-2021-41246:latest
# bash /workspace/fix-run.sh
set -e

cd /workspace/express-openid-connect
git apply --whitespace=nowarn /tests/test.patch 
npx mocha --grep "should replace the cookie session when a new user is logging in over an existing different user|should preserve session but regenerate session id when a new user is logging in over an anonymous session|should regenerate the session when a new user is logging in over an existing different user"
cd /workspace
#!/bin/bash
# From ghcr.io/anonymous2578-data/cve-2021-41246:latest
# bash /workspace/unit_test.sh
set -e

cd /workspace/express-openid-connect
npx mocha test/callback.tests.js 