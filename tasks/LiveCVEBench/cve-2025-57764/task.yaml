instruction: |-
  I discovered a Reflected Cross-Site Scripting (XSS) vulnerability in WeGIA, a web-based
  management system for charitable institutions.

  The "Cargos" (Roles) management page at `/html/geral/cargos.php` accepts URL parameters
  `msg_e` (error message) and `msg_c` (success message) to display status notifications.
  However, these parameters are directly echoed into the HTML response without any
  sanitization or encoding.

  For example, accessing:
  `/html/geral/cargos.php?msg_e=<script>alert(document.cookie)</script>`

  Results in the JavaScript payload being executed in the victim's browser context,
  allowing an attacker to steal session cookies, perform actions on behalf of the user,
  or redirect users to malicious sites.

  The expected behavior is that any message content should be HTML-encoded before output,
  using functions like `htmlspecialchars()` in PHP, to prevent script execution.

  Note: This task uses a vulnerable version of cargos.php because the official 3.4.6
  release may have patched this specific issue.

difficulty: medium
category: security
tags:
  - php
  - web
  - xss
  - reflected-xss
  - output-encoding
parser_name: pytest

run_tests_in_same_shell: false
max_test_timeout_sec: 180
