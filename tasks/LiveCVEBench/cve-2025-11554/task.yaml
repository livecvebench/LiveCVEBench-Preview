instruction: |-
  This application is i-Educar, a school management system built with Laravel.
  It allows administrators to manage students, teachers, courses, enrollments,
  and user access levels.

  We have discovered a permission issue with the user type management feature.
  When we create a limited user account (e.g., a "Library Assistant" role with
  only view access to the library section), that user should NOT be able to
  access or modify user type settings.

  However, during testing we found that any authenticated user - regardless of
  their assigned permissions - can navigate to "/usuarios/tipos/{id}" and
  successfully modify user type permissions by sending a PUT request. This
  allows them to grant themselves (or their user type) full administrative
  access to all sections of the application.

  For example, a user with minimal permissions can send a request like:

    PUT /usuarios/tipos/5
    Content-Type: application/x-www-form-urlencoded

    name=LimitedUser&level=1&processes[87]=3&processes[88]=3&...

  After this request, the user's role suddenly has full access to everything.

  We expect the application to check whether the current user has permission
  to manage user types before allowing any create, update, or delete operations.
  The application already uses authorization middleware for other protected
  routes like exports and announcements. The user type management routes seem
  to be missing similar protection.

difficulty: medium
category: security
tags:
  - laravel
  - authorization
  - access-control
  - middleware
  - php
parser_name: pytest

run_tests_in_same_shell: false
