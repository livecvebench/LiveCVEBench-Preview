instruction: |-
  DjVuLibre is an open-source library for working with DjVu format documents,
  commonly used for scanned documents and images. The library provides tools like
  `ddjvu` for converting DjVu files to other formats.

  When processing certain malformed DjVu files, the decoder crashes unexpectedly.
  Specifically, when decoding a file with corrupted or malformed image data, the
  application terminates with a memory access error or produces corrupted output.

  Steps to reproduce:
  1. Attempt to decode a DjVu file with malformed data using `ddjvu`
  2. The application crashes or exhibits memory corruption

  Expected behavior: The decoder should detect malformed input data and reject it with
  an appropriate error message rather than crashing.

  Note: A sample malformed file that triggers this issue is available in
  `/app/task-deps/fuzzer-poc.djvu`.

difficulty: medium
category: security
tags:
  - memory-safety
  - bounds-checking
  - image-processing
  - c++
parser_name: pytest
run_tests_in_same_shell: false
