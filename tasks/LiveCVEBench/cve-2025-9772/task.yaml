instruction: |-
  RemoteClinic is a web-based medical practice management system that allows
  healthcare staff to manage patient records, prescriptions, and staff profiles.

  Users are reporting that when updating staff profiles through the profile editor
  (/staff/edit.php), the system accepts any type of file for the profile photo
  upload - including non-image files like text documents or scripts. The system
  simply saves these files with a .png extension regardless of their actual content.

  For example, uploading a text file containing "Hello World" results in a file
  saved as "{staff_id}.png" in the media/staff directory, but the file content
  remains unchanged as plain text rather than being validated or converted to an
  actual image.

  Expected behavior: The profile photo upload should only accept valid image files
  (JPEG, PNG, GIF). Non-image files should be rejected, and the system should
  verify the actual file content type before saving.

  Affected endpoint: /staff/edit.php (when authenticated with appropriate permissions)
  Upload location: /media/staff/{id}.png

difficulty: medium
category: security
tags:
  - php
  - file-upload
  - input-validation
  - web-application
parser_name: pytest

run_tests_in_same_shell: false
max_test_timeout_sec: 180
max_agent_timeout_sec: 600
