<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="jehc.djshi.oauth.dao.OauthFunctionRoleDao">
	<!--初始化分页-->
	<select id="getOauthFunctionRoleListByCondition" resultType="jehc.djshi.oauth.model.OauthFunctionRole" parameterType="map">
		SELECT
			oauth_function_role.id,
			oauth_function_role.function_info_id AS functionInfoId,
			oauth_function_role.role_id AS roleId,
			oauth_function_role.resources_id AS resourcesId,
			oauth_function_info.url AS url,
			oauth_function_info.method AS method,
			oauth_function_info.is_filter AS isFilter,
			oauth_function_info.is_authority AS isAuthority
		FROM
			oauth_function_role oauth_function_role LEFT JOIN oauth_function_info oauth_function_info ON oauth_function_info.id = oauth_function_role.function_info_id
		WHERE 1=1
			AND oauth_function_info.status = 0
			AND oauth_function_info.is_filter = 1
		<if test="null != roleId">
			AND oauth_function_role.role_id IN
			<foreach item="item" index="index" collection="roleId" open="(" separator="," close=")">
				#{item}
			</foreach>
		</if>
		<if test="null != functionInfoId">
			AND oauth_function_role.function_info_id = #{functionInfoId}
		</if>
		<if test="null != resourcesId">
			AND oauth_function_role.resources_id = #{resourcesId}
		</if>
	</select>

	<!--查询对象-->
	<select id="getOauthFunctionRoleById" resultType="jehc.djshi.oauth.model.OauthFunctionRole" parameterType="string">
		SELECT
			id,
			oauth_function_role.function_info_id AS functionInfoId,
			oauth_function_role.role_id AS roleId,
			oauth_function_role.resources_id AS resourcesId
		FROM 
			oauth_function_role
		WHERE id=#{id}
	</select>

	<!--添加-->
	<insert id="addOauthFunctionRole" parameterType="jehc.djshi.oauth.model.OauthFunctionRole">
		INSERT INTO
			oauth_function_role
			(
			id,
			function_info_id,
			role_id,
			resources_id
			)
			VALUES
			(
			#{id},
			#{functionInfoId},
			#{roleId},
			#{resourcesId}
			)
	</insert>

	<!--修改-->
	<update id="updateOauthFunctionRole" parameterType="jehc.djshi.oauth.model.OauthFunctionRole">
		UPDATE
			oauth_function_role
		SET
			function_info_id = #{functionInfoId},
			role_id = #{roleId},
			resources_id = #{resourcesId}
		WHERE id=#{id}
	</update>

	<!--修改（根据动态条件）-->
	<update id="updateOauthFunctionRoleBySelective" parameterType="jehc.djshi.oauth.model.OauthFunctionRole">
		UPDATE
			oauth_function_role
		<set>
			<if test="functionInfoId != null">
				function_info_id = #{functionInfoId},
			</if>
			<if test="roleId != null">
				role_id = #{roleId},
			</if>
			<if test="resourcesId != null">
				resources_id = #{resourcesId},
			</if>
		</set>
		WHERE id=#{id}
	</update>

	<!--删除-->
	<delete id="delOauthFunctionRole" parameterType="map">
		DELETE FROM oauth_function_role WHERE role_id = #{roleId}
	</delete>

	<!--批量修改-->
	<update id="updateBatchOauthFunctionRole" parameterType="list">
		<foreach collection="list" item="item" index="index" open="" close="" separator=";">
			UPDATE
				oauth_function_role
			SET
				function_info_id = #{item.functionInfoId},
				role_id = #{item.roleId},
				resources_id = #{item.resourcesId}
			WHERE id=#{item.id}
		</foreach>
	</update>

	<!--批量修改（根据动态条件）-->
	<update id="updateBatchOauthFunctionRoleBySelective" parameterType="list">
		<foreach collection="list" item="item" index="index" open="" close="" separator=";">
			UPDATE
				oauth_function_role
			<set>
				<if test="item.functionInfoId != null">
					function_info_id = #{item.functionInfoId},
				</if>
				<if test="item.roleId != null">
					role_id = #{item.roleId},
				</if>
				<if test="item.resourcesId != null">
					resources_id = #{item.resourcesId},
				</if>
			</set>
			WHERE id=#{item.id}
		</foreach>
	</update>
</mapper>