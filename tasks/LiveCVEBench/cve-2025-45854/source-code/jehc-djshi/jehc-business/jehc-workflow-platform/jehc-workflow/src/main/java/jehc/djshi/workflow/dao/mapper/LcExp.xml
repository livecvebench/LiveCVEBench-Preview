<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="jehc.djshi.workflow.dao.LcExpDao">
    <!--初始化分页-->
    <select id="getLcExpListByCondition" resultType="jehc.djshi.workflow.model.LcExp" parameterType="map">
        SELECT
            lc_exp.id,
            lc_exp.name,
            lc_exp.exp_val AS expVal,
            lc_exp.create_id AS createId,
            lc_exp.update_id AS updateId,
            lc_exp.create_time AS createTime,
            lc_exp.update_time AS updateTime,
            lc_exp.exp_col AS expCol,
            lc_exp.lc_product_id AS lcProductId,
            lc_exp.lc_group_id AS lcGroupId,
            lc_exp.remark,
            lc_exp.del_flag,
            lc_product.name AS productName,
            lc_group.name AS groupName
        FROM
            lc_exp lc_exp LEFT JOIN lc_product lc_product ON lc_product.id = lc_exp.lc_product_id
            LEFT JOIN lc_group lc_group ON  lc_group.id = lc_exp.lc_group_id
        WHERE 1=1
            AND lc_exp.del_flag = 0
            <if test="null != name">
                AND instr(lc_exp.name,#{name})
            </if>
    </select>

    <!--查询对象-->
    <select id="getLcExpById" resultType="jehc.djshi.workflow.model.LcExp" parameterType="string">
        SELECT
            lc_exp.id,
            lc_exp.name,
            lc_exp.exp_val AS expVal,
            lc_exp.create_id AS createId,
            lc_exp.update_id AS updateId,
            lc_exp.create_time AS createTime,
            lc_exp.update_time AS updateTime,
            lc_exp.exp_col AS expCol,
            lc_exp.lc_product_id AS lcProductId,
            lc_exp.lc_group_id AS lcGroupId,
            lc_exp.remark,
            lc_exp.del_flag,
            lc_product.name AS productName,
            lc_group.name AS groupName
        FROM
            lc_exp lc_exp LEFT JOIN lc_product lc_product ON lc_product.id = lc_exp.lc_product_id
                          LEFT JOIN lc_group lc_group ON  lc_group.id = lc_exp.lc_group_id
        WHERE lc_exp.id=#{id}
    </select>

    <!--添加-->
    <insert id="addLcExp" parameterType="jehc.djshi.workflow.model.LcExp">
        INSERT INTO
            lc_exp
        (
            id,
            name,
            exp_val,
            create_time,
            create_id,
            lc_expcol,
            lc_product_id,
            lc_group_id,
            remark
        )
        VALUES
        (
            #{id},
            #{name},
            #{expVal},
            #{createTime},
            #{createId},
            #{expCol},
            #{lcProductId},
            #{lcGroupId},
            #{remark}
        )
    </insert>

    <!--修改-->
    <update id="updateLcExp" parameterType="jehc.djshi.workflow.model.LcExp">
        UPDATE
            lc_exp
        SET
        <if test="null != name">
            name = #{name},
        </if>

        <if test="null != expVal">
            exp_val = #{expVal},
        </if>
        <if test="null != expCol">
            exp_col = #{expCol},
        </if>
        <if test="null != lcProductId">
            lc_product_id = #{lcProductId},
        </if>
        <if test="null != lcGroupId">
            lc_group_id = #{lcGroupId},
        </if>
        <if test="null != remark">
            remark = #{remark},
        </if>
        update_time = #{updateTime},
        update_id = #{updateId}
        WHERE id=#{id}
    </update>

    <!--删除-->
    <delete id="delLcExp" parameterType="map">
        UPDATE lc_exp SET del_flag = 1 WHERE id IN
        <foreach item="item" index="index" collection="id" open="(" separator="," close=")">
            #{item}
        </foreach>
    </delete>
</mapper>