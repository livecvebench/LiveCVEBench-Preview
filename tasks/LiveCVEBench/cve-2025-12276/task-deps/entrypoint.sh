#!/bin/bash
set -e

cd /app/api

# Run database migrations if needed
uv run alembic upgrade head || echo "Alembic migration skipped"

# Start the API in a restart loop
while true; do
    echo "[Entrypoint] Starting LearnHouse API..."
    uv run app.py || true
    echo "[Entrypoint] API process exited, restarting in 2 seconds..."
    sleep 2
done
