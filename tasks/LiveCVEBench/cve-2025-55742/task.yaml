instruction: |-
  UnoPim is an open-source Product Information Management (PIM) system built with
  Laravel. It allows administrators to manage users through the admin panel.

  When uploading a profile image for a user at `/admin/settings/users/create` or
  when editing an existing user, the application does not properly validate that
  the uploaded file's extension matches its actual content type.

  For example, a user can upload a file with a `.svg` extension that actually
  contains content of a different format (e.g., by prepending certain bytes to
  the file). The application accepts these mismatched files without validation,
  storing them with the declared extension regardless of the actual content.

  This creates inconsistent behavior where the browser interprets the file based
  on its extension while the server processed it based on content detection.
  Files should be validated to ensure the declared extension matches the actual
  MIME type of the uploaded content.

  We expect the application to reject files where the extension does not match
  the detected content type, displaying an appropriate validation error message.

difficulty: medium
category: bug-fix
tags:
  - php
  - laravel
  - file-upload
  - validation
parser_name: pytest

run_tests_in_same_shell: false
max_test_timeout_sec: 180
