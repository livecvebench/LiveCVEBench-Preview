instruction: |-
  This application is a web API server built with a TypeScript framework that uses
  Zod for schema validation. The server has a POST endpoint that accepts JSON data
  with nested object structures.

  When sending POST requests with certain object keys in the request body, the
  application exhibits unexpected behavior. Specifically, when the JSON body contains
  a nested object with special object property names (like __proto__), those
  properties appear to affect other unrelated objects in the application.

  For example, when sending this request:
  ```json
  {
    "data": {
      "messageId": "test",
      "__proto__": {
        "foo": "bar"
      }
    }
  }
  ```

  The response includes `"win": "bar"` when it should show `"win": null` since the
  `win` field is supposed to return the value of an empty object's `foo` property
  (which should be undefined/null).

  This indicates that properties from the request are leaking into other objects
  somehow. The deep object merge utility function doesn't appear to properly filter
  out dangerous property names that could affect object prototypes.

  Expected behavior: The application should safely process all requests without
  allowing request data to affect properties of unrelated objects. The response
  should always show `"win": null` regardless of what properties are in the request.

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: security
tags:
  - prototype-pollution
  - object-merge
  - typescript
  - web-api
parser_name: pytest

run_tests_in_same_shell: false
