instruction: |-
  FreshRSS is an RSS feed aggregator application. The application provides a query
  API endpoint (`/api/query.php`) that can serve content in multiple formats including
  RSS, Atom, JSON, OPML, and HTML.

  When accessing shared user queries through the HTML format
  (`/api/query.php?user=USER&t=TOKEN&f=html`), the response is missing important
  security headers that other response formats have. This inconsistency in header
  handling could allow content from subscribed feeds to execute unintended scripts
  in the user's browser when viewing the HTML output.

  The issue occurs because the HTML format branch in the API endpoint does not set
  the same Content-Security-Policy headers that other formats (like RSS and JSON)
  include. As a result, when feed content containing certain HTML attributes (such
  as media element event handlers) is displayed in the HTML view, the browser may
  execute embedded scripts.

  Expected behavior: All output formats from the query API should have appropriate
  Content-Security-Policy headers to prevent inline script execution, similar to
  how other API endpoints in the application handle this.

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: security
tags:
  - php
  - web-security
  - headers
  - rss-aggregator
parser_name: pytest
max_test_timeout_sec: 300.0
run_tests_in_same_shell: false
