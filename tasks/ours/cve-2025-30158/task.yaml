instruction: |-
  This is a PHP web application (NamelessMC) that provides forum functionality for
  community websites. The forum allows users to create topics and posts with rich
  HTML content, including embedded videos from YouTube and Vimeo.

  Users are reporting that certain forum posts cause the page to become completely
  unusable. When viewing these posts, an embedded video element expands to cover
  the entire viewport, making navigation buttons, menus, and other content
  completely inaccessible. The browser becomes unresponsive and users have to
  close the tab.

  Investigation shows that the problematic posts contain iframe elements with
  extremely large dimension values (e.g., width="9999999999" height="9999999999").
  These posts were created by authenticated users through the normal forum posting
  interface.

  The HTML sanitization should prevent embedded content from having arbitrarily
  large dimensions that disrupt the page layout, while still allowing legitimate
  video embeds to function properly.

  The relevant HTML sanitization code is in core/classes/Core/Output.php in the
  getPurified() method.

difficulty: easy
category: security
tags:
  - php
  - html-sanitization
  - htmlpurifier
  - denial-of-service
parser_name: pytest
run_tests_in_same_shell: false
