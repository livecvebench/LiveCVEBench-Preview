instruction: |-
  I'm using the evervault-go SDK to verify attestation documents from remote
  enclaves. I've discovered that the PCR validation is accepting attestation
  documents that it shouldn't.

  When I set up my client to expect certain PCR values (like PCR0="abc123"),
  attestation documents that have empty or missing PCR fields are still passing
  validation. This seems wrong - if I expect a specific PCR value and the
  received attestation has that field empty, validation should fail.

  Here's what I'm seeing:
  - I configure expected PCRs with specific values
  - Remote sends an attestation document with empty/missing PCR fields
  - The Equal() method returns true instead of false
  - My client accepts an enclave it shouldn't trust

  I think the validation needs to ensure that:
  - Received attestation documents have the required PCR fields populated
  - Empty received values don't match non-empty expected values

  Can you fix the attestation validation to properly reject incomplete
  attestation documents?

difficulty: medium
category: bug-fix
tags:
  - go
  - attestation
  - validation
  - cryptography
parser_name: pytest

run_tests_in_same_shell: false
max_test_timeout_sec: 120.0
