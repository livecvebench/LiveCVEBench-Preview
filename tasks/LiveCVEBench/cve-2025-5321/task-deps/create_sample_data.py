#!/usr/bin/env python3
"""Create sample data for Aim repository.

This script creates sample runs with tracked metrics so that
the search API endpoints can function properly.
"""
import os
import sys

# The repo path should be the parent directory of .aim (i.e., /app if .aim is at /app/.aim)
# Aim looks for the .aim directory inside the specified path
repo_path = '/app'

try:
    from aim import Repo, Run

    # Check if runs already exist
    repo = Repo(repo_path)
    existing_runs = list(repo.iter_runs())
    if len(existing_runs) > 0:
        print(f"Runs already exist ({len(existing_runs)} runs found), skipping sample data creation")
        sys.exit(0)

    # Create a sample run
    print("Creating sample data...")
    run = Run(repo=repo_path)
    run.name = "sample_run"
    run['hparams'] = {
        'learning_rate': 0.01,
        'batch_size': 32,
        'optimizer': 'adam'
    }

    # Track some metrics
    for i in range(10):
        run.track(0.5 - i * 0.02, name='loss', step=i, context={'is_training': True})
        run.track(0.7 + i * 0.02, name='accuracy', step=i, context={'is_training': True})

    run.close()
    print("Sample data created successfully")

except Exception as e:
    print(f"Warning: Could not create sample data: {e}")
    sys.exit(0)
