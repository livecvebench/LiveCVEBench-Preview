#!/bin/bash
# From ghcr.io/anonymous2578-data/cve-2021-22538:latest
# bash /workspace/fix-run.sh
set -e

cd /workspace/exposure-notifications-verification-server
git apply --whitespace=nowarn /tests/test.patch 
go test -timeout 30s -run ^TestRequiredPermissions$/^escalate$ github.com/google/exposure-notifications-verification-server/pkg/rbac

cd /workspace
#!/bin/bash
# From ghcr.io/anonymous2578-data/cve-2021-22538:latest
# bash /workspace/unit_test.sh
set -e

cd /workspace/exposure-notifications-verification-server
go test -timeout 30s -run '^(TestRequiredPermissions|TestImpliedBy|TestPermission_Description|TestPermission_String|TestRBAC_Permissions|TestPermission_Implied|TestPermission_Value|TestPermissionNames)$' github.com/google/exposure-notifications-verification-server/pkg/rbac