<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="jehc.djshi.oauth.dao.OauthAdminSysDao">

    <!--初始化分页-->
    <select id="getOauthAdminSysList" resultType="jehc.djshi.oauth.model.OauthAdminSys" parameterType="map">
        SELECT
            oauth_admin_sys.id,
            oauth_admin_sys.sys_mode_id AS sysModeId,
            oauth_admin_sys.admin_id AS adminId,
            oauth_sys_mode.name AS sysName,
            oauth_sys_mode.mode AS sysMode,
            app_key AS appKey,
            app_secret AS appSecret,
            key_exp_date AS keyExpDate,
            use_exp_date AS useExpDate
        FROM
            oauth_admin_sys oauth_admin_sys LEFT JOIN oauth_sys_mode oauth_sys_mode ON oauth_sys_mode.id = oauth_admin_sys.sys_mode_id
            LEFT JOIN oauth_key_info oauth_key_info ON oauth_key_info.id = oauth_sys_mode.key_info_id
        WHERE  1=1
        <if test="null != adminId">
            AND oauth_admin_sys.admin_id in
            <foreach item="item" index="index" collection="adminId" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        AND oauth_sys_mode.status = 0
        AND oauth_key_info.status = 0
    </select>

    <!--添加-->
    <insert id="addOauthAdminSys" parameterType="jehc.djshi.oauth.model.OauthAdminSys">
        INSERT INTO
        oauth_admin_sys
        (
        id,
        sys_mode_id,
        admin_id
        )
        VALUES
        (
        #{id},
        #{sysModeId},
        #{adminId}
        )
    </insert>

    <select id="getSingleOauthAdminSys" resultType="jehc.djshi.oauth.model.OauthAdminSys" parameterType="map">
        SELECT
        oauth_admin_sys.id,
        oauth_admin_sys.sys_mode_id AS sysModeId,
        oauth_admin_sys.admin_id AS adminId
        FROM
        oauth_admin_sys oauth_admin_sys
        WHERE oauth_admin_sys.sys_mode_id = #{sysModeId} AND oauth_admin_sys.admin_id = #{adminId}
    </select>

    <delete id="delOauthAdminSys" parameterType="string">
        DELETE  FROM oauth_admin_sys WHERE id = #{id}
    </delete>

    <select id="getOauthAdminSysListByCondition" resultType="jehc.djshi.oauth.model.OauthAdminSys" parameterType="map">
        SELECT
            oauth_admin_sys.id,
            oauth_admin_sys.sys_mode_id AS sysModeId,
            oauth_admin_sys.admin_id AS adminId
        FROM
            oauth_admin_sys oauth_admin_sys  LEFT JOIN
            oauth_admin oauth_admin ON oauth_admin.id = oauth_admin_sys.admin_id
        WHERE oauth_admin_sys.sys_mode_id = #{sysModeId} AND oauth_admin.account_id = #{accountId}
    </select>
</mapper>