#!/bin/bash
# From ghcr.io/anonymous2578-data/cve-2020-29529:latest
# bash /workspace/fix-run.sh
set -e

cd /workspace/go-slug
git apply --whitespace=nowarn /tests/test.patch 
go test   -timeout 30s -run ^TestUnpackMaliciousSymlinks$ github.com/hashicorp/go-slug

cd /workspace
#!/bin/bash
# From ghcr.io/anonymous2578-data/cve-2020-29529:latest
# bash /workspace/unit_test.sh
set -e

cd /workspace/go-slug
go test -timeout 30s -run '^(TestUnpackErrorOnUnhandledType|TestUnpackDuplicateNoWritePerm|TestPackWithoutDereferencing|TestUnpack|TestCheckFileMode|TestPackWithDereferencing|TestUnpackMaliciousSymlinks|TestPack)$' github.com/hashicorp/go-slug