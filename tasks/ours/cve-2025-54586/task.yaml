instruction: |-
  GitProxy is a compliance gateway that sits between developers and Git remote
  endpoints. It enforces security policies on git push operations before they
  reach the upstream repository.

  We've discovered an issue where the proxy validates only the ref-update
  information (the oldOid -> newOid reference update) but doesn't verify that
  the actual packfile contents match the declared commits. This means commits
  included in the packfile that are not part of the declared commit range can
  pass through without validation.

  For example, if a push declares it's updating a branch from commit A to commit B,
  the proxy should verify that only commits in the A..B range are present in the
  packfile. Currently, additional commits not in this range slip through unvalidated.

  The expected behavior is:
  1. When receiving a push, track which pack files (.idx files) are created
  2. Compare commits in the packfile against the declared commit range (oldOid..newOid)
  3. Block the push if any commits in the pack are not within the expected range
  4. Provide clear error messages identifying which commits are problematic

  The push processing chain is in `src/proxy/chain.ts` and the pack writing logic
  is in `src/proxy/processors/push-action/writePack.ts`.

difficulty: hard
category: security
tags:
  - typescript
  - git
  - proxy
  - validation
parser_name: pytest

run_tests_in_same_shell: false
