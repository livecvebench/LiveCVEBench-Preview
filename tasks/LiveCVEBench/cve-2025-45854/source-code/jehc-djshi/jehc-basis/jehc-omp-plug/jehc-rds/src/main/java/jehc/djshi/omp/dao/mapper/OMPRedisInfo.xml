<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="jehc.djshi.omp.dao.OMPRedisInfoDao">
    <!--初始化分页-->
    <select id="getRedisInfoListByCondition" resultType="jehc.djshi.omp.model.OMPRedisInfo" parameterType="map">
        SELECT
            omp_redis_info.id,
            omp_redis_info.main_id AS mainId,
            omp_redis_info.config_id AS configId,
            omp_redis_info.create_time AS createTime,
            omp_redis_config.name,
            omp_redis_config.host
        FROM
            omp_redis_info omp_redis_info LEFT JOIN omp_redis_config omp_redis_config ON omp_redis_config.id = omp_redis_info.config_id
        WHERE 1=1
        <if test="null != name">
            AND omp_redis_config.name LIKE CONCAT(CONCAT('%',#{name}),'%')
        </if>
        <if test="null != host">
            AND omp_redis_config.host LIKE CONCAT(CONCAT('%',#{host}),'%')
        </if>
        ORDER BY omp_redis_info.create_time DESC
    </select>

    <!--查询对象-->
    <select id="getRedisInfoById" resultType="jehc.djshi.omp.model.OMPRedisInfo" parameterType="string">
        SELECT
            omp_redis_info.id,
            omp_redis_info.main_id AS mainId,
            omp_redis_info.config_id AS configId,
            omp_redis_info.create_time AS createTime,
            omp_redis_config.name,
            omp_redis_config.host
        FROM
          omp_redis_info omp_redis_info LEFT JOIN omp_redis_config omp_redis_config ON omp_redis_config.id = omp_redis_info.config_id
        WHERE id=#{id}
    </select>

    <!--添加-->
    <insert id="addRedisInfo" parameterType="jehc.djshi.omp.model.OMPRedisInfo">
        INSERT INTO
        omp_redis_info
        (
        id,
        main_id,
        config_id,
        create_time,
        update_time,
        create_id,
        update_id,
        del_flag
        )
        VALUES
        (
        #{id},
        #{mainId},
        #{configId},
        #{createTime},
        #{updateTime},
        #{createId},
        #{updateId},
        0
        )
    </insert>

    <!--删除-->
    <delete id="delRedisInfo" parameterType="map">
        DELETE FROM omp_redis_info WHERE id IN
        <foreach item="item" index="index" collection="id" open="(" separator="," close=")">
            #{item}
        </foreach>
    </delete>
</mapper>