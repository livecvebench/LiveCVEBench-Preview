instruction: |-
  This is a PHP e-commerce application called HashTech that sells electronics
  and gadgets. The application includes a customer-facing storefront and an
  administrative interface for managing products, orders, and user accounts.

  Users have reported that they can access the admin dashboard and other
  administrative pages directly by navigating to URLs like /admin_index.php,
  /user_list.php, or /gadget_list.php without logging in first. When they
  access these URLs, they see the full admin interface with all functionality
  available, including the ability to view customer data, manage products, and
  see orders.

  Expected behavior: Accessing any admin page without being logged in should
  redirect the user to the admin login page (admin_login.php). Only after
  successfully authenticating with valid admin credentials should users be
  able to access the admin dashboard and related pages.

  For testing admin functionality after your fix, use these credentials:
  - Email: root@hashtech.com
  - Password: admin

difficulty: medium
category: bug-fix
tags:
  - php
  - access-control
  - session-management
  - authentication
parser_name: pytest

run_tests_in_same_shell: false
