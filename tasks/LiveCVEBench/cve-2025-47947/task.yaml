instruction: |-
  ModSecurity is a web application firewall (WAF) module for Apache that inspects
  and filters HTTP requests to protect web applications from common attacks.

  Users are reporting that the Apache server becomes unresponsive or crashes when
  processing certain JSON payloads. The issue occurs when:

  - A POST request is sent with Content-Type: application/json
  - The JSON body contains arrays or objects with multiple elements (e.g., 50+ items)
  - The server has ModSecurity rules that log or redact matched data in audit logs

  Symptoms observed:
  - Memory usage grows unexpectedly and disproportionately with JSON payload size
  - Larger JSON arrays cause exponentially worse memory consumption
  - With arrays of 100+ elements, the Apache process may consume gigabytes of memory
  - The server eventually becomes unresponsive or the process is killed by OOM
  - Normal (non-JSON) requests and small JSON payloads work fine

  The expected behavior is that JSON payloads should be processed efficiently
  regardless of array size, with memory consumption growing linearly (not
  exponentially) with the number of elements.

  Your task is to investigate the root cause of this memory issue and implement
  a fix that prevents excessive memory consumption while maintaining all existing
  functionality.

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: bug-fix
tags:
  - memory
  - performance
  - apache
  - modsecurity
  - json
parser_name: pytest

run_tests_in_same_shell: false
