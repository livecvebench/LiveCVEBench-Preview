instruction: |-
  HexStrike AI is an MCP (Model Context Protocol) server that enables AI agents to
  execute cybersecurity tools through API endpoints. The server provides tools like
  nmap, gobuster, nuclei and 150+ other security utilities via a REST API.

  Users have reported that the /api/tools/nmap endpoint processes command-line
  arguments incorrectly. When users provide additional arguments through the API,
  the server executes unintended commands. For example, when a user sends a request
  with "additional_args" containing special shell characters like semicolons (;),
  pipes (|), or backticks (`), those characters are interpreted by the shell rather
  than being passed as literal arguments to the tool.

  This causes unpredictable behavior - the server might execute completely different
  commands than intended, or arguments may be parsed incorrectly. Users expect
  that their input is passed safely to the underlying tool without being interpreted
  as shell metacharacters.

  The issue exists in the EnhancedCommandExecutor class which handles command
  execution. The server uses shell=True with subprocess, and user inputs are
  concatenated directly into command strings without proper escaping. This affects
  all tool endpoints that accept user-provided arguments.

  Fix the application so that user-provided arguments are properly sanitized before
  being passed to shell execution. The nmap endpoint (and similar tool endpoints)
  should treat user input as literal arguments rather than allowing shell
  interpretation of special characters.

difficulty: medium
category: security
tags:
  - command-injection
  - input-validation
  - python
  - flask
  - subprocess
parser_name: pytest

run_tests_in_same_shell: false
