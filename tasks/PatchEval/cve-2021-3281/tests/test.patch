diff --git a/tests/utils_tests/test_archive.py b/tests/utils_tests/test_archive.py
index dc7c4b4ebd9a..8fdf3ec4459b 100644
--- a/tests/utils_tests/test_archive.py
+++ b/tests/utils_tests/test_archive.py
@@ -4,6 +4,8 @@
 import tempfile
 import unittest
 
+from django.core.exceptions import SuspiciousOperation
+from django.test import SimpleTestCase
 from django.utils import archive
 
 
@@ -45,3 +47,22 @@ def test_extract_file_permissions(self):
                 # A file is readable even if permission data is missing.
                 filepath = os.path.join(tmpdir, 'no_permissions')
                 self.assertEqual(os.stat(filepath).st_mode & mask, 0o666 & ~umask)
+
+
+class TestArchiveInvalid(SimpleTestCase):
+    def test_extract_function_traversal(self):
+        archives_dir = os.path.join(os.path.dirname(__file__), 'traversal_archives')
+        tests = [
+            ('traversal.tar', '..'),
+            ('traversal_absolute.tar', '/tmp/evil.py'),
+        ]
+        if sys.platform == 'win32':
+            tests += [
+                ('traversal_disk_win.tar', 'd:evil.py'),
+                ('traversal_disk_win.zip', 'd:evil.py'),
+            ]
+        msg = "Archive contains invalid path: '%s'"
+        for entry, invalid_path in tests:
+            with self.subTest(entry), tempfile.TemporaryDirectory() as tmpdir:
+                with self.assertRaisesMessage(SuspiciousOperation, msg % invalid_path):
+                    archive.extract(os.path.join(archives_dir, entry), tmpdir)
diff --git a/tests/utils_tests/traversal_archives/traversal.tar b/tests/utils_tests/traversal_archives/traversal.tar
new file mode 100644
index 0000000000000000000000000000000000000000..07eede517a56bdcfd67d561015eb8764ab7bfd82
GIT binary patch
literal 10240
zcmeIwO$x&x5QgD7iYG`MiF%$cA_M{{{Ug17BSpy1qAM4n?`(!RM26=xO;g)6t<)^L
zRE%DhrqSDV&!b$Towd$8)u>`sI~T?HnoE_tpZCY*W{jkM9Ok*49{aEP@sCrSq;LNH
zYZ#mByUxlv;1IfX?&TfiQLbJ7F1jGb)>&tJ>!0Vp#o!A81Q0*~0R#|0009ILKmY**
g5I_I{1Q0*~0R#|0009ILKmY**5I_I{1kNPz0VrH4j{pDw

literal 0
HcmV?d00001

diff --git a/tests/utils_tests/traversal_archives/traversal_absolute.tar b/tests/utils_tests/traversal_archives/traversal_absolute.tar
new file mode 100644
index 0000000000000000000000000000000000000000..231566b0699d48145cb6fa5c0c792c2569417a19
GIT binary patch
literal 10240
zcmeIwO$x#=5QgD7N={%WX@1V*qJ=`GMXS`?+X!Md#Z^G@olOEmlHvK%Pg5h6OSeiX
z$hO!Nv|Mv5msqdrf{R|0sI|_uVnXG)p4VS5%kgZC^xZhD>;8+M`uiupy3;JDx#@1h
zc$n|C2F(G-=*!$+{~)(=z4Q0&mcNTOiqTpFmG}O6{v`!_1Q0*~0R#|0009ILKmY**
h5I_I{1Q0*~0R#|0009ILKmY**5I_I{1Q7Twfd`<_D7ydv

literal 0
HcmV?d00001

diff --git a/tests/utils_tests/traversal_archives/traversal_disk_win.tar b/tests/utils_tests/traversal_archives/traversal_disk_win.tar
new file mode 100644
index 0000000000000000000000000000000000000000..97f0b95501c1a67b3f04f8d8736de172af68eb57
GIT binary patch
literal 10240
zcmeIwTMEK35QX7cN>-qg*lEDs2)0ltRJ>7lZ&DCiq4*R~{O2W<L(}0qZHHkig-6rG
zXp#;eP3LEh@`$fggL&J<lzSh7inGFdP1oNp*TdO4X`8+q$Mr9M%Gclg>ZDEmANS3@
z>o=!Ip-pqabzRMSfBgqJ%JbHLh-Tun&_0W6|GfW&1rG=yfB*srAb<b@2q1s}0tg_0
f00IagfB*srAb<b@2q1s}0tg_000Iag@KXX$VtOeU

literal 0
HcmV?d00001

diff --git a/tests/utils_tests/traversal_archives/traversal_disk_win.zip b/tests/utils_tests/traversal_archives/traversal_disk_win.zip
new file mode 100644
index 0000000000000000000000000000000000000000..e5ab2083985e778b984235ab2e9b8e9c193691ad
GIT binary patch
literal 312
zcmWIWW@h1H0D-I+vmh`7O0Y1<Fr?+@>xYJLGBBsF;!4N{;?fFk21b?_%nS@*A^@ju
zUa0OAtJJd09KC`{xG^B3FpObjl4Hi@3<;=%1Q`B0f|w9Tu|gb0f=Rp#Fq0S<wlvy7
YO+s=YE+bjlK-Mw=;aniy3gR#T02jY7-T(jq

literal 0
HcmV?d00001

