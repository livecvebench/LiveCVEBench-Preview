instruction: |-
  This is pdfminer.six, a community-maintained fork of PDFMiner for extracting
  information from PDF documents.

  When loading CMap (Character Map) data from custom directories specified via the
  CMAP_PATH environment variable, the application may load data files from
  unintended locations. Specifically, the `CMapDB._load_data()` method in
  `pdfminer/cmapdb.py` doesn't validate that the resolved file path stays within
  the intended CMap directories.

  For example, if CMAP_PATH is set to "/data/cmaps", a request for a CMap named
  "../../../tmp/malicious" could resolve to a path outside the intended directory.
  The method should validate that any loaded file is actually within one of the
  configured CMap directories.

  We expect the application to only load CMap data files from within the explicitly
  configured directories, rejecting any paths that resolve outside those boundaries.

difficulty: medium
category: security
tags:
  - python
  - path-traversal
  - input-validation
  - pdf-processing
parser_name: pytest

run_tests_in_same_shell: false
