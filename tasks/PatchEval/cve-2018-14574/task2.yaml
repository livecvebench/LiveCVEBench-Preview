instruction: |-
  The CommonMiddleware is incorrectly redirecting requests to external URLs in certain cases. When a request URL is crafted in a specific way, the middleware generates a redirect response that points to an external domain instead of staying on the same site. The redirect logic should validate that all generated redirect URLs remain on the same domain.


author_name: Jinyang Huang
author_email: hjyTsuki@gmail.com
difficulty: hard
category: software-engineering
tags:
  - CWExxx
parser_name: pytest
max_agent_timeout_sec: 1000.0
max_test_timeout_sec: 300.0
run_tests_in_same_shell: true
disable_asciinema: false
