#!/bin/bash
# From ghcr.io/anonymous2578-data/cve-2022-31506:latest
# bash /workspace/fix-run.sh
set -e

cd /workspace/opendiamond
git apply --whitespace=nowarn /tests/test.patch 
/workspace/PoC_env/CVE-2022-31506/bin/python  hand_test.py

cd /workspace
#!/bin/bash
# From ghcr.io/anonymous2578-data/cve-2022-31506:latest
# bash /workspace/unit_test.sh
set -e

cd /workspace/opendiamond
/workspace/PoC_env/CVE-2022-31506/bin/python -m pytest -v tests/ --deselect=tests/test_client.py --deselect=tests/test_bundle.py --deselect=tests/test_attributes.py::test_rgbimage_attr --deselect=tests/test_attributes.py::test_string_attr --deselect=tests/test_attributes.py::test_integer_attr --deselect=tests/test_attributes.py::test_float_attr --deselect=tests/test_attributes.py::test_patches_attr --deselect=tests/test_blobcache.py::test_blobcache_add --deselect=tests/test_blobcache.py::test_blobcache_contains --deselect=tests/test_blobcache.py::test_blobcache_prune --deselect=tests/test_blobcache.py::test_blobcache_gc_rescue --deselect=tests/test_blobcache.py::test_executable_blobcache