instruction: |-
  Atheos is a self-hosted, browser-based cloud IDE that provides a lightweight code
  editing environment accessible through any web browser.

  When making POST requests to the controller.php endpoint, some specially crafted
  values in the "target" parameter can cause unexpected behavior. For example, using
  target values containing directory traversal sequences (e.g., "../workspace" or
  "../../some/path") allows the application to load PHP files from directories
  outside the intended "components" and "plugins" folders.

  We observed that sending a request like:
    POST /controller.php
    target=../workspace/somefolder&action=test

  Causes the application to attempt loading files from the workspace directory
  instead of properly rejecting the request. This bypasses the intended component
  routing mechanism and could allow unauthorized file inclusion.

  The expected behavior is that the controller should only load files from the
  legitimate "components/" and "plugins/" directories. Any path traversal attempts
  should be rejected, and the user should receive an appropriate error response.

  Please fix this input validation issue in controller.php to ensure the target
  parameter cannot escape the intended directories.

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: security
tags:
  - php
  - path-traversal
  - input-validation
  - web-application
parser_name: pytest

run_tests_in_same_shell: false
