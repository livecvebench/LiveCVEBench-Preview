instruction: |-
  This is a Node.js library that provides utilities for creating temporary files and
  directories on the filesystem. Users can specify custom locations within the system's
  temporary directory for their temporary files.

  Issue Description:

  When users provide custom directory paths for temporary file creation, the library
  should validate that all files are created within the system's temporary directory.
  However, certain filesystem constructs can bypass this validation.

  Conditions:
  - Occurs when users provide custom 'dir' or 'template' options to library functions
  - Affects operations that accept user-specified paths for temporary file creation

  Observed Symptoms:
  - Path validation can be bypassed using indirect filesystem references
  - Files can be created outside the intended temporary directory
  - The validation checks the normalized path string but not the actual filesystem location

  Expected Behavior:
  - All temporary files should remain within the system's temporary directory
  - Path validation should resolve to the actual canonical filesystem location
  - Any attempt to create files outside the temporary directory should be rejected

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: security
tags:
  - path-validation
  - filesystem
  - nodejs
  - npm-library
parser_name: pytest

run_tests_in_same_shell: false
