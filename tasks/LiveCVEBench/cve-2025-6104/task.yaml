instruction: |-
  This application is a WiFi hotspot controller that includes a Property Management
  System (PMS) integration module. The PMS check feature allows administrators to
  verify network connectivity to external PMS servers by providing an IP address
  to ping.

  When using the PMS connectivity check endpoint (`/billing/pms_check.php`), certain
  input values cause unexpected behavior. For example, providing input containing
  special characters like backticks, semicolons, or newlines results in the server
  executing unintended operations. In some cases, files appear in the `/network/`
  directory that shouldn't be there, or server commands get executed.

  We observed that providing input like "`whoami`" or "127.0.0.1;ls" causes system
  commands to run instead of just performing a connectivity check. The application
  should only accept valid IP addresses and perform a simple ping operation without
  any side effects.

  Expected behavior: The endpoint should validate that the input is a properly
  formatted IP address and reject any input containing special characters or
  invalid formats.

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: easy
category: bug-fix
tags:
  - php
  - input-validation
  - web-application
parser_name: pytest
test_timeout: 300

run_tests_in_same_shell: false
