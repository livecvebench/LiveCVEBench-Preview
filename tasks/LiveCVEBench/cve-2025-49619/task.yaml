instruction: |-
  Skyvern is an AI-powered browser automation platform that uses workflows to
  execute browser tasks. Workflows can include template expressions in their
  prompt fields to support dynamic content generation.

  Users have reported that when they create workflows with certain template
  expressions, the application processes more than just simple variable
  substitutions. Specifically, template strings containing Python object
  references (like accessing class attributes or special methods) are being
  evaluated directly by the template engine.

  For example, a template string like "{{ ().__class__.__base__ }}" returns
  information about Python's internal object hierarchy instead of being treated
  as an error or filtered. This behavior allows template expressions to access
  Python internals that should not be reachable from user-provided input.

  The template rendering happens in the workflow block processing code when
  user-supplied prompts are rendered. The expected behavior is that template
  expressions should only allow access to explicitly provided workflow context
  variables, not arbitrary Python object traversal.

  We expect the template engine to restrict what expressions can access,
  preventing evaluation of expressions that traverse Python's class hierarchy
  or access special attributes like __class__, __base__, __subclasses__, etc.

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: security
tags:
  - template-injection
  - jinja2
  - python
  - input-validation
parser_name: pytest
run_tests_in_same_shell: false
