instruction: |-
  This application provides a data URI parsing utility in its frontend library.
  The parseDataUri function is located in frontend/src/metabase/lib/dom.js.

  When processing certain malformed data URI strings, the application becomes
  completely unresponsive. For example, strings with patterns like repeated
  null bytes followed by commas (e.g., a string constructed with many "\u0000,"
  sequences) cause the function to hang indefinitely.

  During testing, we observed that inputs like:
    "data:\u0000" + "\u0000,".repeat(100000) + "\n1\n"
  cause the function to never return, eventually exhausting CPU resources.

  We expect the function to handle any input gracefully and return within
  a reasonable time frame (under 1 second) for any input, returning null
  for malformed data URIs while still correctly parsing valid ones.

  Requirements:
  1. The function must complete processing within 1 second for any input
  2. Valid data URIs must still be parsed correctly (mime type, charset, base64 data)
  3. Invalid or malformed inputs should return null without hanging

difficulty: medium
category: bug-fix
tags:
  - javascript
  - regex
  - performance
  - frontend
parser_name: pytest

run_tests_in_same_shell: false
