instruction: |-
  This application is a WebSocket server built using the Mongoose C networking library.
  It provides a simple echo service at the /websocket endpoint.

  When processing WebSocket messages with fragmented frames, the server crashes if it
  receives a continuation frame (opcode 0x0) as the very first frame of a connection,
  without any preceding data frames. The server outputs memory-related errors such as
  "heap-buffer-overflow" or "segmentation fault" and terminates unexpectedly.

  For example, if a client establishes a WebSocket connection and immediately sends a
  frame with FIN=1 and opcode=0 (CONTINUE) before sending any initial data frame, the
  server crashes. This sequence of frames is malformed according to the WebSocket
  protocol (RFC 6455), but the server should handle it gracefully rather than crashing.

  The expected behavior is that the server should either ignore such malformed frames
  or close the connection cleanly, but it should not crash or corrupt memory.

difficulty: medium
category: bug-fix
tags:
  - websocket
  - c
  - network
  - protocol-handling
parser_name: pytest

run_tests_in_same_shell: false
