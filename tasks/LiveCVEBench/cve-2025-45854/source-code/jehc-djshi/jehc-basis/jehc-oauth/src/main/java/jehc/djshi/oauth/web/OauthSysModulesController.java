package jehc.djshi.oauth.web;
import java.util.List;
import java.util.HashMap;
import java.util.Map;
import io.swagger.annotations.Api;
import io.swagger.annotations.ApiOperation;
import jehc.djshi.common.annotation.Auth;
import jehc.djshi.common.base.BaseAction;
import jehc.djshi.common.base.BasePage;
import jehc.djshi.common.base.BaseResult;
import jehc.djshi.common.base.BaseSearch;
import jehc.djshi.common.entity.OauthAccountEntity;
import jehc.djshi.common.util.StringUtil;
import jehc.djshi.oauth.model.OauthSysModules;
import jehc.djshi.oauth.service.OauthSysModulesService;
import org.springframework.web.bind.annotation.DeleteMapping;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.PutMapping;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.*;
import com.github.pagehelper.PageInfo;
import javax.annotation.Resource;
/**
 * @Desc 授权中心子系统模块
 * @Author 邓纯杰
 * @CreateTime 2012-12-12 12:12:12
 */
@RestController
@RequestMapping("/oauthSysModules")
@Api(value = "授权中心子系统模块API",tags = "授权中心子系统模块API",description = "授权中心子系统模块API")
public class OauthSysModulesController extends BaseAction {

	@Resource
	private OauthSysModulesService oauthSysModulesService;

	/**
	* 查询子系统模块列表并分页
	* @param baseSearch 
	*/
	@PostMapping(value="/list")
	@ApiOperation(value="查询子系统模块列表并分页", notes="查询子系统模块列表并分页")
	@Auth(value = "/oauthSysModules/list",authenticationType = Auth.AuthorizationType.REQUIRED_LOGIN_NOT_AUTH)
	public BasePage<List<OauthSysModules>> getOauthSysModulesListByCondition(@RequestBody BaseSearch baseSearch){
		Map<String, Object> condition = baseSearch.convert();
		commonHPager(baseSearch);
		List<OauthSysModules> oauthSysModulesList = oauthSysModulesService.getOauthSysModulesListByCondition(condition);
		for(OauthSysModules oauthSysModules:oauthSysModulesList){
			if(!StringUtil.isEmpty(oauthSysModules.getCreateId())){
				OauthAccountEntity createBy = getAccount(oauthSysModules.getCreateId());
				if(null != createBy){
					oauthSysModules.setCreateBy(createBy.getName());
				}
			}
			if(!StringUtil.isEmpty(oauthSysModules.getUpdateId())){
				OauthAccountEntity modifiedBy = getAccount(oauthSysModules.getUpdateId());
				if(null != modifiedBy){
					oauthSysModules.setModifiedBy(modifiedBy.getName());
				}
			}
		}
		PageInfo<OauthSysModules> page = new PageInfo<OauthSysModules>(oauthSysModulesList);
		return outPageBootStr(page,baseSearch);
	}

	/**
	 * 查询子系统模块列表
	 * @param sysModeId
	 * @return
	 */
	@ApiOperation(value="查询子系统模块列表", notes="查询子系统模块列表")
	@PostMapping(value="/list/{sysModeId}")
	@Auth(value = "/oauthSysModules/get",authenticationType = Auth.AuthorizationType.REQUIRED_LOGIN_NOT_AUTH)
	public BaseResult<List<OauthSysModules>> getOauthSysModulesListBySysId(@PathVariable("sysModeId")String sysModeId){
		Map<String,Object> condition = new HashMap<>();
		condition.put("sysModeId",sysModeId.split(","));
		List<OauthSysModules> oauthSysModulesList = oauthSysModulesService.getOauthSysModulesListByCondition(condition);
		return new BaseResult(oauthSysModulesList);
	}

	/**
	 * 全部模块
	 * @return
	 */
	@PostMapping(value="/listAll")
	@ApiOperation(value="查询全部模块", notes="查询全部模块")
	@Auth(value = "/oauthSysModules/listAll",authenticationType = Auth.AuthorizationType.REQUIRED_LOGIN_NOT_AUTH)
	public BaseResult<List<OauthSysModules>> getOauthSysModulesList(){
		Map<String,Object> condition = new HashMap<>();
		List<OauthSysModules> oauthSysModulesList = oauthSysModulesService.getOauthSysModulesListByCondition(condition);
		return outDataStr(oauthSysModulesList);
	}

	/**
	* 查询单个子系统模块
	* @param sys_modules_id 
	*/
	@ApiOperation(value="查询单个子系统模块", notes="查询单个子系统模块")
	@GetMapping(value="/get/{sys_modules_id}")
	@Auth(value = "/oauthSysModules/get",authenticationType = Auth.AuthorizationType.REQUIRED_LOGIN_NOT_AUTH)
	public BaseResult<OauthSysModules> getOauthSysModulesById(@PathVariable("sys_modules_id")String sys_modules_id){
		OauthSysModules oauthSysModules = oauthSysModulesService.getOauthSysModulesById(sys_modules_id);
		if(!StringUtil.isEmpty(oauthSysModules.getCreateId())){
			OauthAccountEntity createBy = getAccount(oauthSysModules.getCreateId());
			if(null != createBy){
				oauthSysModules.setCreateBy(createBy.getName());
			}
		}
		if(!StringUtil.isEmpty(oauthSysModules.getUpdateId())){
			OauthAccountEntity modifiedBy = getAccount(oauthSysModules.getUpdateId());
			if(null != modifiedBy){
				oauthSysModules.setModifiedBy(modifiedBy.getName());
			}
		}
		return outDataStr(oauthSysModules);
	}

	/**
	* 添加
	* @param oauthSysModules 
	*/
	@ApiOperation(value="创建单个子系统模块", notes="创建单个子系统模块")
	@PostMapping(value="/add")
	public BaseResult addOauthSysModules(@RequestBody OauthSysModules oauthSysModules){
		int i = 0;
		if(null != oauthSysModules){
			i=oauthSysModulesService.addOauthSysModules(oauthSysModules);
		}
		if(i>0){
			return outAudStr(true);
		}else{
			return outAudStr(false);
		}
	}

	/**
	* 修改
	* @param oauthSysModules 
	*/
	@ApiOperation(value="编辑单个子系统模块", notes="编辑单个子系统模块")
	@PutMapping(value="/update")
	public BaseResult updateOauthSysModules(@RequestBody OauthSysModules oauthSysModules){
		int i = 0;
		if(null != oauthSysModules){
			i=oauthSysModulesService.updateOauthSysModules(oauthSysModules);
		}
		if(i>0){
			return outAudStr(true);
		}else{
			return outAudStr(false);
		}
	}

	/**
	* 删除
	* @param id
	*/
	@ApiOperation(value="删除子系统模块", notes="删除子系统模块")
	@DeleteMapping(value="/delete")
	public BaseResult delOauthSysModules(String id){
		int i = 0;
		if(!StringUtil.isEmpty(id)){
			Map<String, Object> condition = new HashMap<String, Object>();
			condition.put("id",id.split(","));
			i=oauthSysModulesService.delOauthSysModules(condition);
		}
		if(i>0){
			return outAudStr(true);
		}else{
			return outAudStr(false);
		}
	}
}
