instruction: |-
  This application is a Python web service built using the NiceGUI framework. It serves
  media files (such as videos, audio, and large documents) through a streaming endpoint
  at `/media`.

  When requesting files from the media endpoint, it is possible to access files outside
  the intended media directory by including special path sequences in the URL. For example,
  requests containing URL-encoded parent directory references (like `%2e%2e` which decodes
  to `..`) can reach files anywhere on the filesystem that the application has permission
  to read.

  Attempting to access `/media/%2e%2e/%2e%2e/%2e%2e/etc/hosts` returns the actual contents
  of `/etc/hosts` instead of returning a 404 error. This affects any file the application
  process can read.

  We expect the media endpoint to only serve files that are actually located within the
  designated media directory. Requests attempting to access files outside this directory
  should receive a 404 "Not Found" response, regardless of whether the target file exists.

difficulty: medium
category: security
tags:
  - python
  - nicegui
  - file-serving
  - path-validation
parser_name: pytest

run_tests_in_same_shell: false
