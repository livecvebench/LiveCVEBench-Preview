# CVE-2025-24806
instruction: |-
  Pomerium is an identity- and context-aware access proxy, and its databroker service manages persistent application state via a gRPC API.
  
  I deployed Pomerium and use service account access tokens from Pomerium Zero/Enterprise to authorize requests to the databroker API with JWTs, and the databroker endpoint is reachable within our network.
  
  In testing, some service account tokens are accepted by the databroker API when they should not be, enabling reads of user info, spoofing of sessions, and changes to routes and policies. This occurs with tokens that have a future expiration and when the databroker API is not additionally gated by network controls.
  
  Please fix the issue so the databroker API does not accept service account tokens that should not grant access, and ensure unauthorized reads and configuration changes are blocked.
author_name: Jinyang Huang
author_email: hjyTsuki@gmail.com
difficulty: hard
category: software-engineering
tags:
  - CWExxx
parser_name: pytest
max_agent_timeout_sec: 1000.0
max_test_timeout_sec: 300.0
run_tests_in_same_shell: true
disable_asciinema: false
