instruction: |-
  This is the CUPS (Common Unix Printing System) print server application. CUPS
  provides a portable printing layer for Unix-like operating systems.

  When the CUPS daemon parses certain IPv6 addresses in access control rules
  within cupsd.conf, it crashes unexpectedly. Specifically, when an IPv6 address
  contains an unusually large number of colon separators (such as
  "[::2:3:6:9:c:::::::::::::4:::::::::::::::::::::3]"), the daemon terminates
  with a segmentation fault during startup.

  The issue appears to be in the address parsing logic in scheduler/conf.c. When
  processing the "::" shorthand notation in IPv6 addresses, the code counts the
  remaining colons to calculate array positions. With an excessive number of
  colons, this calculation produces incorrect results, leading to memory
  corruption.

  Normal IPv6 addresses like "[::1]" or "[2001:db8::1]" work correctly. The crash
  only occurs with malformed addresses containing many consecutive colons.

  We expect the daemon to handle malformed IPv6 addresses gracefully without
  crashing - either by rejecting the invalid configuration with an error message
  or by safely ignoring the malformed entry.

difficulty: medium
category: bug-fix
tags:
  - c
  - cups
  - parsing
  - ipv6
  - memory-safety

parser_name: pytest
run_tests_in_same_shell: false
