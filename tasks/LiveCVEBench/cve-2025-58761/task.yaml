instruction: |-
  This application is Tautulli, a web-based monitoring and statistics application
  for Plex Media Server. It provides a dashboard for tracking user activity, viewing
  playback history, and serving various media assets.

  The `/pms_image_proxy` endpoint is used to serve images from the local data
  directory. When users request images that start with `interfaces/default/images`,
  the application serves these files from the `data/interfaces/default/images`
  directory.

  However, we've discovered that this endpoint returns files from unexpected
  locations on the filesystem. For example, when requesting a path like
  `interfaces/default/images/../../../somefile.txt`, the application serves
  the file instead of rejecting the request. This results in users being able to
  access files outside the intended images directory (such as configuration files
  or database files), which should not be accessible through this endpoint.

  Expected behavior: The endpoint should only serve files that are actually located
  within the `data/interfaces/default/images` directory. Requests attempting to
  traverse outside this directory (using `../` sequences) should be blocked and
  return an empty response.

  Note: The `/pms_image_proxy` endpoint is accessible without authentication, so
  this fix is important for protecting application data.

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: security
tags:
  - path-traversal
  - web-security
  - python
  - cherrypy
parser_name: pytest

run_tests_in_same_shell: false
