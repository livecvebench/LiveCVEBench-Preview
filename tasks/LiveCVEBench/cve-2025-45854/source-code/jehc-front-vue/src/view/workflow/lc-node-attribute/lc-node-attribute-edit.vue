<template>
    <!-- 
    <b-modal ref="my-modal" hide-footer title="Using Component Methods">
     <div class="d-block text-center">
       <h3>Hello From My Modal!</h3>
     </div>
     <b-button class="mt-3" variant="outline-danger" block @click="hideModal">Close Me</b-button>
     <b-button class="mt-2" variant="outline-warning" block @click="toggleModal">Toggle Me</b-button>
   </b-modal> 
    -->
    <!--
        body-class="modalStyle" 表示样式
        size="lg" 表示模态窗口大小 xl,lg,sm,full
        hide-footer 表示隐藏底部按钮
        hide-header 表示隐藏头部内容
        no-close-on-backdrop 表示鼠标点击背景不可关闭
        hide-header-close 表示隐藏头部关闭按钮
        centered 居中
        ok-title=“确定” 
        cancel-title=取消
        @ok="handleOk" 
        @cancel="handleCancel"
        scrollable 滚动条
        hide-backdrop 隐藏背景
        wrapClassName="ant-modal-cust-warp" 
        style="top:5%;height: 85%;overflow-y: hidden" 样式
    -->
    <b-modal ref="my-modal" :title="title" content-class="fullWinBody" @hidden="onHidden" size="fullWin" id="tableLcNodeAttributeEditBody" scrollable
        no-close-on-backdrop>
        <div class="d-block text-center">
            <b-card no-body>
                <b-tabs pills card vertical>
                    <b-tab title="基本属性" active>
                        <b-card-text>           
                            <div class="m-form m-form--fit m-form--label-align-left m-form--group-seperator-dashed">                                
                                <div class="m-portlet__body">
                                    <div class="form-group m-form__group row">
                                        <div class="alert m-alert m-alert--default" role="alert">
                                            说明：该模块仅为对节点的额外必要属性进行扩展<code> 使得节点更灵活</code> .
                                        </div>
                                    </div>
                                    <div class="form-group m-form__group row">
                                        <label class="col-md-1 col-form-label">节&nbsp;&nbsp;点&nbsp;键</label>
                                        <div class="col-md-3">
                                            <input class="form-control" type="text" maxlength="255" 
                                                v-model="lcNodeAttrform.attributeKey" placeholder="请输入">
                                        </div>
                                        <div class="col-md-4">
                                            <b-badge class="mr-1" variant="success">注意：自定义编码，可用于流程流转到该节点时候，用于做业务常量使用</b-badge>                            
                                        </div>
                                    </div>
                                    <div class="form-group m-form__group row">
                                        <label class="col-md-1 col-form-label">节点编号</label>
                                        <div class="col-md-5">
                                            <input class="form-control"
                                                type="text" readonly
                                                v-model="lcNodeAttrform.nodeId" placeholder="请输入">
                                        </div>
                                        <div class="col-md-2">
                                            <b-badge class="mr-1" variant="info">*注意：节点编号为bpm节点id不可修改</b-badge> 
                                        </div>
                                    </div>
                                    <div class="form-group m-form__group row">
                                        <label
                                            class="col-md-1 col-form-label">序&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;号</label>
                                        <div class="col-md-2">
                                            <input class="form-control" type="number" style="width: 100px"
                                                data-bv-numeric="" data-bv-numeric-message="必须为整数" maxlength="4"
                                                v-model="lcNodeAttrform.orderNumber" data-bv-field="orderNumber"
                                                placeholder="请输入">
                                        </div>
                                    </div>

                                    <div class="form-group m-form__group row">
                                        <label
                                            class="col-md-1 col-form-label">备&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;注</label>
                                        <div class="col-md-5">
                                            <textarea class="form-control" rows="8"
                                                maxlength="800"
                                                v-model="lcNodeAttrform.remark" placeholder="请输入"></textarea>
                                        </div>
                                    </div>
                                    <div class="form-group m-form__group row">
                                        <label
                                            class="col-md-1 col-form-label">通&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;知</label>
                                        <div class="col-md-2">
                                            <el-select v-model="lcNodeAttrform.noticeTypes" multiple placeholder="请选择">
                                                <el-option
                                                v-for="(item ,index) in noticeTypes"
                                                :key="index"
                                                :label="item.value"
                                                :value="item.key">
                                                </el-option>
                                            </el-select>
                                        </div>
                                    </div>
                                    <div class="form-group m-form__group row">
                                        <label class="col-md-1 col-form-label">通知模板</label>
                                        <div class="col-md-2">
                                            <el-select v-model="lcNodeAttrform.notifyTemplateIdTemp" multiple placeholder="请选择">
                                                <el-option
                                                v-for="item in notifyTemplateList"
                                                :key="item.id"
                                                :label="item.title"
                                                :value="item.id">
                                                </el-option>
                                            </el-select>
                                        </div>
                                        <div class="col-md-1">
                                            <b-badge class="mr-1" variant="danger">*注意：通知类型中包含其对应的数据才会生效，否则无效！</b-badge> 
                                        </div>
                                    </div>
                                    <div class="form-group m-form__group row">
                                        <label class="col-md-1 col-form-label">发&nbsp;起&nbsp;&nbsp;人</label>
                                        <div class="col-md-2">
                                            <el-select maxlength="2" v-model="lcNodeAttrform.initiator"
                                                placeholder="请选择">
                                                <el-option value="">请选择</el-option>
                                                <el-option
                                                    v-for="item in [{value:'10',label:'否'},{value:'20',label:'是'}]"
                                                    :key="item.value"
                                                    :label="item.label"
                                                    :value="item.value">
                                                </el-option>
                                            </el-select>
                                        </div>
                                        <div class="col-md-1">  
                                            <b-badge class="mr-1" variant="warning">*注意：可用于流程流转到该节点时候判断到底是不是表单发起人，用于做业务判断</b-badge>                                           
                                        </div>
                                    </div>
                                    <div class="form-group m-form__group row">
                                        <label class="col-md-1 col-form-label">紧急程度</label>
                                        <div class="col-md-2">                                            
                                            <el-select maxlength="2" v-model="lcNodeAttrform.urgent"
                                                placeholder="请选择">
                                                <el-option value="">请选择</el-option>
                                                <el-option
                                                    v-for="item in [{value:'0',label:'一般'},{value:'1',label:'较急'},{value:'2',label:'加急'}]"
                                                    :key="item.value"
                                                    :label="item.label"
                                                    :value="item.value">
                                                </el-option>
                                            </el-select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </b-card-text>
                    </b-tab>
                    <b-tab title="表单">
                        <template #title>                            
                            表&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;单
                        </template>
                        <b-card-text>
                            <div class="m-form m-form--fit m-form--label-align-left m-form--group-seperator-dashed">                                
                                <div class="m-portlet__body">
                                    <div class="form-group m-form__group row">
                                        <div class="alert m-alert m-alert--default" role="alert">
                                            说明：围绕节点表单跳转使用 <code>如电脑端，移动端</code> .
                                        </div>
                                    </div>
                                    <div class="form-group m-form__group row">
                                        <label class="col-md-2 col-form-label">pc端地址</label>
                                        <div class="col-md-4">
                                            <input class="form-control" type="text" maxlength="255" v-model="lcNodeAttrform.pcFormUri" placeholder="请输入">
                                        </div>
                                    </div>
                                    <div class="form-group m-form__group row">
                                        <label class="col-md-2 col-form-label">移动端地址</label>
                                        <div class="col-md-4">
                                            <input class="form-control" type="text" maxlength="255" v-model="lcNodeAttrform.mobileFormUri" placeholder="请输入">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </b-card-text>
                    </b-tab>
                    <b-tab title="字段权限">
                        <b-card-text>
                            <div class="m-form m-form--fit m-form--label-align-left m-form--group-seperator-dashed">
                                <div class="form-group m-form__group row">
                                    <div class="alert m-alert m-alert--default" role="alert">
                                        说明：节点中展示不同的字段，<code>可写，可读，隐藏，必填</code>等，方便前端逻辑处理 <code>灵活配置</code> .
                                    </div>
                                </div>
                                <div class="form-group m-form__group row">
                                    <div class="m-portlet__head-caption">
                                        <button type="button" class="btn btn-light-primary mr-3 m-btn m-btn--custom m-btn--icon"
                                            @click="initFormFieldWin" title='新一行'><i class="la la-plus"></i>新一行</button>
                                    </div>
                                </div>
                                <div class="form-group m-form__group row">
                                    <div class="col-md-11">
                                        <el-table 
                                            :data="lcNodeAttrform.nodeFormField"
                                            stripe 
                                            border
                                            style="width: 100%">
                                            <el-table-column
                                                prop="fieldName"
                                                label="字段名">
                                                <template slot-scope="scope">
                                                <el-input v-model="scope.row.fieldName"></el-input>
                                                </template>
                                            </el-table-column>
                                            <el-table-column
                                                prop="fieldLabel"
                                                label="标签">
                                                <template slot-scope="scope">
                                                    <el-input v-model="scope.row.fieldLabel"></el-input>
                                                </template>
                                            </el-table-column>                                        
                                            <el-table-column
                                                prop="filedRequired"
                                                label="必填">
                                                <template slot-scope="scope">                                                    
                                                    <!-- <select class="form-control" v-model="scope.row.filedRequired" placeholder="请选择">
                                                        <option value="">
                                                            请选择
                                                        </option>
                                                        <option value="0">
                                                            是
                                                        </option>
                                                        <option value="1">
                                                            否
                                                        </option>
                                                    </select> -->
                                                    <el-select v-model="scope.row.filedRequired" placeholder="请选择">
                                                        <el-option
                                                        v-for="item in [{value:0,label:'是'},{value:1,label:'否'}]"
                                                        :key="item.value"
                                                        :label="item.label"
                                                        :value="item.value">
                                                        </el-option>
                                                    </el-select>
                                                </template>
                                            </el-table-column>
                                            <el-table-column
                                                prop="fieldRead"
                                                label="可读">
                                                <template slot-scope="scope">
                                                    <!-- <select class="form-control" v-model="scope.row.fieldRead" placeholder="请选择">
                                                        <option value="">
                                                            请选择
                                                        </option>
                                                        <option value="0">
                                                            是
                                                        </option>
                                                        <option value="1">
                                                            否
                                                        </option>
                                                    </select> -->
                                                    <el-select v-model="scope.row.fieldRead" placeholder="请选择">
                                                        <el-option
                                                        v-for="item in [{value:0,label:'是'},{value:1,label:'否'}]"
                                                        :key="item.value"
                                                        :label="item.label"
                                                        :value="item.value">
                                                        </el-option>
                                                    </el-select>
                                                </template>
                                            </el-table-column>
                                            <el-table-column
                                                prop="fieldWrite"
                                                label="可写">
                                                <template slot-scope="scope">
                                                    <el-select v-model="scope.row.fieldWrite" placeholder="请选择">
                                                        <el-option
                                                        v-for="item in [{value:0,label:'是'},{value:1,label:'否'}]"
                                                        :key="item.value"
                                                        :label="item.label"
                                                        :value="item.value">
                                                        </el-option>
                                                    </el-select>                                                    
                                                </template>
                                            </el-table-column>
                                            <el-table-column
                                                prop="filedHide"
                                                label="隐藏">
                                                <template slot-scope="scope">
                                                    <el-select v-model="scope.row.filedHide" placeholder="请选择">
                                                        <el-option
                                                        v-for="item in [{value:0,label:'是'},{value:1,label:'否'}]"
                                                        :key="item.value"
                                                        :label="item.label"
                                                        :value="item.value">
                                                        </el-option>
                                                    </el-select>
                                                </template>
                                            </el-table-column>                                
                                            <el-table-column label="操作">   
                                                <template slot-scope="scope">
                                                    <a href="javascript:;" @click="handleDeleteNodeFormField(scope.$index, scope.row)" class="btn btn-sm btn-clean btn-icon" title="移除">	                            
                                                        <span class="svg-icon svg-icon-primary svg-icon-2x">	                                
                                                            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">	                                    
                                                                <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">	                                       
                                                                    <rect x="0" y="0" width="24" height="24"></rect>	                                        
                                                                    <path d="M6,8 L6,20.5 C6,21.3284271 6.67157288,22 7.5,22 L16.5,22 C17.3284271,22 18,21.3284271 18,20.5 L18,8 L6,8 Z" 
                                                                    fill="#000000" fill-rule="nonzero"></path>	                                        
                                                                    <path d="M14,4.5 L14,4 C14,3.44771525 13.5522847,3 13,3 L11,3 C10.4477153,3 10,3.44771525 10,
                                                                        4 L10,4.5 L5.5,4.5 C5.22385763,4.5 5,4.72385763 5,5 L5,5.5 C5,5.77614237 5.22385763,6 5.5,6 L18.5,
                                                                        6 C18.7761424,6 19,5.77614237 19,5.5 L19,5 C19,4.72385763 18.7761424,4.5 18.5,4.5 L14,4.5 Z" fill="#000000" opacity="0.3">
                                                                    </path>	                                    
                                                                </g>	                                
                                                            </svg>	                        
                                                        </span>							
                                                    </a>                                   
                                                </template>                
                                            </el-table-column>            
                                        </el-table>
                                    </div>
                                </div>
                                <!-- <div class="form-group m-form__group row" style='background: #f2f3f5;'>
                                    <div class="col-md-2">标签</div>
                                    <div class="col-md-2">必填</div>
                                    <div class="col-md-2">可读</div>
                                    <div class="col-md-2">可写</div>
                                    <div class="col-md-2">隐藏</div>
                                    <div class="col-md-2"></div>
                                </div> -->
                                <div class="m-portlet__body" id='nodeFormField'>

                                </div>
                            </div>
                        </b-card-text>
                    </b-tab>
                    <b-tab title="办理人">
                        <template #title>                            
                            办&nbsp;&nbsp;理&nbsp;&nbsp;人
                        </template>
                        <b-card-text>
                            <div class="m-form m-form--fit m-form--label-align-left m-form--group-seperator-dashed">
                                <div class="form-group m-form__group row">    
                                    <div class="alert m-alert m-alert--default" role="alert">
                                    说明：该模块办理人优先级低于流程设计器中办理人<code>此次为办理人，扩展属性</code> .
                                    </div>
                                </div>                                
                                <div class="m-portlet__body">
                                    <b-card no-body>
                                        <!--  <b-tabs pills card vertical end> 表示选卡向右显示 -->
                                        <b-tabs pills card>
                                        <b-tab title="指定人" active>
                                            <template #title>
                                                <!-- <i class="fa flaticon-avatar"></i> --> 经办人
                                            </template>
                                            <b-card-text>
                                                <div class="form-group m-form__group row">    
                                                    <div class="col-md-1">
                                                        <label class="col-form-label">类&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;型</label>
                                                    </div>
                                                    <div class="col-md-2">
                                                        <el-select clearable v-model="lcNodeAttrform.lcNodeCandidate[0].assigneeType" placeholder="请选择">                                                            
                                                            <el-option
                                                            v-for="item in assigneeTypeList"
                                                            :key="item.value"
                                                            :label="item.label"
                                                            :value="item.value">
                                                            </el-option>
                                                        </el-select>
                                                    </div>
                                                </div>
                                                <div class="form-group m-form__group row">    
                                                    <div class="col-md-1">
                                                        <label class="col-form-label">经&nbsp;&nbsp;办&nbsp;人</label>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <div class="input-group">
                                                            <input type="text" readonly class="form-control m-input" 
                                                                v-model="lcNodeAttrform.lcNodeCandidate[0].assigneeText"
                                                                placeholder="请选择" aria-describedby="basic-addon2">
                                                            <div class="input-group-append">
                                                                <button type="button" class="btn btn-secondary"
                                                                    id="basic-addon2" @click="resetAssignee()">
                                                                    <i class="fa fa-times"></i>
                                                                </button>
                                                            </div>
                                                            <div class="input-group-append">
                                                                <button type="button" class="btn btn-primary"
                                                                    @click='initAssignee()'>
                                                                    <i class="flaticon-user-ok"></i>
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="form-group m-form__group row">    
                                                    <div class="col-md-1">
                                                        <label
                                                            class="col-form-label">备&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;注</label>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <textarea v-model="lcNodeAttrform.lcNodeCandidate[0].remark" rows="10"  class="form-control"></textarea>
                                                    </div>
                                                </div>
                                            </b-card-text>
                                        </b-tab>
                                        <b-tab title="候选人">
                                            <template #title>
                                                <!-- <i class="fa flaticon-users"></i> --> 候选人
                                            </template>
                                            <b-card-text>
                                                <div class="form-group m-form__group row">    
                                                    <div class="col-md-1">
                                                        <button type="button" class="btn btn-secondary"
                                                            @click='initCandidate()'>
                                                            <i class="flaticon-user-ok"></i>添加候选人
                                                        </button>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <el-table 
                                                            :data="candidateList"
                                                            stripe 
                                                            border       
                                                            max-height="250"                                                                
                                                            :show-header ="true"
                                                            style="width: 100%">
                                                            <el-table-column
                                                                prop="name" 
                                                                show-overflow-tooltip                                                                    
                                                                label="候选人">
                                                            </el-table-column>     
                                                            <el-table-column label="操作" fix="fixed" min-width = "40">   
                                                                <template slot-scope="scope">
                                                                    <a href="javascript:;" @click="delCandidate(scope.$index,scope.row)" class="btn btn-sm btn-clean btn-icon" title="移除">	                            
                                                                        <span class="svg-icon svg-icon-danger svg-icon-2x">	                                
                                                                            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">	                                    
                                                                                <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">	                                       
                                                                                    <rect x="0" y="0" width="24" height="24"></rect>	                                        
                                                                                    <path d="M6,8 L6,20.5 C6,21.3284271 6.67157288,22 7.5,22 L16.5,22 C17.3284271,22 18,21.3284271 18,20.5 L18,8 L6,8 Z" 
                                                                                    fill="#000000" fill-rule="nonzero"></path>	                                        
                                                                                    <path d="M14,4.5 L14,4 C14,3.44771525 13.5522847,3 13,3 L11,3 C10.4477153,3 10,3.44771525 10,
                                                                                        4 L10,4.5 L5.5,4.5 C5.22385763,4.5 5,4.72385763 5,5 L5,5.5 C5,5.77614237 5.22385763,6 5.5,6 L18.5,
                                                                                        6 C18.7761424,6 19,5.77614237 19,5.5 L19,5 C19,4.72385763 18.7761424,4.5 18.5,4.5 L14,4.5 Z" fill="#000000" opacity="0.3">
                                                                                    </path>	                                    
                                                                                </g>	                                
                                                                            </svg>	                        
                                                                        </span>							
                                                                    </a>                                   
                                                                </template>                
                                                            </el-table-column>  
                                                        </el-table>
                                                    </div>
                                                </div>
                                                <div class="form-group m-form__group row">    
                                                    <div class="col-md-1">
                                                        <label class="col-form-label">
                                                            备&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;注
                                                        </label>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <textarea v-model="lcNodeAttrform.lcNodeCandidate[0].remark1" rows="10" class="form-control"></textarea>
                                                    </div>
                                                </div>
                                            </b-card-text>
                                        </b-tab>
                                        <b-tab title="指定组">
                                            <template #title>
                                                <!-- <i class="fa flaticon-users-1"></i> --> 组
                                            </template>
                                            <b-card-text>
                                                <div class="form-group m-form__group row">    
                                                    <div class="col-md-1">
                                                        <label
                                                            class="col-form-label">类&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;型</label>
                                                    </div>
                                                    <div class="col-md-2">
                                                        <el-select v-model="lcNodeAttrform.lcNodeCandidate[0].candidateGroupType" placeholder="请选择">
                                                            <el-option
                                                            v-for="item in [{value:'',label:'请选择'},{value:'0',label:'部门'},{value:'1',label:'岗位'},{value:'2',label:'角色'}]"
                                                            :key="item.value"
                                                            :label="item.label"
                                                            :value="item.value">
                                                            </el-option>
                                                        </el-select>
                                                    </div>
                                                </div>
                                                <div class="form-group m-form__group row">    
                                                    <div class="col-md-1">
                                                        <button type="button" class="btn btn-secondary"
                                                            @click='initCandidateGroups()'>
                                                            <span><i class="flaticon-user-ok"></i><span>添加候选组</span></span>
                                                        </button>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <el-table 
                                                            :data="candidateGroupsList"
                                                            stripe 
                                                            border       
                                                            max-height="250"                                                                
                                                            :show-header ="true"
                                                            style="width: 100%">
                                                            <el-table-column
                                                                prop="name" 
                                                                show-overflow-tooltip                                                                    
                                                                label="候选组">
                                                            </el-table-column>     
                                                            <el-table-column label="操作" fix="fixed" min-width = "40">   
                                                                <template slot-scope="scope">
                                                                    <a href="javascript:;" @click="delCandidateGroups(scope.$index,scope.row)" class="btn btn-sm btn-clean btn-icon" title="移除">	                            
                                                                        <span class="svg-icon svg-icon-danger svg-icon-2x">	                                
                                                                            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">	                                    
                                                                                <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">	                                       
                                                                                    <rect x="0" y="0" width="24" height="24"></rect>	                                        
                                                                                    <path d="M6,8 L6,20.5 C6,21.3284271 6.67157288,22 7.5,22 L16.5,22 C17.3284271,22 18,21.3284271 18,20.5 L18,8 L6,8 Z" 
                                                                                    fill="#000000" fill-rule="nonzero"></path>	                                        
                                                                                    <path d="M14,4.5 L14,4 C14,3.44771525 13.5522847,3 13,3 L11,3 C10.4477153,3 10,3.44771525 10,
                                                                                        4 L10,4.5 L5.5,4.5 C5.22385763,4.5 5,4.72385763 5,5 L5,5.5 C5,5.77614237 5.22385763,6 5.5,6 L18.5,
                                                                                        6 C18.7761424,6 19,5.77614237 19,5.5 L19,5 C19,4.72385763 18.7761424,4.5 18.5,4.5 L14,4.5 Z" fill="#000000" opacity="0.3">
                                                                                    </path>	                                    
                                                                                </g>	                                
                                                                            </svg>	                        
                                                                        </span>							
                                                                    </a>                                   
                                                                </template>                
                                                            </el-table-column>  
                                                        </el-table>
                                                    </div>
                                                </div>
                                                <div class="form-group m-form__group row">    
                                                    <div class="col-md-1">
                                                        <label class="col-form-label">备&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;注</label>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <textarea v-model="lcNodeAttrform.lcNodeCandidate[0].remark2" rows="10" class="form-control"></textarea>
                                                    </div>
                                                </div>
                                            </b-card-text>
                                        </b-tab>
                                        </b-tabs>
                                    </b-card>
                                </div>
                            </div>
                        </b-card-text>
                    </b-tab>
                    <b-tab title="跳转规则">
                        <b-card-text>
                            <div class="m-form m-form--fit m-form--label-align-left m-form--group-seperator-dashed">
                                <div class="form-group m-form__group row">
                                    <div class="alert m-alert m-alert--default" role="alert">
                                        说明：该模块可增强节点的灵活跳转，通过前端页面到达该节点办理任务可以特定的跳转任意节点 <code>达到灵活配置</code> .
                                    </div>
                                </div>                                     
                                <div class="form-group m-form__group row">
                                    <button type="button" class="btn btn-light-primary mr-3 m-btn m-btn--custom m-btn--icon"
                                        @click="showTargetNodeWin" title='选择目标节点'><i class="la la-plus"></i>请选择</button>   
                                </div>                           
                                <div class="m-form m-form--fit m-form--label-align-left m-form--group-seperator-dashed">
                                    <div class="m-portlet__body">
                                        <div class="col-md-11">
                                            <el-table 
                                                :data="lcNodeAttrform.lcJumpRules"
                                                stripe 
                                                border
                                                style="width: 100%">
                                                <el-table-column
                                                    prop="nodeName"
                                                    show-overflow-tooltip 
                                                    label="目标节点" min-width="60">
                                                </el-table-column>
                                                <el-table-column
                                                    prop="targetNodeId"
                                                    show-overflow-tooltip 
                                                    label="目标节点编号" min-width="100">
                                                    <!-- <template slot-scope="scope">
                                                        <el-input readOnly v-model="scope.row.targetNodeId"></el-input>
                                                    </template> -->
                                                </el-table-column> 
                                                <el-table-column
                                                    prop="basedOnCondition"
                                                    min-width="50"
                                                    label="基于条件">
                                                    <template slot-scope="scope">
                                                        <el-select v-model="scope.row.basedOnCondition" placeholder="请选择">
                                                            <el-option
                                                            v-for="item in [{value:0,label:'是'},{value:1,label:'否'}]"
                                                            :key="item.value"
                                                            :label="item.label"
                                                            :value="item.value">
                                                            </el-option>
                                                        </el-select>
                                                        <!-- <select class="form-control" v-model="scope.row.basedOnCondition" placeholder="请选择">
                                                            <option value="0">
                                                                否
                                                            </option>
                                                            <option value="1">
                                                                是
                                                            </option>
                                                        </select> -->
                                                    </template>
                                                </el-table-column> 
                                                <el-table-column
                                                    prop="conditions_"
                                                    label="条件语句">
                                                    <template slot-scope="scope">
                                                        <el-input type="textarea" v-if="scope.row.basedOnCondition ==0" v-model="scope.row.conditions_"></el-input>
                                                    </template>
                                                </el-table-column>          
                                                <el-table-column label="操作" min-width="50">   
                                                    <template slot-scope="scope">
                                                        <!-- <el-button 
                                                            size="mini" 
                                                            type="success" 
                                                            icon="el-icon-save" 
                                                            @click="handleSaveNodeFormField(scope.$index, scope.row)">保存
                                                        </el-button> -->
                                                        <a href="javascript:;" @click="handleDeleteJumpRules(scope.$index, scope.row)" class="btn btn-sm btn-clean btn-icon" title="移除">	                            
                                                            <span class="svg-icon svg-icon-primary svg-icon-2x">	                                
                                                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">	                                    
                                                                    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">	                                       
                                                                        <rect x="0" y="0" width="24" height="24"></rect>	                                        
                                                                        <path d="M6,8 L6,20.5 C6,21.3284271 6.67157288,22 7.5,22 L16.5,22 C17.3284271,22 18,21.3284271 18,20.5 L18,8 L6,8 Z" 
                                                                        fill="#000000" fill-rule="nonzero"></path>	                                        
                                                                        <path d="M14,4.5 L14,4 C14,3.44771525 13.5522847,3 13,3 L11,3 C10.4477153,3 10,3.44771525 10,
                                                                            4 L10,4.5 L5.5,4.5 C5.22385763,4.5 5,4.72385763 5,5 L5,5.5 C5,5.77614237 5.22385763,6 5.5,6 L18.5,
                                                                            6 C18.7761424,6 19,5.77614237 19,5.5 L19,5 C19,4.72385763 18.7761424,4.5 18.5,4.5 L14,4.5 Z" fill="#000000" opacity="0.3">
                                                                        </path>	                                    
                                                                    </g>	                                
                                                                </svg>	                        
                                                            </span>							
                                                        </a>                                   
                                                    </template>                
                                                </el-table-column>            
                                            </el-table>
                                        </div>                                        
                                    </div>
                                </div>
                            </div>
                        </b-card-text>
                    </b-tab>
                    <b-tab title="按钮">
                        <template #title>                            
                            按&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;钮
                        </template>
                        <b-card-text>
                            <div class="m-form m-form--fit m-form--label-align-left m-form--group-seperator-dashed">                                
                                <div class="m-portlet">
                                    <div class="m-form m-form--fit m-form--label-align-left m-form--group-seperator-dashed">
                                        <div class="m-portlet__body">
                                            <div class="form-group m-form__group row">
                                                <div class="alert m-alert m-alert--default" role="alert">
                                                    说明：该模块配置显示的按钮，如驳回，同意，跳转等等 <code>达到灵活配置</code> .
                                                </div>
                                            </div>
                                            <div class="form-group m-form__group row">
                                                <button type="button" class="btn btn-light-primary mr-3 m-btn m-btn--custom m-btn--icon"
                                                    @click="showBtnWin" title='按钮选择器'><i class="la la-plus"></i>请选择</button>
                                            </div>                                            
                                            <div class="form-group m-form__group row">
                                                <div class="col-md-11">
                                                    <el-table 
                                                        :data="lcNodeAttrform.lcNodeBtns"
                                                        stripe 
                                                        border
                                                        style="width: 100%">
                                                        <el-table-column
                                                            prop="btnId"
                                                            min-width = "80"
                                                            fixed="left"
                                                            label="按钮项">
                                                            <template slot-scope="scope">
                                                                <el-dropdown size="small" split-button type="primary" plain>
                                                                    {{scope.row.label_}}
                                                                    <el-dropdown-menu slot="dropdown">
                                                                        <el-dropdown-item @click.native="handleDeleteBtn(scope.$index, scope.row)">移除</el-dropdown-item>
                                                                        <el-dropdown-item @click.native="showBtnTargetNode(scope.$index, scope.row)">关联节点</el-dropdown-item>
                                                                    </el-dropdown-menu>
                                                                </el-dropdown>
                                                            </template>
                                                        </el-table-column>
                                                        <el-table-column
                                                            prop="btnAction"
                                                            label="扩展动作">
                                                            <template slot-scope="scope">
                                                                <el-input v-model="scope.row.btnAction"></el-input>
                                                            </template>
                                                        </el-table-column>  
                                                        <el-table-column
                                                            prop="btnLabel"
                                                            min-width = "80"
                                                            label="扩展按钮名称">
                                                            <template slot-scope="scope">
                                                                <el-input v-model="scope.row.btnLabel"></el-input>
                                                            </template>
                                                        </el-table-column>                                                  
                                                        <el-table-column
                                                            min-width = "300"
                                                            label="关联节点">
                                                            <template slot-scope="scope">
                                                                <!-- {{JSON.stringify(scope.row.lcJumpRules)}} -->
                                                                <el-table 
                                                                    :data="scope.row.lcJumpRules"
                                                                    stripe 
                                                                    border    
                                                                    :header-cell-style="{background:'#F2F6FC'}"                                                                   
                                                                    :show-header ="true"
                                                                    style="width: 100%">
                                                                    <el-table-column
                                                                        prop="nodeName" 
                                                                        show-overflow-tooltip                                                                    
                                                                        label="节点名称">
                                                                    </el-table-column>                                                                    
                                                                    <el-table-column  
                                                                        prop="targetNodeId"
                                                                        show-overflow-tooltip 
                                                                        label="节点编号">
                                                                        <template slot-scope="scope">
                                                                            <div v-if="scope.row.targetNodeId == lcNodeAttrform.nodeId">
                                                                                <b-badge class="mr-1" variant="danger">{{scope.row.targetNodeId}}</b-badge>
                                                                            </div>
                                                                            <div v-else>
                                                                                {{scope.row.targetNodeId}}
                                                                            </div>
                                                                        </template>
                                                                    </el-table-column>   
                                                                    <el-table-column
                                                                        prop="conditions_"
                                                                        label="条件">
                                                                        <template slot-scope="scope1">
                                                                            <el-input type="textarea" rows="4" v-model="scope1.row.conditions_"></el-input>
                                                                        </template>
                                                                    </el-table-column>   
                                                                    <el-table-column label="操作"  min-width = "40">   
                                                                        <template slot-scope="scope1">
                                                                            <a href="javascript:;" @click="handleBtnTargetNode(scope.$index,scope1.$index, scope1.row)" class="btn btn-sm btn-clean btn-icon" title="移除">	                            
                                                                                <span class="svg-icon svg-icon-primary svg-icon-2x">	                                
                                                                                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">	                                    
                                                                                        <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">	                                       
                                                                                            <rect x="0" y="0" width="24" height="24"></rect>	                                        
                                                                                            <path d="M6,8 L6,20.5 C6,21.3284271 6.67157288,22 7.5,22 L16.5,22 C17.3284271,22 18,21.3284271 18,20.5 L18,8 L6,8 Z" 
                                                                                            fill="#000000" fill-rule="nonzero"></path>	                                        
                                                                                            <path d="M14,4.5 L14,4 C14,3.44771525 13.5522847,3 13,3 L11,3 C10.4477153,3 10,3.44771525 10,
                                                                                                4 L10,4.5 L5.5,4.5 C5.22385763,4.5 5,4.72385763 5,5 L5,5.5 C5,5.77614237 5.22385763,6 5.5,6 L18.5,
                                                                                                6 C18.7761424,6 19,5.77614237 19,5.5 L19,5 C19,4.72385763 18.7761424,4.5 18.5,4.5 L14,4.5 Z" fill="#000000" opacity="0.3">
                                                                                            </path>	                                    
                                                                                        </g>	                                
                                                                                    </svg>	                        
                                                                                </span>							
                                                                            </a>                                   
                                                                        </template>                
                                                                    </el-table-column>  
                                                                </el-table>
                                                            </template>
                                                        </el-table-column>        
                                                    </el-table>
                                                </div>
                                            </div>   
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </b-card-text>
                    </b-tab>
                    <b-tab title="高级">
                        <template #title>                            
                            高&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;级
                        </template>
                        <b-card-text>
                            <div class="m-form m-form--fit m-form--label-align-left m-form--group-seperator-dashed">
                                <div class="m-portlet__body">
                                    <div class="form-group m-form__group row">
                                        <div class="alert m-alert m-alert--default" role="alert">
                                            备注：高级属性配置，使得业务更加灵活调用 <code>设置更多节点上生效属性 用于增强业务场景</code> .
                                        </div>
                                    </div>
                                    <div class="form-group m-form__group row">
                                        <label class="col-md-3 col-form-label">该节点上审批时是否必须提交意见</label>
                                        <div class="col-md-2">
                                            <el-select maxlength="2" v-model="lcNodeAttrform.opinion"
                                                placeholder="请选择">
                                                <el-option value="">请选择</el-option>
                                                <el-option
                                                    v-for="item in [{value:'10',label:'否'},{value:'20',label:'是'}]"
                                                    :key="item.value"
                                                    :label="item.label"
                                                    :value="item.value">
                                                </el-option>
                                            </el-select>
                                        </div>
                                        <div class="col-md-2">
                                            <b-badge class="mr-4" variant="info">注意：表示流程流转到该节点是否需要提交意见内容，前端拿到参数可以判断</b-badge>
                                        </div>
                                    </div>
                                    <div class="form-group m-form__group row">
                                        <label class="col-md-3 col-form-label">当前节点允许被撤回</label>
                                        <div class="col-md-2">
                                            <el-select maxlength="2" v-model="lcNodeAttrform.allowRecall"
                                                placeholder="请选择">
                                                <el-option value="">请选择</el-option>
                                                <el-option
                                                    v-for="item in [{value:'10',label:'不允许'},{value:'20',label:'允许'}]"
                                                    :key="item.value"
                                                    :label="item.label"
                                                    :value="item.value">
                                                </el-option>
                                            </el-select>
                                        </div>
                                        <div class="col-md-2">
                                          <b-badge class="mr-4" variant="success">注意：表示流程流转到该任务时候，上级或其它节点能否支持撤回</b-badge>
                                        </div>
                                    </div>
                                    <div class="form-group m-form__group row">
                                        <label class="col-md-3 col-form-label">指定节点允许主动撤回</label>
                                        <div class="col-md-2">
                                            <el-select maxlength="2" v-model="lcNodeAttrform.recall"
                                                placeholder="请选择">
                                                <el-option value="">请选择</el-option>
                                                <el-option
                                                    v-for="item in [{value:'10',label:'不允许'},{value:'20',label:'允许'}]"
                                                    :key="item.value"
                                                    :label="item.label"
                                                    :value="item.value">
                                                </el-option>
                                            </el-select>
                                        </div>
                                        <div class="col-md-1">
                                            <b-badge class="mr-4" variant="danger">*注意：允许主动撤回,且下一节点任务尚未处理，则可以撤回到本节点中,已办事项中可以进行操作</b-badge>
                                        </div>
                                    </div>
                                    <div class="form-group m-form__group row">
                                        <label class="col-md-3 col-form-label">该节点上操作驳回方式</label>
                                        <div class="col-md-2">                                            
                                            <el-select maxlength="2" v-model="lcNodeAttrform.rejectType"
                                                placeholder="请选择">
                                                <el-option value="">请选择</el-option>
                                                <el-option
                                                    v-for="item in [{value:'10',label:'按最近一次流入节点'},{value:'20',label:'驳回至发起人'}
                                                    ,{value:'30',label:'按自定义节点驳回'},{value:'40',label:'按流程图驳回至上级'}]"
                                                    :key="item.value"
                                                    :label="item.label"
                                                    :value="item.value">
                                                </el-option>
                                            </el-select>
                                        </div>
                                        <div class="col-md-1">
                                            <b-badge class="mr-4" variant="warning">注意：驳回方式默认按上级走即流程图中设计连线流向，也可直接驳回至发起人</b-badge>
                                        </div>
                                    </div>
                                    <div class="form-group m-form__group row">
                                        <label class="col-md-3 col-form-label">按流程图上级驳回规则</label>
                                        <div class="col-md-2">
                                            <el-select maxlength="2" v-model="lcNodeAttrform.rejectRule"
                                                placeholder="请选择">
                                                <el-option value="">请选择</el-option>
                                                <el-option
                                                    v-for="item in [{value:'10',label:'如果当前节点在流程图上存在多个任务随机一个'},{value:'20',label:'如果当前节点在流程图上存在多个任务抛出异常'}]"
                                                    :key="item.value"
                                                    :label="item.label"
                                                    :value="item.value">
                                                </el-option>
                                            </el-select>
                                        </div>
                                        <div class="col-md-1">
                                            <b-badge class="mr-4" variant="info">注意：针对驳回方式为按流程图上级走向驳回为前提，按规则指定结果</b-badge>
                                        </div>
                                    </div>

                                    <div class="form-group m-form__group row">
                                        <label class="col-md-3 col-form-label">驳回时终止其它运行实例</label>
                                        <div class="col-md-2">
                                            <el-select v-model="lcNodeAttrform.rejectTerminationOtherExecution"
                                                placeholder="请选择">
                                                <el-option value="">请选择</el-option>
                                                <el-option
                                                    v-for="item in [{value:'10',label:'否'},{value:'20',label:'结束其它运行实例'}]"
                                                    :key="item.value"
                                                    :label="item.label"
                                                    :value="item.value">
                                                </el-option>
                                            </el-select>
                                        </div>
                                        <div class="col-md-1">
                                            <b-badge class="mr-4" variant="primary">注意：当在该节点进行驳回时是否终止其它运行实例，<br>如果终止则会将当前流程实例下的其它运行实例全部终止，反之不会</b-badge>
                                        </div>
                                    </div>
                                    <div class="form-group m-form__group row">
                                        <label class="col-md-3 col-form-label">驳回后节点执行人</label>
                                        <div class="col-md-2">
                                            <el-select v-model="lcNodeAttrform.rejectExecutor"
                                                placeholder="请选择">
                                                <el-option value="">请选择</el-option>
                                                <el-option
                                                    v-for="item in [{value:'10',label:'采用原节点审批人'},{value:'20',label:'重新指定人'},{value:'30',label:'采用原节点配置规则选举人'}]"
                                                    :key="item.value"
                                                    :label="item.label"
                                                    :value="item.value">
                                                </el-option>
                                            </el-select>
                                        </div>
                                        <div class="col-md-1">
                                            <b-badge class="mr-4" variant="dark">注意：驳回之后的节点（含义当前节点点击驳回到上级节点，<br>那么此时的上级节点重新拿到任务，这个节点处理人）执行人可以按原节点审批人指定</b-badge>
                                        </div>
                                    </div>
                                    <div class="form-group m-form__group row">
                                        <label class="col-md-3 col-form-label">完成动作向下个节点流转采用模式</label>
                                        <div class="col-md-2">
                                            <el-select v-model="lcNodeAttrform.supportFreeJump"
                                                placeholder="请选择">
                                                <el-option value="">请选择</el-option>
                                                <el-option
                                                    v-for="item in [{value:'10',label:'跳转模式'},{value:'20',label:'原生引擎完成'}]"
                                                    :key="item.value"
                                                    :label="item.label"
                                                    :value="item.value">
                                                </el-option>
                                            </el-select>
                                        </div>
                                        <div class="col-md-1">
                                            <b-badge class="mr-4" variant="secondary">采用自由跳转还是原生引擎完成，根据具体业务来选择，如并行网关时，<br>A节点为会签节点，B节点为普通节点，如果A采用跳转模式往下一个节点跳转，<br>那么两个节点就不是处于等待一起汇交。</b-badge>
                                        </div>
                                    </div>
                                </div>                                
                            </div>
                        </b-card-text>
                    </b-tab>
                    <b-tab title="会签" :disabled="isMuti">
                        <template #title>                            
                            会&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;签
                        </template>
                        <b-card-text>
                            <div class="m-form m-form--fit m-form--label-align-left m-form--group-seperator-dashed">                                
                                <div class="m-form m-form--fit m-form--label-align-left m-form--group-seperator-dashed">
                                    <div class="m-portlet__body">
                                        <input type="hidden" id="mutil" name="mutil">
                                        <input type="hidden" name="allowSign" id="allowSign">
                                        <div class="form-group m-form__group row">
                                            <div class="alert m-alert m-alert--default" role="alert">
                                                说明：对会签的属性进行扩展，<code>如业务变量，业务逻辑等</code> .
                                            </div>
                                        </div>
                                        <div class="form-group m-form__group row">
                                            <label class="col-md-2">决策方式</label>
                                            <div class="m-form__group form-group">
                                                <div class="radio-inline">
                                                    <label class="radio radio-lg">
                                                    <input type="radio" checked="checked" value="10" v-model="lcNodeAttrform.policy" name="policy">
                                                    <span></span>通过</label>
                                                    <label class="radio radio-lg">
                                                    <input type="radio" value="20" v-model="lcNodeAttrform.policy" name="policy">
                                                    <span></span>拒绝</label>
                                                    <label class="radio radio-lg">
                                                    <input type="radio" value="30" v-model="lcNodeAttrform.policy" name="policy" >
                                                    <span></span>弃权</label>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="form-group m-form__group row">
                                            <label class="col-md-2">投票策略</label>
                                            <div class="m-form__group form-group">
                                                <div class="radio-inline">
                                                    <label class="radio radio-lg radio-success">
                                                    <input type="radio" checked="checked" v-model="lcNodeAttrform.votingStrategy" value="10" name="votingStrategy" @change="clickVotingStrategy">
                                                    <span></span>百分比</label>
                                                    <label class="radio radio-lg radio-success">
                                                    <input type="radio" v-model="lcNodeAttrform.votingStrategy" name="votingStrategy"  value="20" @change="clickVotingStrategy">
                                                    <span></span>投票数</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group m-form__group row" v-if="this.lcNodeAttrform.votingStrategy == 10">
                                            <label class="col-md-2 col-form-label">百分比</label>
                                            <div class="m-form__group form-group">
                                                <el-input-number 
                                                    v-model="lcNodeAttrform.percentage" 
                                                    maxlength="3" 
                                                    style="width:100px;" 
                                                    controls-position="right"
                                                    :min="0" 
                                                    :max="100">
                                                    </el-input-number>
                                            </div>
                                            <label class="col-form-label">%</label>
                                        </div>
                                        <div class="form-group m-form__group row" v-if="this.lcNodeAttrform.votingStrategy == 20">
                                            <label class="col-md-2 col-form-label">投&nbsp;&nbsp;票&nbsp;&nbsp;数</label>
                                            <div class="m-form__group form-group">
                                                <el-input-number 
                                                    v-model="lcNodeAttrform.numberVotes" 
                                                    maxlength="3" 
                                                    style="width:100px;" 
                                                    controls-position="right"
                                                    :min="0" 
                                                    :max="9999">
                                                    </el-input-number>
                                            </div>
                                        </div>
                                        <div class="form-group m-form__group row">
                                            <label class="col-md-2">允许加签</label>
                                            <div class="m-form__group form-group">
                                                <label class="checkbox checkbox-lg checkbox-light-success checkbox-inline flex-shrink-0 m-0 mx-1">
                                                    <input type="checkbox" v-model="lcNodeAttrform.allowSignCheckBox" @click="clickAllowSign()">
                                                    <span></span>
                                                </label>
                                            </div>
                                        </div>
                                        <div class="form-group m-form__group row">
                                            <label class="col-md-2">需要所有人员投票</label>
                                            <div class="m-form__group form-group">
                                                <div class="radio-inline">
                                                    <label class="radio radio-lg radio-danger">
                                                    <input type="radio" checked="checked" value="10" v-model="lcNodeAttrform.needAllVote" name="needAllVote">
                                                    <span></span>是</label>
                                                    <label class="radio radio-lg radio-danger">
                                                    <input type="radio" value="20" v-model="lcNodeAttrform.needAllVote" name="needAllVote">
                                                    <span></span>否</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group m-form__group row">
                                            <label class="col-md-2 col-form-label">会签集合变量名</label>
                                            <div class="col-md-2">
                                                <input class="form-control" type="text" maxlength="60" id="mutilKey" name="mutilKey" placeholder="请输入">
                                            </div>
                                            <div class="col-md-1">
                                                <b-badge class="mr-1" variant="primary">“集合”中变量一致。如流程设计器中节点集合值为${assigneeList}那么你这个时候就要设置成'assigneeList'即可 <br>这样在传递的时候方便前端选择多个审批人，{'assigneeList':{'JEHC1','JEHC2','JEHC3'}} .</b-badge>
                                            
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </b-card-text>
                    </b-tab>
                    <b-tab title="流程图">
                        <template #title>                            
                            流&nbsp;&nbsp;程&nbsp;&nbsp;图
                        </template>
                        <b-card-text>
                            <div class="m-form m-form--fit m-form--label-align-left m-form--group-seperator-dashed">
                                <div class="m-portlet__body">
                                    <img :src="nodeImagePath" style="max-width:70vw; width:expression(document.body.clientWidth>400?'70vw':'auto'); overflow:hidden;">
                                </div>
                            </div>
                        </b-card-text>
                    </b-tab>
                    <b-tab title="其它">
                        <template #title>                            
                            其&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;它
                        </template>
                        <b-card-text>                            
                            <div class="m-form m-form--fit m-form--label-align-left m-form--group-seperator-dashed">
                                <div class="m-portlet__body">
                                    <div class="form-group m-form__group row">
                                        <div class="alert m-alert m-alert--default" role="alert">
                                            说明：自定义额外扩展属性 <code>如json格式用于业务处理</code> .
                                        </div>
                                    </div>
                                    <div class="form-group m-form__group row">
                                        <label class="col-md-2 col-form-label">扩展属性</label>
                                        <div class="col-md-8">
                                            <textarea class="form-control" rows="10" maxlength="65535" v-model="lcNodeAttrform.attr" placeholder="请输入"></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </b-card-text>
                    </b-tab>
                </b-tabs>
            </b-card>

        </div>
        <template slot="modal-footer">
            <!--自定义按钮-->
            <button type="button" class="btn btn-light-danger font-weight-bold mr-2" block @click="hideModal">
                <i class="icon-xl fa fa-times"></i>取消
            </button>
            <button type="button" class="btn btn-light-success font-weight-bold mr-2" @click="saveLcNodeAttribute">
                <i class="icon-xl fas fa-save"></i> 保存
            </button>
        </template>
        <nodeFormFieldWin ref="nodeFormFieldWinRef"  @change="setNodeField"></nodeFormFieldWin>  
        <lcBtnWin ref="lcBtnWinRef"  @change="setBtn"></lcBtnWin>  
        <lcJumpRulesWin ref="lcJumpRulesWinRef"  @change="setJumpRules"></lcJumpRulesWin>
        <MutilUserSelect ref="MutilUserSelectRef" :userOption="{userOption}" @change="doSetMutilUser"></MutilUserSelect><!--采用父窗口关闭传递的方法--> 
        <SingleUserSelect ref="SingleUserSelectRef" :userOption="{userOption}" @change="doSetSingleUser"></SingleUserSelect><!--采用父窗口关闭传递的方法--> 
        <lcTargetNodeWin ref="lcTargetNodeWinRef" @change="setLcTargetNode"></lcTargetNodeWin>
        <lcRoleWin ref="lcRoleWinRef"  @change="setRole"></lcRoleWin>  
        <lcDepartWin ref="lcDepartWinRef"  @change="setDepart"></lcDepartWin>  
        <lcPostWin ref="lcPostWinRef"  @change="setPost"></lcPostWin>  
    </b-modal>
</template>
<script>
import apiUtil from "@/core/util/apiUtil.js";
import { handleNotify, handleAlert, handleConfirm, showWating, closeWating } from "@/core/util/jehcUtil.js";
import nodeFormFieldWin from "@/view/workflow/lc-node-attribute/node-form-field-win.vue";
import lcJumpRulesWin from "@/view/workflow/lc-node-attribute/lc-jump-rules-win.vue";
import lcTargetNodeWin from "@/view/workflow/lc-node-attribute/lc-jump-rules-win.vue";
import SingleUserSelect from "@/components/user-select.vue";
import MutilUserSelect from "@/components/user-select.vue";
import lcBtnWin from  "@/view/workflow/lc-node-attribute/lc-btn-win.vue";
import lcRoleWin from  "@/view/workflow/lc-node-attribute/lc-role-win.vue";
import lcDepartWin from  "@/view/workflow/lc-node-attribute/lc-depart-win.vue";
import lcPostWin from  "@/view/workflow/lc-node-attribute/lc-post-win.vue";
export default {
    data() {
        return {
            userOption:{allowMultiSelect:false},
            currentRow:null,
            candidateGroupsList:[],//候选组
            candidateList:[],//候选人            
            isMuti:true,//是否会签节点
            assigneeTypeList: [{
                value: '0',
                label: '用户发起人'
                }, {
                value: '1',
                label: '指定具体人'
                }, {
                value: '2',
                label: '当前用户上级'
                }, {
                value: '3',
                label: '当前用户下级'
                }, {
                value: '4',
                label: '自定义'
            }],
            nodeImagePath:"",
            title:"编辑节点",
            noticeTypes:[{
                key:"sms",value:"短信"
            },{
                key:"mail",value:"邮件"
            },{
                key:"enterpriseWechat",value:"企业微信"
            },{
                key:"nailNail",value:"钉钉"
            },{
                key:"officialWechat",value:"微信公众号"
            },{
                key:"notice",value:"站内"
            }],
            notifyTemplateList:[],
            lcNodeAttrform: {
                //公共属性开始
                lcProcessId: "",
                mountsId: "",
                hid_: "",
                nodeId:"",
                id:"",
                //公共属性结束
                attributeKey:"",
                orderNumber:"",
                remark:"",
                noticeType:"",
                noticeTypes:[],
                notifyTemplateIds:"",
                notifyTemplateIdTemp:"",
                initiator:"",
                urgent:"",
                pcFormUri:"",
                mobileFormUri:"",
                mutil:"",
                nodeFormField:[],//字段权限

                // 高级
                opinion:"",
                allowRecall:"",
                recall:"",
                rejectType:"",
                rejectRule:"",
                rejectTerminationOtherExecution:"",
                rejectExecutor:"",
                supportFreeJump:"",

                //会签
                allowSignCheckBox:"",
                needAllVote:"10",//10是 20 否
                votingStrategy:"10",//10百分比 20投票数
                policy:"10",//10通过 20拒绝 30弃权
                percentage:"51",//百分比
                numberVotes:"1",//投票数
                //跳转规则
                basedOnCondition_:"",

                lcNodeCandidate:[{candidateUsersText:"",candidateId:"",assigneeText:"",assigneeId:"",assigneeType:"",remark:"",remark1:"",remark2:"",candidateGroupId:"",candidateGroupsText:"",candidateGroupType:""}],
                lcNotifyTemplates:[],
                lcJumpRules:[],//跳转规则
                lcNodeBtns:[],//按钮

            }
        }
    },
    
    components: {
        nodeFormFieldWin,
        SingleUserSelect,
        MutilUserSelect,
        lcJumpRulesWin,
        lcBtnWin,
        lcTargetNodeWin,
        lcRoleWin,
        lcDepartWin,
        lcPostWin,
    },
    computed:{
        formCandidateGroupType(){//监听表单中数组中集合指定记录中指定字段监听
            return this.lcNodeAttrform.lcNodeCandidate[0].candidateGroupType;
        }
    },
    watch: {
        "lcNodeAttrform.noticeTypes":{//监听字段变化
            handler:function(newVal,old){
                if(newVal){
                    this.lcNodeAttrform.noticeType = newVal.join(",");
                }
            }
        },
        "lcNodeAttrform.notifyTemplateIdTemp":{//监听字段变化
            handler:function(newVal,old){
                if(newVal){
                    this.lcNodeAttrform.notifyTemplateIds = newVal.join(",");
                }
            }
        },
        "formCandidateGroupType":{
            handler:function(newVal,old){
                // if(newVal){
                    this.candidateGroupsList = [];
                // }
            }
        },
    },
    mounted() {

    },
    methods: {        
        saveLcNodeAttribute() {
            if (this.lcNodeAttrform.orderNumber === "") {
                handleAlert("请输入排序号", "warning", 3)
                return;
            }
            this.doSetCandidateGroupsValues();//转换候选组数据体
            this.doSetCandidateValues();//转换候选人数据体
            console.log("this.lcNodeAttrform.lcNodeCandidate",this.lcNodeAttrform.lcNodeCandidate);
            // 保存前提示
            this.$confirm("确定保存?", "提示", { type: "warning", }).then(() => {
                showWating({ renderBody: "tableLcNodeAttributeEditBody",message:"正在保存配置，请稍后..." });
                apiUtil.post(process.env.VUE_APP_WORKFLOW_API + "/lcNodeAttribute/save", this.lcNodeAttrform).then(({ data }) => {
                    if (data.success) {
                        handleAlert("操作成功", "success", 3);
                        this.hideModal();//关闭窗体
                        this.$emit("change", data);//组件传值，即向父级模态框中传递值，采用change方式，目标刷新主列表使用
                    } else {
                        handleAlert("操作失败", "error", 3);
                    }
                });
            }).catch(() => { });//注意这里，这里是重点！！！;   
        },
        showModal(row) {
            this.restForm();
            this.$refs['my-modal'].show();   
            this.initNotifyTemplateList();   
            this.getDetail(row);      
            this.currentRow = row;
        },
        hideModal() {
            this.$refs['my-modal'].hide()
        },
        toggleModal() {
            // 当模态已隐藏时，我们传递要返回焦点的按钮的ID
            this.$refs['my-modal'].toggle('#toggle-btn')
        },
        restForm() {
            //重置
            Object.assign(this.$data.lcNodeAttrform, this.$options.data().lcNodeAttrform);
        },
        initNotifyTemplateList(){
            let param = {};
            apiUtil.query(process.env.VUE_APP_WORKFLOW_API + "/lcNotifyTemplate/find",param).then(({ data }) => {
                this.notifyTemplateList = data.data;
            });
        },
        getDetail(row) {
            console.log("row",row);
            showWating({ renderBody: "tableLcNodeAttributeEditBody",message:"正在加载节点数据中..." });
            this.candidateGroupsList = [];
            this.candidateList = [];
            var mountsId = row.mountsId;//挂载编号
            var hid_ = row.hid_;//发布历史版本id
            var nodeName = row.nodeName;//节点名称
            var nodeId = row.nodeId;//节点id
            var noticeType = row.noticeType;
            var lcProcessId = row.lcProcessId;
            var attributeKey = row.attributeKey;
            var lcProcessTitle = row.lcProcessTitle;
            var mutil = row.mutil;
            var nodeType = row.nodeType;
            var param = {hid_:hid_,nodeId:nodeId,mountsId:mountsId};
            if(mutil == 20){               
                this.isMuti = false;
            }else{
                this.isMuti = true;
            }
            // console.log("isMuti",this.isMuti);
            apiUtil.query(process.env.VUE_APP_WORKFLOW_API + "/lcNodeAttribute/attribute",param).then(({ data }) => {
                if(null === data.data){
                    this.title = "流程节点-【"+lcProcessTitle+"】-【"+nodeName+"】-【暂无规则】"
                    this.initImage(row);   
                    this.lcNodeAttrform.attributeKey = attributeKey;
                    this.lcNodeAttrform.lcProcessTitle = lcProcessTitle;
                    this.lcNodeAttrform.mutil = mutil;
                    this.lcNodeAttrform.nodeType= nodeType;
                    this.lcNodeAttrform.lcProcessId = lcProcessId
                    this.lcNodeAttrform.noticeType = noticeType;
                    this.lcNodeAttrform.hid_ = hid_;
                    this.lcNodeAttrform.mountsId = mountsId;
                    this.lcNodeAttrform.nodeName = nodeName;
                    this.lcNodeAttrform.nodeId = nodeId;  
                    this.lcNodeAttrform.lcJumpRules = [];
                    this.lcNodeBtns = [];
                }else{
                    this.title = "流程节点-【"+lcProcessTitle+"】-【"+nodeName+"】-【已设定】" 
                    this.lcNodeAttrform.lcJumpRules = [];
                    this.lcNodeBtns = [];                
                    this.lcNodeAttrform = data.data;    
                    this.initImage(data.data);   
                    if(data.data.noticeType){
                        let arr = data.data.noticeType.split(",");
                        let arrNew = [];                   
                        for(var i in arr){
                            arrNew.push(arr[i])
                        }
                        if(arrNew){
                            this.$set(this.lcNodeAttrform,"noticeTypes",arrNew);
                        }
                    } 
                    if(data.data.notifyTemplateIds){
                        let arr = data.data.notifyTemplateIds.split(",");
                        let arrNew = [];                   
                        for(var i in arr){
                            arrNew.push(arr[i])
                        }
                        if(arrNew){
                            this.$set(this.lcNodeAttrform,"notifyTemplateIdTemp",arrNew);
                        }
                    } 
                    // this.lcNodeAttrform.nodeFormField.forEach(item => {
                    //     if(null != item.filedRequired && '' != item.filedRequired){
                    //         item.filedRequired = item.filedRequired;
                                             
                    //         this.initFormFieldOptions(); 
                    //     }
                    // })
                    this.initRoleList();//初始化组-按角色 集合
                    this.intDepartList();//初始化组-按部门 集合
                    this.initPostList();//初始化组-按岗位 集合
                    this.initAssigneeList();//初始化办理人
                    this.initCandidateList();//初始化候选人集合
                }      
            });
        },
        onHidden(){//关闭窗体触发事件
            this.$emit("change",null);
        },
        initImage(data) {            
            var type;
            var hid_ = data.hid_;
            var mountsId = data.mountsId;
            var id = "";
            if(null == hid_ || "" == hid_ || 'null' == hid_){

            }else{
                type = 2;
                id = hid_;
            }
            if(null == mountsId || "" == mountsId || 'null' == mountsId){

            }else{
                type = 1;
                id = mountsId;
            }
            let param = [{activityId:this.lcNodeAttrform.nodeId}];
            if(type == 1){
                apiUtil.post(process.env.VUE_APP_WORKFLOW_API+"/lcProcess/image/attr/"+id,param).then(({ data }) => {
                    this.nodeImagePath = data.data;
                });
            }
            if(type == 2){
                apiUtil.post(process.env.VUE_APP_WORKFLOW_API+"/lcDeploymentHis/image/attr/"+id,param).then(({ data }) => {
                    this.nodeImagePath = data.data;
                });
            }            
        },
        clickVotingStrategy(){
            // console.log('被选中的值为:'+this.lcNodeAttrform.votingStrategy)
        },
        clickAllowSign(){

        },        
        initFormFieldWin(){
            this.$refs.nodeFormFieldWinRef.showModal(); 
        },
        changeValue(e){
            if(e){
                return false;
            }else{

            }
        },
        handleDeleteNodeFormField(index,row){
            this.$bvModal.msgBoxConfirm('确定要删除该项?', {
                title: '提示',
                size: 'sm',
                buttonSize: 'sm',
                okVariant: 'success',
                okTitle: '确定',
                cancelTitle: '取消',
                headerClass: 'p-2 border-bottom-0',
                footerClass: 'p-2 border-top-0',
                hideHeaderClose: false,
                centered: true
            }).then(value => {
                if(value){                    
                    this.lcNodeAttrform.nodeFormField.splice(index, 1)
                }                
            }).catch(err => {               
            }) 
        },
        handleDeleteJumpRules(index,row){
            this.$bvModal.msgBoxConfirm('确定要移除该项?', {
                title: '提示',
                size: 'sm',
                buttonSize: 'sm',
                okVariant: 'success',
                okTitle: '确定',
                cancelTitle: '取消',
                headerClass: 'p-2 border-bottom-0',
                footerClass: 'p-2 border-top-0',
                hideHeaderClose: false,
                centered: true
            }).then(value => {
                if(value){                    
                    this.lcNodeAttrform.lcJumpRules.splice(index, 1)
                }                
            }).catch(err => {               
            }) 
        },
        setNodeField(data){//设置窗体选择的字段
            data.forEach(item => {
                let itemObj = {};
                // console.log("setNodeField",item);
                itemObj.lcFormId =item.lcFormId;
                itemObj.fieldLabel = item.fieldLabel;
                itemObj.fieldId = item.fieldId;
                itemObj.fieldName = item.fieldName;
                itemObj.fieldRead = item.fieldRead;
                itemObj.fieldWrite = item.fieldWrite;
                itemObj.filedHide = item.filedHide;
                itemObj.filedRequired = item.filedRequired;
                if(!this.lcNodeAttrform.nodeFormField){
                    this.lcNodeAttrform.nodeFormField = [];
                }
                this.lcNodeAttrform.nodeFormField.push(itemObj);
            })
        },
        initAssignee(){//初始化指定人选择器窗体
            this.userOption.allowMultiSelect = false;
            this.$refs.SingleUserSelectRef.showModal(); 
        },
        doSetSingleUser(data){//设置指定人
            let ids = data.map((item) => item.id);
            let names = data.map((item) => item.name);
            // console.log(this.lcNodeAttrform.lcNodeCandidate[0]);
            // this.lcNodeAttrform.lcNodeCandidate[0].assigneeText = names.join(",");
            // this.lcNodeAttrform.lcNodeCandidate[0].assigneeId = ids.join(",");
            this.$set(this.lcNodeAttrform.lcNodeCandidate[0],"assigneeText",names.join(","))
            this.$set(this.lcNodeAttrform.lcNodeCandidate[0],"assigneeId",ids.join(","))
            // console.log(this.lcNodeAttrform.lcNodeCandidate[0]);
        },
        resetAssignee(){//清空经办人           
            this.$set(this.lcNodeAttrform.lcNodeCandidate[0],"assigneeText","")
            this.$set(this.lcNodeAttrform.lcNodeCandidate[0],"assigneeId","")
        },
        initCandidate(){//初始化候选人选择器窗体
            this.userOption.allowMultiSelect = true;
            this.$refs.MutilUserSelectRef.showModal(); 
        },
        doSetMutilUser(data){//设置候选人
            let arr = data;
            for (var i = 0; i < arr.length; i++) {
                let candidateItem = {};
                candidateItem.name = arr[i].name;
                candidateItem.id = arr[i].id;
                candidateItem.code = arr[i].account;
                this.candidateList.push(candidateItem);
            }    
        },
        delCandidate(index,row){//删除候选人
            this.candidateList.splice(index, 1);
        },
        initCandidateGroups(){
            if(this.lcNodeAttrform.lcNodeCandidate[0].candidateGroupType == ""){
                handleAlert("请选择组类型", "warning", 3)
                return;
            }
            if(this.lcNodeAttrform.lcNodeCandidate[0].candidateGroupType == 0){
                this.$refs.lcDepartWinRef.showModal(); 
            }
            if(this.lcNodeAttrform.lcNodeCandidate[0].candidateGroupType == 1){
                this.$refs.lcPostWinRef.showModal(); 
            }
            if(this.lcNodeAttrform.lcNodeCandidate[0].candidateGroupType == 2){
                this.$refs.lcRoleWinRef.showModal(this.lcNodeAttrform); 
            }      
        },        
        delCandidateGroups(index,row){//删除候选组
            this.candidateGroupsList.splice(index, 1)     
        },
        setRole(data){//设置角色
            let candidateGroupsList = this.candidateGroupsList;
            console.log("candidateGroupsList",candidateGroupsList);
            data.forEach(item => {               
                let exist = false;
                if(candidateGroupsList){
                    for(var i in candidateGroupsList){
                        if(candidateGroupsList[i].id === item.id){
                            exist = true;
                            break;
                        }
                    }
                }   
                if(!exist){
                    let candidateGroupItem = {};
                    candidateGroupItem.name = item.name;
                    candidateGroupItem.id = item.id;
                    candidateGroupItem.code = item.code;                
                    this.candidateGroupsList.push(candidateGroupItem);   
                }          
            })
        },
        setDepart(data){//设置部门
            let candidateGroupsList = this.candidateGroupsList;
            data.forEach(item => {               
                let exist = false;
                if(candidateGroupsList){
                    for(var i in candidateGroupsList){
                        if(candidateGroupsList[i].id === item.id){
                            exist = true;
                            break;
                        }
                    }
                }   
                if(!exist){
                    let candidateGroupItem = {};
                    candidateGroupItem.name = item.text;
                    candidateGroupItem.id = item.id;
                    candidateGroupItem.code = "";                
                    this.candidateGroupsList.push(candidateGroupItem);   
                }          
            })
        },
        setPost(data){//设置岗位
            let candidateGroupsList = this.candidateGroupsList;
            data.forEach(item => {               
                let exist = false;
                if(candidateGroupsList){
                    for(var i in candidateGroupsList){
                        if(candidateGroupsList[i].id === item.id){
                            exist = true;
                            break;
                        }
                    }
                }   
                if(!exist){
                    let candidateGroupItem = {};
                    candidateGroupItem.name = item.text;
                    candidateGroupItem.id = item.id;
                    candidateGroupItem.code = "";                
                    this.candidateGroupsList.push(candidateGroupItem);   
                }          
            })
        },
        showTargetNodeWin(){
            this.$refs.lcJumpRulesWinRef.showModal(this.currentRow);
        },
        setJumpRules(data){//设置跳转规则值
            data.forEach(item => {
                let itemObj = {};
                itemObj.nodeName =item.nodeName;
                itemObj.targetNodeId = item.nodeId;
                itemObj.basedOnCondition = 0;
                itemObj.conditions_ = "";
                if(!this.lcNodeAttrform.lcJumpRules){
                    this.lcNodeAttrform.lcJumpRules = [];
                }
                this.lcNodeAttrform.lcJumpRules.push(itemObj);
            })
        },
        showBtnWin(){
            this.$refs.lcBtnWinRef.showModal(); 
        },
        setBtn(data){//设置按钮项
            data.forEach(item => {
                let itemObj = {};
                itemObj.btnId =item.id;
                itemObj.label_ = item.label_;
                itemObj.btnAction = item.action_;
                itemObj.btnLabel = item.label_;
                itemObj.lcJumpRules = [];//必须要设置一个属性 否则下面添加目标节点 则始终不生效 原因没定义数组类型
                if(!this.lcNodeAttrform.lcNodeBtns){
                    this.lcNodeAttrform.lcNodeBtns = [];
                }
                this.lcNodeAttrform.lcNodeBtns.push(itemObj);
            })
        },
        handleBtnTargetNode(index1,index2,row){//移除按钮关联目标节点
            this.$bvModal.msgBoxConfirm('确定要移除该项?', {
                title: '提示',
                size: 'sm',
                buttonSize: 'sm',
                okVariant: 'success',
                okTitle: '确定',
                cancelTitle: '取消',
                headerClass: 'p-2 border-bottom-0',
                footerClass: 'p-2 border-top-0',
                hideHeaderClose: false,
                centered: true
            }).then(value => {
                if(value){                    
                    this.lcNodeAttrform.lcNodeBtns[index1].lcJumpRules.splice(index2, 1);
                }                
            }).catch(err => {               
            }) 
        },
        handleDeleteBtn(index,row){
            this.$bvModal.msgBoxConfirm('确定要移除该项?', {
                title: '提示',
                size: 'sm',
                buttonSize: 'sm',
                okVariant: 'success',
                okTitle: '确定',
                cancelTitle: '取消',
                headerClass: 'p-2 border-bottom-0',
                footerClass: 'p-2 border-top-0',
                hideHeaderClose: false,
                centered: true
            }).then(value => {
                if(value){               
                    this.lcNodeAttrform.lcNodeBtns.splice(index, 1)     
                }                
            }).catch(err => {               
            }) 
        },
        showBtnTargetNode(index,row){
            this.$refs.lcTargetNodeWinRef.showModal(this.currentRow,index,row);            
        },
        setLcTargetNode(data,callBackData){//设置目标节点
            let thiz = this;
            if(!thiz.lcNodeAttrform.lcNodeBtns[callBackData.index].lcJumpRules){
                thiz.lcNodeAttrform.lcNodeBtns[callBackData.index].lcJumpRules = [];
            }
            // console.log(thiz.lcNodeAttrform.lcNodeBtns);
            // console.log(callBackData.index);
            const tempArr =  thiz.lcNodeAttrform.lcNodeBtns[callBackData.index].lcJumpRules

            data.forEach(item => {
                let itemObj = {};
                itemObj.nodeName =item.nodeName;
                itemObj.targetNodeId = item.nodeId;
                itemObj.conditions_ = "";     
                tempArr.push(itemObj);
                // console.log(thiz.lcNodeAttrform.lcNodeBtns[callBackData.index].lcJumpRules);
                // this.$forceUpdate();
            })
            this.$set(thiz.lcNodeAttrform.lcNodeBtns[callBackData.index],"lcJumpRules",tempArr)
            // this.lcNodeAttrform.lcNodeBtns = thiz.lcNodeAttrform.lcNodeBtns;
            // console.log(thiz.lcNodeAttrform);    
            // this.$set(thiz.lcNodeAttrform.lcNodeBtns[callBackData.index],"lcJumpRules",tempArr)
            // this.lcNodeAttrform.lcNodeBtns = lcNodeBtns;
            // this.$forceUpdate();
        },
        doGroupId(){
            var orgArray = this.lcNodeAttrform.lcNodeCandidate[0].candidateGroupId.split(',');
            let ids = "";
            for(var i = 0; i < orgArray.length; i++){
                var org = orgArray[i];
                var org_ = org.split(":");
                if(null != ids && '' != ids){
                    ids = ids + "," + org_[1];
                }else{
                    ids = org_[1];
                }
            }
            return ids;
        },
        initAssigneeList(){
            if(null != this.lcNodeAttrform.lcNodeCandidate[0].assigneeId && "" != this.lcNodeAttrform.lcNodeCandidate[0].assigneeId){
                apiUtil.get(process.env.VUE_APP_SYS_API+"/xtUserinfo/get/"+this.lcNodeAttrform.lcNodeCandidate[0].assigneeId).then(({ data }) => {
                    this.$set(this.lcNodeAttrform.lcNodeCandidate[0],"assigneeText",data.data.name)
                    this.$set(this.lcNodeAttrform.lcNodeCandidate[0],"assigneeId",data.data.id)
                });
            }
        },
        initCandidateList(){
            if(null != this.lcNodeAttrform.lcNodeCandidate[0].candidateId && "" != this.lcNodeAttrform.lcNodeCandidate[0].candidateId){
                let param = {id:this.lcNodeAttrform.lcNodeCandidate[0].candidateId};
                apiUtil.post(process.env.VUE_APP_SYS_API+"/xtUserinfo/users",param).then(({ data }) => {
                    let arr = data.data;
                    for (var i = 0; i < arr.length; i++) {
                        let candidateItem = {};
                        candidateItem.name = arr[i].name;
                        candidateItem.id = arr[i].id;
                        candidateItem.code = arr[i].account;
                        this.candidateList.push(candidateItem);
                    }    
                });
            }
        },        
        intDepartList(){
            if(this.lcNodeAttrform.lcNodeCandidate[0].candidateGroupType == 0){                
                if(null != this.lcNodeAttrform.lcNodeCandidate[0].candidateGroupId && "" != this.lcNodeAttrform.lcNodeCandidate[0].candidateGroupId){
                    let ids = this.doGroupId();
                    apiUtil.get(process.env.VUE_APP_SYS_API+"/xtDepartinfo/list/"+ids).then(({ data }) => {
                        let arr = data.data;
                        for (var i = 0; i < arr.length; i++) {
                            let candidateGroupItem = {};
                            candidateGroupItem.id = arr[i].id;
                            candidateGroupItem.code = arr[i].code;
                            candidateGroupItem.name = arr[i].name;
                            this.candidateGroupsList.push(candidateGroupItem);
                        }     
                    });
                }
            }
        },
        initPostList(){
            if(this.lcNodeAttrform.lcNodeCandidate[0].candidateGroupType == 1){
                if(null != this.lcNodeAttrform.lcNodeCandidate[0].candidateGroupId && "" != this.lcNodeAttrform.lcNodeCandidate[0].candidateGroupId){
                    let ids = this.doGroupId();
                    apiUtil.get(process.env.VUE_APP_SYS_API+"/xtPost/list/"+ids).then(({ data }) => {
                        let arr = data.data;
                        for (var i = 0; i < arr.length; i++) {
                            let candidateGroupItem = {};
                            candidateGroupItem.id = arr[i].id;
                            candidateGroupItem.code = arr[i].code;
                            candidateGroupItem.name = arr[i].name;
                            this.candidateGroupsList.push(candidateGroupItem);
                        }   
                    });
                }
            }
        },
        initRoleList(){     
            console.log("this.lcNodeAttrform.lcNodeCandidate[0].candidateGroupType == 2",this.lcNodeAttrform.lcNodeCandidate[0].candidateGroupType);      
            if(this.lcNodeAttrform.lcNodeCandidate[0].candidateGroupType == 2){
                if(null != this.lcNodeAttrform.lcNodeCandidate[0].candidateGroupId && "" != this.lcNodeAttrform.lcNodeCandidate[0].candidateGroupId){
                    let ids = this.doGroupId();
                    apiUtil.get(process.env.VUE_APP_OAUTH_API+"/oauthRole/list/"+ids).then(({ data }) => {
                        let arr = data.data;
                        for (var i = 0; i < arr.length; i++) {
                            let candidateGroupItem = {};
                            candidateGroupItem.name = arr[i].name;
                            candidateGroupItem.id = arr[i].id;
                            candidateGroupItem.code = arr[i].code;
                            this.candidateGroupsList.push(candidateGroupItem);
                        }                       
                    });
                }
            }            
        },
        doSetCandidateGroupsValues(){//设置指定组人员数据至lcNodeAttrform.lcNodeCandidate[0]下面 用于保存使用
            this.lcNodeAttrform.lcNodeCandidate[0].candidateGroupId = "";//清空原组数据
            let array = [];
            let candidateGroupsList = this.candidateGroupsList;
            if(candidateGroupsList && candidateGroupsList.length> 0){
                for(var i in candidateGroupsList){
                    if(this.lcNodeAttrform.lcNodeCandidate[0].candidateGroupType == 0){//部门
                        array.push("DEPART:"+candidateGroupsList[i].id);
                    }
                    if(this.lcNodeAttrform.lcNodeCandidate[0].candidateGroupType == 1){//岗位
                        array.push("POST:"+candidateGroupsList[i].id);
                    }
                    if(this.lcNodeAttrform.lcNodeCandidate[0].candidateGroupType == 2){//角色
                        array.push("ROLE:"+candidateGroupsList[i].id);
                    }
                    if(this.lcNodeAttrform.lcNodeCandidate[0].candidateGroupType == 3){//表达式
                        array.push("BDS:"+candidateGroupsList[i].id);
                    }
                }
            }      
            if(array && array.length > 0){              
                this.lcNodeAttrform.lcNodeCandidate[0].candidateGroupId = array.join(",")
                // console.log("this.lcNodeAttrform.lcNodeCandidate[0].candidateGroupId",this.lcNodeAttrform.lcNodeCandidate[0].candidateGroupId);  
            }   
        },
        doSetCandidateValues(){//设置候选人人员数据至lcNodeAttrform.lcNodeCandidate[0]下面 用于保存使用
            this.lcNodeAttrform.lcNodeCandidate[0].candidateId = "";//清空原组数据
            let array = [];
            let candidateList = this.candidateList;
            if(candidateList && candidateList.length> 0){
                for(var i in candidateList){
                    array.push(candidateList[i].id);
                }
            }            
            if(array && array.length > 0){
                this.lcNodeAttrform.lcNodeCandidate[0].candidateId = array.join(",")
            }   
        },
    }
}
</script>
<style scoped>    
  ::-webkit-scrollbar {
    width: 10px;
    height: 10px;
    }
    ::-webkit-scrollbar-thumb {
    background-color: #f5f5f5;
    border-radius: 3px;
    }
</style>