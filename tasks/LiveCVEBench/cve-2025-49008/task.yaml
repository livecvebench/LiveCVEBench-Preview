instruction: |-
  Atheos is a self-hosted, browser-based cloud IDE that allows developers to code
  directly in their web browser with built-in Git integration for version control.

  Users have reported that when performing Git operations (fetch, pull, push) through
  the web interface, specially crafted repository URLs or branch names containing
  certain special characters cause unexpected behavior. In some cases, the application
  appears to execute unintended commands on the server.

  Reproduction steps:
  1. Log into Atheos as an authenticated user
  2. Navigate to a Git repository in the workspace
  3. Attempt a fetch/pull/push operation with a branch name like:
     "--upload-pack=echo test"
  4. Observe that "test" is echoed or arbitrary commands may execute

  The Git integration should properly handle all user input, treating branch names
  and remote URLs as literal strings rather than allowing them to be interpreted
  as command-line options. When users provide arguments that look like Git options
  (starting with "--"), they should be escaped or rejected, not executed.

  The application currently uses escapeshellcmd() for sanitization, but this function
  is insufficient for preventing argument injection attacks. A more robust approach
  is needed to ensure user input cannot be interpreted as command options.

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: security
tags:
  - php
  - command-injection
  - argument-injection
  - git
  - input-validation
parser_name: pytest
run_tests_in_same_shell: false
