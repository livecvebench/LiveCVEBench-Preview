instruction: |-
  I discovered a heap buffer overflow read vulnerability in PCRE2, a widely-used
  Perl Compatible Regular Expressions library.

  The vulnerability occurs when using the Scan Substring assertion `(*scs:...)`
  in combination with the `(*ACCEPT)` control verb. The regex matching engine
  fails to properly restore buffer boundaries after ACCEPT triggers inside an
  SCS block.

  For example, with the pattern `/(a)(b+)(*scs:(1)a(*ACCEPT))(\2)/` and the
  subject string `abbb`, the engine accesses memory beyond the allocated buffer
  when processing subsequent pattern elements like backreferences.

  When compiled with AddressSanitizer, this triggers a heap-buffer-overflow error.
  In production, this could lead to information disclosure as the out-of-bounds
  read results in corrupted match values that can be observed by an attacker.

  The expected fix should ensure all necessary state values (especially buffer
  boundaries) are properly restored when (*ACCEPT) is triggered inside an SCS
  assertion, similar to how other control flow paths handle state restoration.

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: security
tags:
  - c
  - regex
  - pcre2
  - heap-buffer-overflow
  - memory-safety

parser_name: pytest

run_tests_in_same_shell: false
