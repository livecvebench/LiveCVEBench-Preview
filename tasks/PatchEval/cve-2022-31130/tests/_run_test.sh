#!/bin/bash
# From ghcr.io/anonymous2578-data/cve-2022-31130:latest
# bash /workspace/fix-run.sh
set -e

cd /workspace/grafana
git apply --whitespace=nowarn /tests/test.patch 
cd pkg/util/proxyutil && go test -timeout 30s -run ^TestReverseProxy$ github.com/grafana/grafana/pkg/util/proxyutil

cd /workspace
#!/bin/bash
# From ghcr.io/anonymous2578-data/cve-2022-31130:latest
# bash /workspace/unit_test.sh
set -e

cd /workspace/grafana
cd pkg/util/proxyutil && go test -timeout 30s -run '^(TestMakePluginResourceRequest|TestMiddlewareBasicAuth|Test_GetPluginAssets|Test_PluginsInstallAndUninstall|TestMiddlewareContext|TestMiddlewareJWTAuth|TestReverseProxy|TestMiddleWareSecurityHeaders)$' github.com/grafana/grafana/pkg/util/proxyutil