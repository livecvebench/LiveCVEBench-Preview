instruction: |-
  I'm using copyparty v1.18.8 as a file server. I discovered a ReDoS (Regular
  Expression Denial of Service) vulnerability in the "Recent Uploads" page.

  When accessing the recent uploads page at `/?ru` or `/?ups`, the application
  allows users to filter results using a `filter` parameter. However, the filter
  value is directly compiled into a regular expression without any safeguards.

  For example:
  - Normal request: `/?ru&filter=test` - works fine
  - Malicious request: `/?ru&filter=(.+)+x` - server hangs indefinitely

  The pattern `(.+)+x` causes catastrophic backtracking when matching file paths
  that don't contain 'x'. With enough characters in the path, the regex engine
  enters exponential time complexity, freezing the server.

  I tested with file paths like `/data/aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa/testfile.dat`
  and the server became completely unresponsive.

  Expected behavior:
  - The filter parameter should not allow arbitrary regex patterns
  - Safe alternatives: substring match, prefix match (^), suffix match ($), exact match (^...$)
  - Malicious patterns should be rejected or handled without causing DoS

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: security
tags:
  - python
  - redos
  - denial-of-service
  - regex
  - web-application
parser_name: pytest
run_tests_in_same_shell: false
