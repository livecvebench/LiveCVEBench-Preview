cat <<'EOF' > /workspace/fix.patch
diff --git a/lib/context.js b/lib/context.js
index c95e363e..0949773b 100644
--- a/lib/context.js
+++ b/lib/context.js
@@ -187,7 +187,8 @@ class ResponseContext {
       returnTo = options.returnTo;
       debug('req.oidc.login() called with returnTo: %s', returnTo);
     } else if (req.method === 'GET' && req.originalUrl) {
-      returnTo = req.originalUrl;
+      // Collapse any leading slashes to a single slash to prevent Open Redirects
+      returnTo = req.originalUrl.replace(/^\/+/, '/');
       debug('req.oidc.login() without returnTo, using: %s', returnTo);
     }
 
 

EOF

cd /workspace/express-openid-connect
git apply --whitespace=nowarn  /workspace/fix.patch