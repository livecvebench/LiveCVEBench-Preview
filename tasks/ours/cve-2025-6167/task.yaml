instruction: |-
  I'm using a workflow management system that provides a REST API for creating
  and storing JSON workflow files. The application accepts workflow creation
  requests via:

  `POST /api/workflows`

  I discovered that the application uses the user-provided workflow ID directly
  in the file path without proper validation. For example, if a user submits
  a payload like:

  {
    "id": "../../tmp/malicious",
    "content": {}
  }

  The application writes the file to `/tmp/malicious.json` instead of the
  configured storage directory. This happens because the application blindly
  joins the configured storage path with the user input.

  This allows an attacker to write files to arbitrary locations on the file
  system (Directory Traversal), potentially leading to remote code execution
  or system corruption.

  Expected behavior:
  - Workflow IDs must be strictly validated before file operations
  - Reject IDs containing path traversal sequences (`..`) or directory separators (`/`, `\`)
  - Only allow alphanumeric characters, hyphens (`-`), and underscores (`_`)
  - The application should be immune to path traversal attacks

difficulty: medium
category: security
tags:
  - python
  - flask
  - path-traversal
  - input-validation
parser_name: pytest
run_tests_in_same_shell: false
