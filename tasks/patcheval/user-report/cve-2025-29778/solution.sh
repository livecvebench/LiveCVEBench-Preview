
cat <<'EOF' > fix.patch
diff --git a/pkg/cosign/cosign.go b/pkg/cosign/cosign.go
index 60ca41696666..10289ea2d304 100644
--- a/pkg/cosign/cosign.go
+++ b/pkg/cosign/cosign.go
@@ -534,7 +534,7 @@ func extractDigest(imgRef string, payload []payload.SimpleContainerImage) (strin
 }
 
 func matchSignatures(signatures []oci.Signature, subject, subjectRegExp, issuer, issuerRegExp string, extensions map[string]string) error {
-	if subject == "" && issuer == "" && len(extensions) == 0 {
+	if subject == "" && issuer == "" && subjectRegExp == "" && issuerRegExp == "" && len(extensions) == 0 {
 		return nil
 	}
 

EOF

cd /app/kyverno
git apply --whitespace=nowarn  /app/fix.patch
