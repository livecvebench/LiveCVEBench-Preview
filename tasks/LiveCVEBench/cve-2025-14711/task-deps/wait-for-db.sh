#!/bin/bash
# Wait for MySQL to be ready before starting Apache

set -e

host="db"
user="root"
password="root"

echo "Waiting for MySQL to be ready..."
for i in {1..60}; do
    if mysql -h"$host" -u"$user" -p"$password" -e "SELECT 1" > /dev/null 2>&1; then
        echo "MySQL is ready!"
        break
    fi
    echo "Waiting for MySQL... ($i/60)"
    sleep 2
done

# Execute the main command
exec "$@"
