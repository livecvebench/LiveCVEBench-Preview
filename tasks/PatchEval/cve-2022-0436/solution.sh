cat <<'EOF' > /workspace/fix.patch
diff --git a/lib/grunt/file.js b/lib/grunt/file.js
index 7e0e2fb7b..21f4ef29d 100644
--- a/lib/grunt/file.js
+++ b/lib/grunt/file.js
@@ -292,8 +292,11 @@ file.write = function(filepath, contents, options) {
 // Read a file, optionally processing its content, then write the output.
 // Or read a directory, recursively creating directories, reading files,
 // processing content, writing output.
+// Handles symlinks by coping them as files or directories.
 file.copy = function copy(srcpath, destpath, options) {
-  if (file.isDir(srcpath)) {
+  if (file._isSymbolicLink(srcpath)) {
+    file._copySymbolicLink(srcpath, destpath);
+  } else if (file.isDir(srcpath)) {
     // Copy a directory, recursively.
     // Explicitly create new dest directory.
     file.mkdir(destpath);
@@ -449,6 +452,24 @@ file.isPathCwd = function() {
   }
 };
 
+file._isSymbolicLink = function() {
+  var filepath = path.join.apply(path, arguments);
+  return fs.lstatSync(filepath).isSymbolicLink();
+};
+
+file._copySymbolicLink = function(srcpath, destpath) {
+  var destdir = path.join(destpath, '..');
+  var fileBase = path.basename(srcpath);
+  // Use the correct relative path for the symlink
+  if (!grunt.file.isPathAbsolute(srcpath)) {
+    srcpath = path.relative(destdir, srcpath) || '.';
+  }
+  file.mkdir(destdir);
+  var mode = grunt.file.isDir(srcpath) ? 'dir' : 'file';
+  var destpath = path.join(destpath, fileBase);
+  return fs.symlinkSync(srcpath, destpath, mode);
+};
+
 // Test to see if a filepath is contained within the CWD.
 file.isPathInCwd = function() {
   var filepath = path.join.apply(path, arguments);
   

EOF

cd /workspace/grunt
git apply --whitespace=nowarn  /workspace/fix.patch