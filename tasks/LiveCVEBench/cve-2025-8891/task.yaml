instruction: |-
  This is a WordPress site using the OceanWP theme, which includes AJAX-based
  functionality for managing admin notices and plugin installation.

  Users have reported that when they visit certain external websites while logged
  into their WordPress admin dashboard, unexpected actions occur - specifically,
  they notice that the Ocean Extra plugin gets installed or activated without
  their explicit consent.

  The theme's admin notice AJAX endpoints (such as those handling button clicks
  and dismissal actions) in the activation-notice API file appear to properly
  check user permissions with current_user_can(), yet these unintended actions
  still happen when administrators browse to external pages.

  Expected behavior: AJAX endpoints should only respond to intentional requests
  initiated from within the WordPress admin interface, not to requests triggered
  by external websites the admin happens to visit.

  The relevant code is located in the theme's inc/activation-notice/api.php file.
  Please investigate why these endpoints can be triggered by external pages and
  implement proper request validation to prevent unintended actions.

difficulty: medium
category: security
tags:
  - wordpress
  - php
  - ajax
  - request-validation
parser_name: pytest

run_tests_in_same_shell: false
max_test_timeout_sec: 600
max_agent_timeout_sec: 900
