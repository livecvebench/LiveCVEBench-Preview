instruction: |-
  This is Open5GS, an open source implementation of the 5G core network. The UPF
  (User Plane Function) component handles PFCP (Packet Forwarding Control Protocol)
  session management and GTP-U (GPRS Tunneling Protocol User Plane) traffic
  forwarding.

  When the UPF receives a PFCP Session Establishment Request containing a CreatePDR
  (Packet Detection Rule) with missing mandatory information elements, the request
  is improperly accepted. Subsequently, when GTP-U traffic arrives matching this
  malformed rule, the UPF process crashes with an assertion failure (SIGABRT).

  Specifically, when a CreatePDR is received without a required rule identifier in
  the forwarding configuration, the UPF stores an incomplete rule. Later, when
  data plane packets trigger this rule, the process encounters a null pointer and
  crashes with a message like:

      ogs_assert() failed at gtp-path.c:504

  The UPF should validate all mandatory Information Elements in the CreatePDR
  message according to the PFCP protocol specification (3GPP TS 29.244) and reject
  requests with missing mandatory fields by returning an appropriate PFCP error
  response (cause code: MANDATORY_IE_MISSING).

  The expected behavior is that malformed PFCP requests are rejected at the control
  plane with a proper error response, and the UPF remains operational regardless of
  what malformed requests are sent.

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: bug-fix
tags:
  - 5g
  - networking
  - input-validation
  - c
  - crash
parser_name: pytest

run_tests_in_same_shell: false
