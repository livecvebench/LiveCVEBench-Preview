instruction: |-
  I discovered an Authentication Bypass vulnerability in python-social-auth's
  Django integration that could lead to Account Takeover.

  When a new user attempts to sign up via social authentication and the user
  creation fails due to a database IntegrityError (e.g., duplicate email or
  username), the application's error handling has a critical flaw.

  Instead of properly rejecting the registration attempt, the code in
  `social_django/storage.py` (in the `DjangoUserMixin.create_user` method)
  catches the IntegrityError and then attempts to retrieve an existing user
  with matching attributes using `manager.get(**kwargs)`.

  This means an attacker can exploit this behavior:
  1. User A exists in the database with email "alice@example.com"
  2. Attacker initiates social authentication with the same email
  3. The database raises IntegrityError due to the unique constraint
  4. Instead of failing, the code silently returns User A
  5. The attacker is now authenticated as User A without knowing their password

  This bypasses the intended authentication pipeline and allows attackers to
  take over existing user accounts by simply knowing their email address.

  The expected fix is for the code to raise `AuthAlreadyAssociated` exception
  when user creation fails due to IntegrityError, instead of silently returning
  an existing user. This allows the authentication pipeline to handle the
  situation properly.

difficulty: medium
category: security
tags:
  - account-takeover
  - authentication-bypass
  - django
  - social-auth
  - error-handling
  - python
parser_name: pytest

run_tests_in_same_shell: false
