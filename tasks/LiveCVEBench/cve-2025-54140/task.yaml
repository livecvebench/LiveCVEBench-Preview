instruction: |-
  This application is pyLoad, a download manager that provides a web interface for
  managing file downloads from various sources.

  When adding a new download package through the web interface, users can upload a
  file containing download links. The issue is that filenames in the uploaded files
  are not properly validated before being used to construct file paths.

  When a user uploads a file with certain special characters in the filename (such
  as sequences like "../" or absolute paths), the file gets saved to unexpected
  locations on the filesystem instead of the designated storage directory. This
  can result in files being written outside the intended upload folder.

  For example, uploading a file with filename "../../../tmp/test.txt" causes the
  file to be created at /tmp/test.txt rather than inside the storage directory.

  We expect filenames to be sanitized so that uploaded files are always stored
  within the configured storage folder, regardless of what characters appear in
  the original filename.

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: security
tags:
  - python
  - flask
  - file-upload
  - input-validation
parser_name: pytest

run_tests_in_same_shell: false
