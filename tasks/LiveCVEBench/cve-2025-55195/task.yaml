instruction: |-
  I discovered a Prototype Pollution vulnerability in this TOML parser library.

  When I parse TOML files containing `__proto__` as a key name in table headers,
  the parsed values pollute JavaScript's Object.prototype. This affects ALL 
  subsequently created objects in the application.

  Here's how I can exploit this:

  const { parse } = require('./toml/parse.js');

  // I craft a malicious TOML with __proto__ table header
  parse('[__proto__.isAdmin]\nvalue = true');

  // Now ANY new object inherits the polluted property
  const user = {};
  console.log(user.isAdmin);  // { value: true } - SHOULD be undefined!
    The attack also works with:
  - Nested paths: `[foo.__proto__.bar]`
  - Array tables: `[[__proto__.items]]`
  - Deep nesting: `[__proto__.a.b.c]`

  This is a critical security issue because:
  1. I can bypass authentication checks (inject `isAdmin: true`)
  2. I can override default configurations
  3. I can cause denial of service by polluting critical prototype methods

  The parser should sanitize key names and prevent `__proto__`, `constructor`,
  and `prototype` from being used as object keys.

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: security
tags:
  - toml
  - parser
  - javascript
  - node
  - prototype-pollution
parser_name: pytest

run_tests_in_same_shell: false
