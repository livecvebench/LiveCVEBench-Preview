instruction: |-
  OpnForm is an open-source form builder application that allows teams to create
  and manage forms collaboratively. Workspaces provide team organization with
  role-based access control where admins can manage settings and regular users
  have read-only access.

  Users are reporting that read-only workspace members are able to modify workspace
  settings that should be restricted to administrators only. Specifically:

  1. When a user with 'user' role (non-admin) sends a PUT request to the
     `/api/open/workspaces/{id}/custom-domains` endpoint, the request succeeds
     with HTTP 200 instead of being rejected.

  2. Similarly, the `/api/open/workspaces/{id}/email-settings` endpoint allows
     modifications from non-admin users.

  This means any authenticated user who knows a workspace ID can change its
  custom domain configuration or email settings, bypassing the intended access
  controls.

  Expected behavior: Only workspace administrators should be able to modify
  custom domains and email settings. Non-admin users should receive a 403
  Forbidden response when attempting these operations.

  The codebase already has proper authorization infrastructure in place (the
  WorkspacePolicy class with adminAction method is used in other endpoints).
  Please fix the affected endpoints to properly enforce admin-only access.

difficulty: easy
category: security
tags:
  - authorization
  - access-control
  - laravel
  - php
  - api
parser_name: pytest

run_tests_in_same_shell: false
