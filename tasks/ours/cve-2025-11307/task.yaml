instruction: |-
  This WordPress site uses the WP Go Maps plugin to display OpenLayers-based maps
  with geocoding functionality. The plugin includes a Nominatim geocoding cache
  feature that stores location search results to improve performance.

  Users are reporting that after performing location searches on the maps, they
  see corrupted or unexpected content appearing on the page. For example, when
  searching for "Seoul" or other locations, the returned display names contain
  what appears to be raw HTML markup instead of clean location names. In some
  cases, browsers are displaying JavaScript alert popups or rendering broken
  images when the cached location data is displayed.

  The geocoding cache is stored via the AJAX endpoint at
  `/wp-admin/admin-ajax.php?action=wpgmza_store_nominatim_cache` and retrieved
  via `?action=wpgmza_query_nominatim_cache`. The cache stores the response
  data from the Nominatim service in the `wp_wpgmza_nominatim_geocode_cache`
  database table.

  The issue appears to be in the cache storage mechanism in the file
  `includes/open-layers/class.nominatim-geocode-cache.php`. The response data
  being stored should be validated and sanitized to ensure only clean,
  properly-formatted geocoding data is cached - not arbitrary content that
  could corrupt the display.

difficulty: medium
category: security
tags:
  - wordpress
  - php
  - input-validation
  - cache
parser_name: pytest
run_tests_in_same_shell: false
