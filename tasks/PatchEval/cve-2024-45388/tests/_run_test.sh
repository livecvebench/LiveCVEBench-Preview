#!/bin/bash
# From ghcr.io/anonymous2578-data/cve-2024-45388:latest
# bash /workspace/fix-run.sh
set -e

cd /workspace/hoverfly
git apply --whitespace=nowarn /tests/test.patch 
go test  -timeout 30s -run ^TestReadResponseBodyFile$ github.com/SpectoLabs/hoverfly/core

cd /workspace
#!/bin/bash
# From ghcr.io/anonymous2578-data/cve-2024-45388:latest
# bash /workspace/unit_test.sh
set -e

cd /workspace/hoverfly
go test -timeout 30s -run '^(Test_Identical_ReturnsFalseWithDifferentArrayOfSameLength|Test_SortQueryString_ReordersQueryValuesAlphabetically|Test_MinifyJson_ErrorsOnInvalidJsonString|Test_GetContentTypeFromHeaders_ReturnsEmptyStringIfHeadersAreNil|Test_Contains_ReturnsFalseWithContainingNoneOfValuesSpecified|Test_SortQueryString_ReordersQueryValuesNumerically|Test_Identical_ReturnsTrue_WithExactlySameArray|Test_MinifyXml_SimplifiesXmlString|Test_GetResponseBody_GettingTheResponseBodySetsTheSameBodyAgain|Test_SortQueryString_KeepsAsteriskInTact|Test_SortQueryString_PreservesEqualsAndEmptyValueQuery|Test_MinifyJson_MinifiesJsonString|Test_ContainsOnly_ReturnsTrueWithIdenticalArray|Test_GetContentTypeFromHeaders_ReturnsXmlIfXml|Test_Contains_ReturnsTrueWithContainingOneOfValues|Test_SortQueryString_PreservesBothEqualsAndNoEqualsWithEmptyValue|Test_CopyMap|Test_Identical_ReturnsFalseWithDifferentArrayOfDifferentLength|Test_GetContentTypeFromHeaders_ReturnsJsonIfJson|Test_Contains_ReturnsTrueWithContainingBothValues|Test_ContainsOnly_ReturnsTrueWithArrayContainingOnlyValuesWithDups|Test_GetContentTypeFromHeaders_ReturnsEmptyStringIfHeadersAreEmpty|Test_ContainsOnly_ReturnsFalseWithEmptyArrayMatcher|Test_GetResponseBody_GettingTheResponseBodyGetsTheCorrectData|Test_JSONMarshal_MarshalsIntoJson|Test_GetRequestBody_GettingTheRequestBodySetsTheSameBodyAgain|Test_ContainsOnly_ReturnsTrueWithArrayInDifferentOrder|Test_GetRequestBody_GettingTheRequestBodyGetsTheCorrectData|Test_SortQueryString_PreservesNoEqualsAndEmptyValueQuery|Test_MinifyXml_MinifiesXmlString|Test_ContainsOnly_ReturnsTrueWithSubsetOfValues|Test_SortQueryString_ReordersQueryStringAlphabetically|Test_ContainsOnly_ReturnFalseWithOneExtraValue|Test_Contains_ReturnsFalseWithEmptyArrayMatcher|Test_SortQueryString_ReordersQueryValuesAlphanumerically|Test_GetRequestBody_DecompressGzipContent)$' github.com/SpectoLabs/hoverfly/core/util