/**
 * Test helper for functionality tests of scale function.
 * Tests that scale behaves correctly for various non-function inputs.
 *
 * The scale function requires a context with scales registered.
 * When looking up non-existent scales, it should return undefined.
 */

// Import the scale function from the built package
const { scale } = require('/app/packages/vega-functions/build/vega-functions.js');

// Mock context with no scales registered
const mockContext = {
    scales: {}
};

// Create a mock 'this' context
const mockThis = {
    context: mockContext
};

const testCase = process.argv[2];

switch (testCase) {
    case 'nonexistent_scale':
        // Test that looking up a non-existent scale returns undefined
        const result1 = scale.call(mockThis, 'nonexistent_scale_name', 123);
        if (result1 === undefined) {
            console.log('PASS: undefined for nonexistent scale');
        } else {
            console.log(`FAIL: expected undefined, got ${result1}`);
        }
        break;

    case 'empty_string':
        // Test that empty string returns undefined
        const result2 = scale.call(mockThis, '', 123);
        if (result2 === undefined) {
            console.log('PASS: undefined for empty string');
        } else {
            console.log(`FAIL: expected undefined, got ${result2}`);
        }
        break;

    case 'null_value':
        // Test that null returns undefined
        const result3 = scale.call(mockThis, null, 123);
        if (result3 === undefined) {
            console.log('PASS: undefined for null');
        } else {
            console.log(`FAIL: expected undefined, got ${result3}`);
        }
        break;

    case 'number_value':
        // Test that a number returns undefined
        const result4 = scale.call(mockThis, 42, 123);
        if (result4 === undefined) {
            console.log('PASS: undefined for number');
        } else {
            console.log(`FAIL: expected undefined, got ${result4}`);
        }
        break;

    case 'object_value':
        // Test that an object returns undefined
        const result5 = scale.call(mockThis, { foo: 'bar' }, 123);
        if (result5 === undefined) {
            console.log('PASS: undefined for object');
        } else {
            console.log(`FAIL: expected undefined, got ${result5}`);
        }
        break;

    case 'array_value':
        // Test that an array returns undefined
        const result6 = scale.call(mockThis, [1, 2, 3], 123);
        if (result6 === undefined) {
            console.log('PASS: undefined for array');
        } else {
            console.log(`FAIL: expected undefined, got ${result6}`);
        }
        break;

    default:
        console.log(`Unknown test case: ${testCase}`);
        process.exit(1);
}
