instruction: |-
  This application is PubNet, a self-hosted Dart & Flutter package repository service
  (similar to pub.dev). It allows users to upload and host their own Dart packages.

  We've discovered a critical issue with the package upload functionality. When uploading
  a package to `/api/storage/upload`, I noticed that anyone can upload packages without
  logging in. Even worse, by including an `author-id` field in the form data, you can
  make the package appear as if it was uploaded by any user in the system!

  I tested this by sending a POST request with a package file and `author-id=1`, and
  it worked - the package got associated with user ID 1 even though I never authenticated.
  This seems like a huge security hole since anyone could publish malicious packages
  under another user's name.

  The expected behavior is that:
  1. Only logged-in users should be able to upload packages
  2. Users should only be able to upload packages as themselves, not impersonate others
  3. The system shouldn't trust client-provided author identity values

  Please fix the upload endpoint so that it properly validates who is uploading
  and doesn't allow this kind of identity spoofing.

difficulty: medium
category: security
tags:
  - authentication
  - authorization
  - api
  - dotnet
  - asp.net-core
parser_name: pytest

run_tests_in_same_shell: false
