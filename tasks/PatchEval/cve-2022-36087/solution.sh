cat <<'EOF' > /workspace/fix.patch
diff --git a/oauthlib/uri_validate.py b/oauthlib/uri_validate.py
index 8a6d9c27..a6fe0fb2 100644
--- a/oauthlib/uri_validate.py
+++ b/oauthlib/uri_validate.py
@@ -66,7 +66,7 @@
 )
 
 #   IPv6address
-IPv6address = r"([A-Fa-f0-9:]+:+)+[A-Fa-f0-9]+"
+IPv6address = r"([A-Fa-f0-9:]+[:$])[A-Fa-f0-9]{1,4}"
 
 #   IPvFuture     = "v" 1*HEXDIG "." 1*( unreserved / sub-delims / ":" )
 IPvFuture = r"v %(HEXDIG)s+ \. (?: %(unreserved)s | %(sub_delims)s | : )+" % locals()


EOF

cd /workspace/oauthlib
git apply --whitespace=nowarn  /workspace/fix.patch