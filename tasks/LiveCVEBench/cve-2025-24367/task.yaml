instruction: |-
  This application is a Cacti network monitoring server that uses RRDtool to
  generate graphs from time-series data.

  When configuring graph templates with special characters in label fields
  (e.g., right_axis_label), the application processes these values incorrectly
  if they contain line break characters (newline or carriage return). Instead
  of treating the entire value as a single label, the application appears to
  interpret each line as a separate command.

  For example, when a user sets a graph label to a multi-line string like:
    "Temperature
    Celsius"

  The graph generation fails with unexpected behavior, and in some cases,
  unintended files may be created in the web directory. This could happen if
  users copy-paste label text from external sources that include hidden line
  breaks.

  We expect the application to properly sanitize label inputs by removing or
  escaping line break characters before passing them to the graph generation
  system, ensuring that multi-line input is handled safely without causing
  unexpected side effects.

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: security
tags:
  - php
  - input-sanitization
  - rrdtool
  - cacti
parser_name: pytest

run_tests_in_same_shell: false
