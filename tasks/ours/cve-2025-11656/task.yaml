instruction: |-
  This is a School Management System web application built with PHP that allows
  administrators, teachers, and students to manage academic activities including
  uploading study materials as notes.

  Users have reported that they can access the notes editing endpoint
  (/assets/editNotes.php) without being logged in. When sending a POST request
  to this endpoint, the server accepts the request and processes file uploads
  even though there is no active session.

  Additionally, the file upload functionality accepts any file type including
  executable scripts. For example, when uploading a file named "test.php", the
  system saves it to the /notesUploads/ directory with its original extension
  preserved (as <timestamp>.php), and the file becomes directly accessible via
  the web server.

  Expected behavior:
  1. The editNotes.php endpoint should verify that a user is logged in before
     processing any requests. Unauthenticated requests should be rejected with
     an "Unauthorized" message.
  2. File uploads should only accept safe document types (PDF, DOC, DOCX, TXT)
     and common image formats (JPG, JPEG, PNG, GIF). Any other file types should
     be rejected with an "Invalid file type" message.

difficulty: medium
category: security
tags:
  - php
  - file-upload
  - authentication
  - input-validation
parser_name: pytest
