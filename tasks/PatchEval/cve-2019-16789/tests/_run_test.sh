#!/bin/bash
# From ghcr.io/anonymous2578-data/cve-2019-16789:latest
# bash /workspace/fix-run.sh
set -e

cd /workspace/waitress
git apply --whitespace=nowarn /tests/test.patch 
/workspace/PoC_env/CVE-2019-16789/bin/python -m pytest waitress/tests/test_parser.py -k "test_parse_header_invalid_whitespace_vtab or test_parse_header_invalid_no_colon or test_parse_header_invalid_folding_spacing or test_parse_header_invalid_chars or test_parse_header_empty or test_parse_header_multiple_values or test_parse_header_multiple_values_header_folded or test_parse_header_multiple_values_header_folded_multiple" --disable-warnings -v

cd /workspace
#!/bin/bash
# From ghcr.io/anonymous2578-data/cve-2019-16789:latest
# bash /workspace/unit_test.sh
set -e

cd /workspace/waitress
/workspace/PoC_env/CVE-2019-16789/bin/python -m pytest waitress/tests/test_parser.py -k "not test_parse_header_invalid_chars and not test_parse_header_invalid_folding_spacing and not test_parse_header_invalid_no_colon and not test_parse_header_invalid_whitespace and not test_parse_header_invalid_whitespace_vtab" --disable-warnings