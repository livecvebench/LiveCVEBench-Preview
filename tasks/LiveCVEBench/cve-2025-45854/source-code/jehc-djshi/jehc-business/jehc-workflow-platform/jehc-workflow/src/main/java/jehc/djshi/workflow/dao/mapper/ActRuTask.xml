<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="jehc.djshi.workflow.dao.ActRuTaskDao">

    <!--查询运行任务集合-->
    <select id="getActRuTaskListByCondition" resultType="jehc.djshi.workflow.model.ActRuTask" parameterType="map">
        SELECT
            ID_ AS id,
            REV_ AS rev,
            EXECUTION_ID_ AS executionId,
            PROC_INST_ID_ AS procInstId,
            PROC_DEF_ID_ AS procDefId,
            NAME_ AS name,
            PARENT_TASK_ID_ AS parentTaskId,
            DESCRIPTION_ AS description,
            TASK_DEF_KEY_ AS taskDefKey,
            OWNER_ AS owner,
            ASSIGNEE_ AS assignee,
            DELEGATION_ AS delegation,
            PRIORITY_ AS priority,
            CREATE_TIME_ AS createTime,
            DUE_DATE_ AS dueDate,
            CATEGORY_ AS category,
            TENANT_ID_ AS tenantId,
            FORM_KEY_ AS formKey,
            SUSPENSION_STATE_ AS suspensionState
        FROM
            act_ru_task
        WHERE 1=1
        <if test="null != id">
            AND ID_ = #{id}
        </if>
        <if test="null != parentId">
            AND PARENT_ID_ = #{parentId}
        </if>
        <if test="null != procInstId">
            AND PROC_INST_ID_ = #{procInstId}
        </if>
        <if test="null != procDefId">
            AND PROC_DEF_ID_ = #{procDefId}
        </if>
        <if test="null != executionId">
            AND EXECUTION_ID_ = #{executionId}
        </if>
        <if test="null != taskDefKey">
            AND TASK_DEF_KEY_ = #{taskDefKey}
        </if>
        <if test="null != name">
            AND NAME_ = #{name}
        </if>
    </select>

    <!--查询单个运行任务-->
    <select id="getActRuTaskById" resultType="jehc.djshi.workflow.model.ActRuTask" parameterType="map">
        SELECT
            ID_ AS id,
            REV_ AS rev,
            EXECUTION_ID_ AS executionId,
            PROC_INST_ID_ AS procInstId,
            PROC_DEF_ID_ AS procDefId,
            NAME_ AS name,
            PARENT_TASK_ID_ AS parentTaskId,
            DESCRIPTION_ AS description,
            TASK_DEF_KEY_ AS taskDefKey,
            OWNER_ AS owner,
            ASSIGNEE_ AS assignee,
            DELEGATION_ AS delegation,
            PRIORITY_ AS priority,
            CREATE_TIME_ AS createTime,
            DUE_DATE_ AS dueDate,
            CATEGORY_ AS category,
            TENANT_ID_ AS tenantId,
            FORM_KEY_ AS formKey,
            SUSPENSION_STATE_ AS suspensionState
        FROM
            act_ru_task
        WHERE ID_ = #{id}
    </select>

    <!--删除运行任务-->
    <delete id="delActRuTask" parameterType="string">
        DELETE FROM act_ru_task WHERE ID_ = #{id}
    </delete>

    <!--根据运行实例删除运行任务-->
    <delete id="delActRuTaskByExecutionId" parameterType="string">
        DELETE FROM act_ru_task WHERE EXECUTION_ID_ = #{id}
    </delete>

    <!--创建运行任务-->
    <insert id="addActRuTask" parameterType="jehc.djshi.workflow.model.ActRuTask">
        INSERT INTO
        ACT_RU_TASK
        (ID_,
        REV_,
        NAME_,
        PARENT_TASK_ID_,
        DESCRIPTION_,
        PRIORITY_,
        CREATE_TIME_,
        OWNER_,
        ASSIGNEE_,
        DELEGATION_,
        EXECUTION_ID_,
        PROC_INST_ID_,
        PROC_DEF_ID_,
        TASK_DEF_KEY_,
        DUE_DATE_,
        CATEGORY_,
        SUSPENSION_STATE_,
        TENANT_ID_,
        FORM_KEY_
        )
        VALUES
        (
        #{id},
        #{rev},
        #{name},
        #{parentTaskId},
        #{description},
        #{priority},
        #{createTime},
        #{owner},
        #{assignee},
        #{delegation},
        #{executionId},
        #{procInstId},
        #{procDefId},
        #{taskDefKey},
        #{dueDate},
        #{category},
        #{suspensionState},
        #{tenantId},
        #{formKey}
        )
    </insert>
</mapper>