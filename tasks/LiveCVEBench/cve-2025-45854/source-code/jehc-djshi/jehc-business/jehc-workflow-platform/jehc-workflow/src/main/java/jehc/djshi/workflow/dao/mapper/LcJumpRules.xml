<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="jehc.djshi.workflow.dao.LcJumpRulesDao">
	<!--初始化分页-->
	<select id="getLcJumpRulesListByCondition" resultType="jehc.djshi.workflow.model.LcJumpRules" parameterType="map">
		SELECT
			id,
			node_id AS nodeId,
			target_node_id AS targetNodeId,
			based_on_condition AS basedOnCondition,
			lc_node_attribute_id AS lcNodeAttributeId,
			conditions_,
			node_name AS nodeName,
			node_btn_id AS nodeBtnId
		FROM 
			lc_jump_rules
		WHERE 1=1
		  	AND del_flag = 0
			<if test="null != nodeId">
				AND node_id = #{nodeId}
			</if>
			<if test="null != targetNodeId">
				AND target_node_id = #{targetNodeId}
			</if>
			<if test="null != lcNodeAttributeId">
				AND lc_node_attribute_id = #{lcNodeAttributeId}
			</if>
			<if test="null != nodeBtnId">
				AND node_btn_id  = #{nodeBtnId}
			</if>
	</select>

	<!--查询对象-->
	<select id="getLcJumpRulesById" resultType="jehc.djshi.workflow.model.LcJumpRules" parameterType="string">
		SELECT
			id,
			node_id AS nodeId,
			target_node_id AS targetNodeId,
			based_on_condition AS basedOnCondition,
			lc_node_attribute_id AS lcNodeAttributeId,
			conditions_,
			node_name AS nodeName,
			node_btn_id AS nodeBtnId
		FROM 
			lc_jump_rules
		WHERE id=#{id}
	</select>

	<!--添加-->
	<insert id="addLcJumpRules" parameterType="jehc.djshi.workflow.model.LcJumpRules">
		INSERT INTO
			lc_jump_rules
			(
			id,
			node_id,
			target_node_id,
			based_on_condition,
			lc_node_attribute_id,
			conditions_,
			node_name,
			node_btn_id
			)
			VALUES
			(
			#{id},
			#{nodeId},
			#{targetNodeId},
			#{basedOnCondition},
			#{lcNodeAttributeId},
			#{conditions_},
			#{nodeName},
			#{nodeBtnId}
			)
	</insert>

	<!--修改-->
	<update id="updateLcJumpRules" parameterType="jehc.djshi.workflow.model.LcJumpRules">
		UPDATE
			lc_jump_rules
		SET
			node_id = #{nodeId},
			target_node_id = #{targetNodeId},
			based_on_condition = #{basedOnCondition},
			lc_node_attribute_id = #{lcNodeAttributeId},
			conditions_ = #{conditions_},
			node_name = #{nodeName},
			node_btn_id = #{nodeBtnId}
		WHERE jump_rules_id=#{jumpRulesId}
	</update>

	<!--修改（根据动态条件）-->
	<update id="updateLcJumpRulesBySelective" parameterType="jehc.djshi.workflow.model.LcJumpRules">
		UPDATE
			lc_jump_rules
		<set>
			<if test="nodeId != null">
				node_id = #{nodeId},
			</if>
			<if test="targetNodeId != null">
				target_node_id = #{targetNodeId},
			</if>
			<if test="basedOnCondition != null">
				based_on_condition = #{basedOnCondition},
			</if>
			<if test="lcNodeAttributeId != null">
				lc_node_attribute_id = #{lcNodeAttributeId},
			</if>
			<if test="conditions_ != null">
				conditions_ = #{conditions_},
			</if>
			<if test="nodeName != null">
				node_name = #{nodeName},
			</if>
			<if test="nodeBtnId != null">
				node_btn_id = #{nodeBtnId},
			</if>

		</set>
		WHERE id=#{id}
	</update>

	<!--删除-->
	<delete id="delLcJumpRules" parameterType="map">
		DELETE FROM lc_jump_rules WHERE id IN
		<foreach item="item" index="index" collection="id" open="(" separator="," close=")">
			#{item}
		</foreach>
	</delete>

	<!--根据属性id删除-->
	<delete id="delLcJumpRulesByAttributeId" parameterType="map">
		DELETE FROM lc_jump_rules WHERE 1=1
		<if test="null != nodeBtnId">
			AND node_btn_id  = #{nodeBtnId}
		</if>
		<if test="false == unNeedDelBtn">
			AND (node_btn_id = '' OR node_btn_id IS NULL)
		</if>
		<if test="true == unNeedDelBtn">
			AND node_btn_id != ''
		</if>
			AND lc_node_attribute_id = #{lcNodeAttributeId}
	</delete>

</mapper>