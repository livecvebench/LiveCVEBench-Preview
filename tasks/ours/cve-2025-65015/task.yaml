instruction: |-
  This application is a JOSE (JSON Object Signing and Encryption) library that handles
  JWT, JWS, and JWE tokens. It includes size validation to reject oversized tokens.

  When processing tokens with components that exceed the size limits (e.g., headers
  larger than 512 bytes, payloads larger than 8000 bytes), the library raises an
  ExceededSizeError exception. However, the error messages include the complete raw
  data of the oversized component.

  For example, when a 10KB header is rejected, the exception message contains all 10KB
  of data: "Header size of 'b'eyJhbGciOiJ...[entire content]...' exceeds 512 bytes."

  This is problematic because:
  1. When these exceptions are logged, the entire oversized content ends up in log files
  2. Error monitoring systems (like Sentry) receive and store the full content
  3. An attacker could intentionally send large tokens to fill disk space via logs
  4. The raw binary data in logs makes them harder to read and process

  The error messages should indicate which size limit was exceeded without including
  the actual content. For example: "Header size exceeds 512 bytes." instead of
  including the raw header data.

  This affects the size validation methods in:
  - JWS registry: validate_header_size, validate_payload_size, validate_signature_size
  - JWE registry: validate_protected_header_size, validate_encrypted_key_size,
    validate_initialization_vector_size, validate_ciphertext_size, validate_auth_tag_size

difficulty: easy
category: bug-fix
tags:
  - python
  - error-handling
  - logging
  - jose
  - jwt
parser_name: pytest

run_tests_in_same_shell: false
