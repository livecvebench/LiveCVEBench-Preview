#!/bin/bash
# From ghcr.io/anonymous2578-data/cve-2023-23947:latest
# bash /workspace/fix-run.sh
set -e

cd /workspace/argo-cd
git apply --whitespace=nowarn /tests/test.patch 
go test  -timeout 30s -run ^TestUpdateCluster_RejectInvalidParams$ github.com/argoproj/argo-cd/v2/server/cluster

cd /workspace
#!/bin/bash
# From ghcr.io/anonymous2578-data/cve-2023-23947:latest
# bash /workspace/unit_test.sh
set -e

cd /workspace/argo-cd
go test  -timeout 30s -run ^TestUpdateCluster_RejectInvalidParams$ github.com/argoproj/argo-cd/v2/server/cluster && go test -timeout 30s -run '^(TestDeleteClusterByName|TestRotateAuth|TestGetCluster_UrlEncodedName|TestGetCluster_NameWithUrlEncodingButShouldNotBeUnescaped|TestUpdateCluster_FieldsPathSet|TestUpdateCluster_NoFieldsPaths)$' github.com/argoproj/argo-cd/v2/server/cluster