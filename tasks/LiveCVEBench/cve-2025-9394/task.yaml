instruction: |-
  PoDoFo is a C++ library for reading, writing, and manipulating PDF documents. It includes
  command-line tools like podofoencrypt for encrypting PDF files.

  When processing certain malformed PDF files containing dictionary structures with invalid
  numeric values (e.g., values like "1.2.3.4.5" with multiple decimal points, or extremely
  large exponents like "1e999999999999"), the library crashes with memory errors. Users report
  seeing errors like "heap-use-after-free" or segmentation faults when running AddressSanitizer
  builds.

  The issue occurs during PDF dictionary parsing when the tokenizer encounters values that
  initially appear to be valid numbers (starting with digits, containing decimal points or
  exponents) but fail to parse as valid floating-point or integer values. In these cases, the
  parser exits the parsing function without properly cleaning up internal data structures.

  Expected behavior: The library should gracefully handle malformed numeric values by treating
  them as unknown tokens and continuing to parse the rest of the document without memory
  corruption.

  A sample malformed PDF that triggers the issue is available at /app/poc.pdf.

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: bug-fix
tags:
  - cpp
  - memory-safety
  - pdf-parsing
parser_name: pytest

run_tests_in_same_shell: false
