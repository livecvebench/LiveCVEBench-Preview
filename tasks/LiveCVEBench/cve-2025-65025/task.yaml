instruction: |-
  esm.sh is a no-build CDN for JavaScript modules that allows importing packages directly
  from HTTP URLs. The service downloads and extracts NPM package tarballs to serve modules.

  When extracting tarballs containing file entries with unusual path components (e.g.,
  entries like "package/../../../tmp/file.js"), files may be written to unexpected
  locations outside the designated extraction directory. This causes issues with package
  installation and can lead to files appearing in wrong directories.

  For example, if a tarball contains an entry "package/foo/../../../bar/test.js", after
  stripping the "package/" prefix and joining with the target directory, the resulting
  path escapes the intended destination.

  The tar extraction function in the server code needs to properly normalize file paths
  from archive entries before joining them with the destination directory. Extracted
  files should always remain within the designated output directory regardless of the
  path components in the archive entry names.

  The issue is in the ghInstall function in server/git.go where tarball entries are
  extracted without sanitizing the filename.

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: bug-fix
tags:
  - go
  - path-handling
  - tar-extraction
  - file-system
parser_name: pytest

run_tests_in_same_shell: false
max_test_timeout_sec: 120.0
