#!/bin/bash
set -e

cd /app/MechanicalSoup
git apply --whitespace=nowarn /tests/test.patch
/app/PoC_env/CVE-2023-34457/bin/python -m pytest tests/test_browser.py::test_enctype_and_file_submit tests/test_stateful_browser.py::test_upload_file_with_malicious_default tests/test_stateful_browser.py::test_upload_file tests/test_stateful_browser.py::test_upload_file_raise_on_string_input
/app/PoC_env/CVE-2023-34457/bin/python -m pytest tests/test_browser.py tests/test_stateful_browser.py -k "not test_enctype_and_file_submit and not test_upload_file and not test_select_form_associated_elements and not test_launch_browser" -p no:warning --disable-warnings
