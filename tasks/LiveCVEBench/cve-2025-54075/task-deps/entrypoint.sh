#!/bin/bash
# Entrypoint script for Nuxt application
# Supports restart capability for testing CVE fixes

cd /app

# Remove cached .nuxt directory to ensure clean builds
rm -rf .nuxt

# Run the dev server in a loop to support restart
while true; do
    echo "Starting Nuxt dev server..."
    npm run dev -- --host 0.0.0.0 --port 3000

    # If the server exits, wait briefly before restarting
    echo "Server stopped. Restarting in 2 seconds..."
    sleep 2
done
