cat <<'EOF' > /workspace/fix.patch
diff --git a/src/controller/org.controller/error.js b/src/controller/org.controller/error.js
index 822a42082..10538daf6 100644
--- a/src/controller/org.controller/error.js
+++ b/src/controller/org.controller/error.js
@@ -22,6 +22,13 @@ class OrgControllerError extends idrErr.IDRError {
     return err
   }
 
+  notAllowedToChangeOrganization () {
+    const err = {}
+    err.error = 'NOT_ALLOWED_TO_CHANGE_ORGANIZATION'
+    err.message = 'Only the Secretariat can change the organization for a user.'
+    return err
+  }
+
   orgExists (shortname) { // org
     const err = {}
     err.error = 'ORG_EXISTS'
diff --git a/src/controller/org.controller/org.controller.js b/src/controller/org.controller/org.controller.js
index 0673f06bd..b294d4957 100644
--- a/src/controller/org.controller/org.controller.js
+++ b/src/controller/org.controller/org.controller.js
@@ -501,6 +501,10 @@ async function updateUser (req, res, next) {
       } else if (key === 'org_shortname') {
         newOrgShortName = req.ctx.query.org_shortname
         changesRequirePrivilegedRole = true
+        if (!isSecretariat) {
+          logger.info({ uuid: req.ctx.uuid, message: 'The user could not be updated because ' + requesterUsername + ' is an Org Admin and tried to reassign the organization.' })
+          return res.status(403).json(error.notAllowedToChangeOrganization())
+        }
       } else if (key === 'name.first') {
         newUser.name.first = req.ctx.query['name.first']
       } else if (key === 'name.last') {
        

EOF

cd /workspace/cve-services
git apply --whitespace=nowarn  /workspace/fix.patch