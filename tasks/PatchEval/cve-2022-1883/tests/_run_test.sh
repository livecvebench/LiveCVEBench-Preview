#!/bin/bash
# From ghcr.io/anonymous2578-data/cve-2022-1883:latest
# bash /workspace/fix-run.sh
set -e

cd /workspace/terraboard
rm -rf ./db/db_test.go
git apply --whitespace=nowarn /tests/test.patch 
go test  -timeout 30s -run ^TestSearchAttribute_SQLInjectionProtection$ github.com/camptocamp/terraboard/db

cd /workspace
#!/bin/bash
# From ghcr.io/anonymous2578-data/cve-2022-1883:latest
# bash /workspace/unit_test.sh
set -e

cd /workspace/terraboard
go test  -timeout 30s -run '^(TestGetResourceIndex|TestMarshalAttributeValues|TestInsertState|TestUpdateStateWithLineage|TestUpdateStateWithoutLineage|TestUpdateStateFail|TestGetState|TestGetLineageActivity|TestInsertVersionCreated|TestKnownVersions|TestL istStatesVersions|TestListTerraformVersionsWithCount|TestListStateStats|TestListResourceTypes|TestList ResourceTypesWithCount|TestListResourceNames|TestListTfVersions|TestListAttributeKeys|TestInsertPlan|T estGetPlansSummary|TestGetPlan|TestGetPlans|TestGetLineages|TestDefaultVersion|TestClose)$' github.com/camptocamp/terraboard/db