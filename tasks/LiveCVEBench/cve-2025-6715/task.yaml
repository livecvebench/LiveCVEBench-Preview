instruction: |-
  This application is a WordPress site running the LatePoint booking plugin, which
  provides an appointment scheduling system for businesses. Users can manage their
  appointments via a customer portal page.

  When accessing the customer portal page with the "layout" parameter (used to
  customize page appearance), the application doesn't properly validate the
  parameter value. This allows arbitrary file paths to be specified, causing the
  application to load and execute PHP files from outside the intended layouts
  directory.

  For example, requests like "/customer-cabinet/?layout=../../../filename" can
  traverse the directory structure and include files from anywhere on the server.
  This exposes sensitive configuration files (including database credentials) and
  could allow execution of unintended PHP code.

  The expected behavior is that the layout parameter should only load layout files
  from the designated layouts directory, rejecting any path traversal sequences
  or invalid characters.

difficulty: medium
category: security
tags:
  - wordpress
  - php
  - path-traversal
  - file-inclusion
  - input-validation
parser_name: pytest
run_tests_in_same_shell: false
max_test_timeout_sec: 180
max_agent_timeout_sec: 600
