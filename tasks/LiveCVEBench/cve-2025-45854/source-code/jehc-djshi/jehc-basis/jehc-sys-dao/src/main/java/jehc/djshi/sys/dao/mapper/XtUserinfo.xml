<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="jehc.djshi.sys.dao.XtUserinfoDao">

	<!-- 根据用户名查找对象 -->
	<select id="getXtUserinfoByUserName" resultType="jehc.djshi.sys.model.XtUserinfo" parameterType="string">
		SELECT
			xt_userinfo.id,
			xt_userinfo.account,
			xt_userinfo.company_id AS companyId,
			xt_userinfo.depart_info_id AS departInfoId,
			xt_userinfo.post_id AS postId,
			xt_userinfo.name,
			xt_userinfo.address,
			xt_userinfo.state,
			xt_userinfo.image,
			xt_userinfo.phone,
			xt_userinfo.id_card AS idCard,
			xt_userinfo.sex,
			xt_userinfo.is_married AS isMarried,
			xt_userinfo.nation,
			xt_userinfo.native_place AS nativePlace,
			xt_userinfo.pic,
			xt_userinfo.mobile,
			xt_userinfo.in_time AS inTime,
			xt_userinfo.out_time AS outTime,
			xt_userinfo.contract_time AS contractTime,
			xt_userinfo.remark,
			xt_userinfo.birthday,
			xt_userinfo.qq,
			xt_userinfo.email,
			xt_userinfo.political,
			xt_userinfo.highest_degree AS highestDegree,
			xt_userinfo.school_name AS schoolName,
			xt_userinfo.work_year AS workYear,
			xt_departinfo.name AS departInfoName,
			xt_post.name AS postName
		FROM
			xt_userinfo xt_userinfo LEFT JOIN xt_post xt_post ON xt_userinfo.post_id = xt_post.id
									LEFT JOIN xt_departinfo xt_departinfo ON xt_userinfo.depart_info_id = xt_departinfo.id
		WHERE 1=1
		  AND xt_userinfo.account=#{account}
	</select>

	<!--初始化分页-->
	<select id="getXtUserinfoListByCondition" resultType="jehc.djshi.sys.model.XtUserinfo" parameterType="map">
		SELECT
			xt_userinfo.id,
			xt_userinfo.account,
			xt_userinfo.company_id AS companyId,
			xt_userinfo.depart_info_id AS departInfoId,
			xt_userinfo.post_id AS postId,
			xt_userinfo.name,
			xt_userinfo.address,
			xt_userinfo.state,
			xt_userinfo.image,
			xt_userinfo.phone,
			xt_userinfo.id_card AS idCard,
			xt_userinfo.sex,
			xt_userinfo.is_married AS isMarried,
			xt_userinfo.nation,
			xt_userinfo.native_place AS nativePlace,
			xt_userinfo.pic,
			xt_userinfo.mobile,
			xt_userinfo.in_time AS inTime,
			xt_userinfo.out_time AS outTime,
			xt_userinfo.contract_time AS contractTime,
			xt_userinfo.remark,
			xt_userinfo.birthday,
			xt_userinfo.qq,
			xt_userinfo.email,
			xt_userinfo.political,
			xt_userinfo.highest_degree AS highestDegree,
			xt_userinfo.school_name AS schoolName,
			xt_userinfo.work_year AS workYear,
			xt_departinfo.name AS departInfoName,
			xt_post.name AS postName
		FROM
			xt_userinfo xt_userinfo LEFT JOIN xt_post xt_post ON xt_userinfo.post_id = xt_post.id
			LEFT JOIN xt_departinfo xt_departinfo ON xt_userinfo.depart_info_id = xt_departinfo.id
		WHERE 1=1
			<if test="null != departInfoName and '' != departInfoName">
				AND xt_departinfo.name LIKE CONCAT(CONCAT('%',#{departInfoName}),'%')
			</if>
			<if test="null != postName and '' != postName">
				AND xt_post.name LIKE CONCAT(CONCAT('%',#{postName}),'%')
			</if>
			<if test="null != name and '' != name">
				AND xt_userinfo.name LIKE CONCAT(CONCAT('%',#{name}),'%')
			</if>
			<if test="null != account and '' != account">
				AND xt_userinfo.account LIKE CONCAT(CONCAT('%',#{account}),'%')
			</if>
			<if test="null != phone and '' != phone">
				AND xt_userinfo.phone LIKE CONCAT(CONCAT('%',#{phone}),'%')
			</if>
			<if test="null != idCard and '' != idCard">
				AND xt_userinfo.id_card = #{idCard}
			</if>
			<if test="null != email and '' != email">
				AND xt_userinfo.email LIKE CONCAT(CONCAT('%',#{email}),'%')
			</if>
			AND xt_userinfo.del_flag = 0
	</select>

	<!--已删除用户初始化分页-->
	<select id="getXtUserinfoDeletedListByCondition" resultType="jehc.djshi.sys.model.XtUserinfo" parameterType="map">
		SELECT
			xt_userinfo.id,
			xt_userinfo.account,
			xt_userinfo.company_id AS companyId,
			xt_userinfo.depart_info_id AS departInfoId,
			xt_userinfo.post_id AS postId,
			xt_userinfo.name,
			xt_userinfo.address,
			xt_userinfo.state,
			xt_userinfo.image,
			xt_userinfo.phone,
			xt_userinfo.id_card AS idCard,
			xt_userinfo.sex,
			xt_userinfo.is_married AS isMarried,
			xt_userinfo.nation,
			xt_userinfo.native_place AS nativePlace,
			xt_userinfo.pic,
			xt_userinfo.mobile,
			xt_userinfo.in_time AS inTime,
			xt_userinfo.out_time AS outTime,
			xt_userinfo.contract_time AS contractTime,
			xt_userinfo.remark,
			xt_userinfo.birthday,
			xt_userinfo.qq,
			xt_userinfo.email,
			xt_userinfo.political,
			xt_userinfo.highest_degree AS highestDegree,
			xt_userinfo.school_name AS schoolName,
			xt_userinfo.work_year AS workYear,
			xt_departinfo.name AS departInfoName,
			xt_post.name AS postName
		FROM
			xt_userinfo xt_userinfo LEFT JOIN xt_post xt_post ON xt_userinfo.post_id = xt_post.id
			LEFT JOIN xt_departinfo xt_departinfo ON xt_userinfo.depart_info_id = xt_departinfo.id
		WHERE 1=1
			AND xt_userinfo.del_flag = 1
			<if test="null != departInfoName and '' != departInfoName">
				AND xt_departinfo.name LIKE CONCAT(CONCAT('%',#{departInfoName}),'%')
			</if>
			<if test="null != postName and '' != postName">
				AND xt_post.name LIKE CONCAT(CONCAT('%',#{postName}),'%')
			</if>
			<if test="null != name and '' != name">
				AND xt_userinfo.name LIKE CONCAT(CONCAT('%',#{name}),'%')
			</if>
			<if test="null != account and '' != account">
				AND xt_userinfo.account LIKE CONCAT(CONCAT('%',#{account}),'%')
			</if>
			<if test="null != phone and '' != phone">
				AND xt_userinfo.phone LIKE CONCAT(CONCAT('%',#{phone}),'%')
			</if>
			<if test="null != idCard and '' != idCard">
				AND xt_userinfo.id_card = #{idCard}
			</if>
			<if test="null != email and '' != email">
				AND xt_userinfo.email LIKE CONCAT(CONCAT('%',#{email}),'%')
			</if>
	</select>
	<!--查询对象-->
	<select id="getXtUserinfoById" resultType="jehc.djshi.sys.model.XtUserinfo" parameterType="string">
		SELECT
			xt_userinfo.id,
			xt_userinfo.account,
			xt_userinfo.company_id AS companyId,
			xt_userinfo.depart_info_id AS departInfoId,
			xt_userinfo.post_id AS postId,
			xt_userinfo.name,
			xt_userinfo.address,
			xt_userinfo.state,
			xt_userinfo.image,
			xt_userinfo.phone,
			xt_userinfo.id_card AS idCard,
			xt_userinfo.sex,
			xt_userinfo.is_married AS isMarried,
			xt_userinfo.nation,
			xt_userinfo.native_place AS nativePlace,
			xt_userinfo.pic,
			xt_userinfo.mobile,
			xt_userinfo.in_time AS inTime,
			xt_userinfo.out_time AS outTime,
			xt_userinfo.contract_time AS contractTime,
			xt_userinfo.remark,
			xt_userinfo.birthday,
			xt_userinfo.qq,
			xt_userinfo.email,
			xt_userinfo.political,
			xt_userinfo.highest_degree AS highestDegree,
			xt_userinfo.school_name AS schoolName,
			xt_userinfo.work_year AS workYear,
			xt_departinfo.name AS departInfoName,
			xt_post.name AS postName
		FROM
			xt_userinfo xt_userinfo LEFT JOIN xt_post xt_post ON xt_userinfo.post_id = xt_post.id
									LEFT JOIN xt_departinfo xt_departinfo ON xt_userinfo.depart_info_id = xt_departinfo.id
		WHERE xt_userinfo.id=#{id}
	</select>

	<!--添加-->
	<insert id="addXtUserinfo" parameterType="jehc.djshi.sys.model.XtUserinfo">
		INSERT INTO
			xt_userinfo
		(
			id,
			company_id,
			depart_info_id,
			post_id,
			name,
			account,
			address,
			state,
			image,
			phone,
			id_card,
			sex,
			is_married,
			nation,
			native_place,
			pic,
			mobile,
			in_time,
			out_time,
			contract_time,
			remark,
			birthday,
			qq,
			email,
			political,
			highest_degree,
			school_name,
			work_year
		)
		VALUES
		(
			#{id},
			#{companyId},
			#{departInfoId},
			#{postId},
			#{name},
			#{account},
			#{address},
			#{state},
			#{image},
			#{phone},
			#{idCard},
			#{sex},
			#{isMarried},
			#{nation},
			#{nativePlace},
			#{pic},
			#{mobile},
			#{inTime},
			#{outTime},
			#{contractTime},
			#{remark},
			#{birthday},
			#{qq},
			#{email},
			#{political},
			#{highestDegree},
			#{schoolName},
			#{workYear}
		)
	</insert>

	<!--修改-->
	<update id="updateXtUserinfo" parameterType="jehc.djshi.sys.model.XtUserinfo">
		UPDATE
			xt_userinfo
		SET
			company_id = #{companyId},
			depart_info_id = #{departInfoId},
			post_id = #{postId},
			name = #{name},
			address = #{address},
			state = #{state},
			image = #{image},
			phone = #{phone},
			id_card = #{idCard},
			sex = #{sex},
			is_married = #{isMarried},
			nation = #{nation},
			native_place = #{nativePlace},
			pic = #{pic},
			mobile = #{mobile},
			in_time = #{inTime},
			out_time = #{outTime},
			contract_time = #{contractTime},
			remark = #{remark},
			birthday = #{birthday},
			qq = #{qq},
			email = #{email},
			political = #{political},
			highest_degree = #{highestDegree},
			school_name = #{schoolName},
			work_year = #{workYear}
		WHERE id=#{id}
	</update>

	<!--删除（废弃）-->
	<update id="delXtUserinfo" parameterType="map">
		UPDATE xt_userinfo SET del_flag = 1 WHERE id in
		<foreach item="item" index="index" collection="id" open="(" separator="," close=")">
			#{item}
		</foreach>
	</update>

	<!--恢复-->
	<update id="recoverXtUserinfo" parameterType="map">
		UPDATE xt_userinfo SET del_flag = 0 WHERE id in
		<foreach item="item" index="index" collection="id" open="(" separator="," close=")">
			#{item}
		</foreach>
	</update>

	<!--读取所有用户根据各种情况非分页-->
	<select id="getXtUserinfoListAllByCondition" resultType="jehc.djshi.sys.model.XtUserinfo" parameterType="map">
		SELECT
			xt_userinfo.id,
			xt_userinfo.account,
			xt_userinfo.company_id AS companyId,
			xt_userinfo.depart_info_id AS departInfoId,
			xt_userinfo.post_id AS postId,
			xt_userinfo.name,
			xt_userinfo.address,
			xt_userinfo.state,
			xt_userinfo.image,
			xt_userinfo.phone,
			xt_userinfo.id_card AS idCard,
			xt_userinfo.sex,
			xt_userinfo.is_married AS isMarried,
			xt_userinfo.nation,
			xt_userinfo.native_place AS nativePlace,
			xt_userinfo.pic,
			xt_userinfo.mobile,
			xt_userinfo.in_time AS inTime,
			xt_userinfo.out_time AS outTime,
			xt_userinfo.contract_time AS contractTime,
			xt_userinfo.remark,
			xt_userinfo.birthday,
			xt_userinfo.qq,
			xt_userinfo.email,
			xt_userinfo.political,
			xt_userinfo.highest_degree AS highestDegree,
			xt_userinfo.school_name AS schoolName,
			xt_userinfo.work_year AS workYear,
			xt_departinfo.name AS departInfoName,
			xt_post.name AS postName
		FROM
			xt_userinfo xt_userinfo LEFT JOIN xt_post xt_post ON xt_userinfo.post_id = xt_post.id
			LEFT JOIN xt_departinfo xt_departinfo ON xt_userinfo.depart_info_id = xt_departinfo.id
		WHERE 1=1
			<if test="null != departInfoId">
				AND xt_userinfo.depart_info_id = #{departInfoId}
			</if>
			<if test="null != postId">
				AND xt_userinfo.post_id = #{postId}
			</if>
			AND xt_userinfo.del_flag = 0
	</select>

	<!-- 用户名是否已经存在 -->
	<select id="validateUser" resultType="Integer" parameterType="map">
		SELECT
			COUNT(0)
		FROM
			xt_userinfo xt_userinfo
		WHERE account = #{account}
	</select>

	<!-- 根据各种情况查找集合不分页（流程设计器中处理人 发起人 发起人组及同步数据之授权中心等使用） -->
	<select id="getXtUserinfoList" parameterType="map" resultType="jehc.djshi.sys.model.XtUserinfo">
		SELECT
			xt_userinfo.id,
			xt_userinfo.account,
			xt_userinfo.company_id AS companyId,
			xt_userinfo.depart_info_id AS departInfoId,
			xt_userinfo.post_id AS postId,
			xt_userinfo.name,
			xt_userinfo.address,
			xt_userinfo.state,
			xt_userinfo.image,
			xt_userinfo.phone,
			xt_userinfo.id_card AS idCard,
			xt_userinfo.sex,
			xt_userinfo.is_married AS isMarried,
			xt_userinfo.nation,
			xt_userinfo.native_place AS nativePlace,
			xt_userinfo.pic,
			xt_userinfo.mobile,
			xt_userinfo.in_time AS inTime,
			xt_userinfo.out_time AS outTime,
			xt_userinfo.contract_time AS contractTime,
			xt_userinfo.remark,
			xt_userinfo.birthday,
			xt_userinfo.qq,
			xt_userinfo.email,
			xt_userinfo.political,
			xt_userinfo.highest_degree AS highestDegree,
			xt_userinfo.school_name AS schoolName,
			xt_userinfo.work_year AS workYear,
			xt_departinfo.name AS departInfoName,
			xt_post.name AS postName
		FROM
			xt_userinfo xt_userinfo LEFT JOIN xt_post xt_post ON xt_userinfo.post_id = xt_post.id
			LEFT JOIN xt_departinfo xt_departinfo ON xt_userinfo.depart_info_id = xt_departinfo.id
		WHERE 1=1
			<if test="null != id">
				AND xt_userinfo.id in
				<foreach item="item" index="index" collection="id" open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
			<if test="null != postId">
				AND xt_userinfo.post_id in
				<foreach item="item" index="index" collection="postId" open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
			<if test="null != departInfoId">
				AND xt_userinfo.depart_info_id in
				<foreach item="item" index="index" collection="departInfoId" open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
			AND xt_userinfo.del_flag = 0
	</select>
</mapper>