instruction: |-
  This is an OpenVPN CMS Flask application for managing OpenVPN users through a web
  interface.

  When creating a new OpenVPN user through the `/v1/openvpn` endpoint, there is a
  problem with how the application handles the username input. If a username contains
  certain special characters (like semicolons or pipes), the application behaves
  unexpectedly - in some cases, additional unintended commands appear to be executed
  on the system.

  For example, when a username like "test;id" or "user$(whoami)" is submitted, the
  server processes more than just the user creation - it appears that the characters
  after the semicolon or inside the $() are being interpreted as separate commands.

  We expect the application to safely handle any username input without executing
  unintended system commands. The user creation should either succeed with the given
  username (if valid) or return a proper validation error (if the username format is
  invalid), but never execute additional commands embedded in the input.

  Relevant files:
  - app/api/v1/openvpn.py (user creation logic)
  - app/libs/shell.py (shell command execution)
  - app/validators/forms.py (form validation)

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: security
tags:
  - flask
  - python
  - command-execution
  - input-validation
parser_name: pytest

run_tests_in_same_shell: false
