instruction: |-
  This application is a PHP web framework (Hush Framework) that provides utility
  functions for web application development. The utility class includes a hostname()
  method that retrieves the server hostname from various server variables.

  Users have reported that when requests contain unusual characters in the HTTP
  Host header, the application displays corrupted or unexpected output in pages
  that use the hostname for URL generation or display. For example, when the
  application generates links like `<a href="http://{hostname}/path">`, the
  resulting HTML can become malformed if the Host header contains special
  characters like angle brackets, quotes, or newlines.

  A specific symptom: when a load balancer or proxy forwards requests with
  non-standard Host headers, pages that display the hostname or use it in
  generated URLs can break the HTML structure, sometimes causing parts of the
  page to not render correctly or appearing as raw text.

  We expect the hostname() function to return only valid, safe hostname values
  that can be safely used in HTML output and URL generation without causing
  display issues or breaking the page structure.

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: bug-fix
tags:
  - php
  - input-validation
  - html-encoding
parser_name: pytest

run_tests_in_same_shell: false
