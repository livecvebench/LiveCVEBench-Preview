instruction: |-
  I'm using a JavaScript SDK that provides an iframe-based popup interface for
  connecting to financial services. The SDK has an `openLink()` function that
  accepts a base64-encoded URL token.

  I noticed that the SDK doesn't seem to validate what kind of URL is being
  decoded. When I accidentally passed a malformed token that decoded to a
  non-HTTP URL (like starting with "javascript:" or "data:"), the SDK still
  tried to load it in the iframe instead of rejecting it.

  This seems wrong - the SDK should only accept valid web URLs (http:// or
  https://) and reject anything else. Right now it just blindly uses whatever
  URL is decoded from the base64 token.

  Can you investigate why URL validation isn't happening and add proper checks
  to prevent non-HTTP protocols from being loaded?

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: security
tags:
  - javascript
  - input-validation
  - url-validation
  - sdk
parser_name: pytest

run_tests_in_same_shell: false
