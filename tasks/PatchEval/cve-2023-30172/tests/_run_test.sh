#!/bin/bash
# From ghcr.io/anonymous2578-data/cve-2023-30172:latest
# bash /workspace/fix-run.sh
set -e
export PATH="/workspace/PoC_env/CVE-2023-30172/bin:$PATH"
cd /workspace/mlflow
git apply --whitespace=nowarn /tests/test.patch 
/workspace/PoC_env/CVE-2023-30172/bin/python -m pytest tests/tracking/test_rest_tracking.py::test_path_validation tests/tracking/test_rest_tracking.py::test_validate_path_is_safe_good tests/tracking/test_rest_tracking.py::test_validate_path_is_safe_bad

cd /workspace
#!/bin/bash
# From ghcr.io/anonymous2578-data/cve-2023-30172:latest
# bash /workspace/unit_test.sh
set -e
export PATH="/workspace/PoC_env/CVE-2023-30172/bin:$PATH"
cd /workspace/mlflow
/workspace/PoC_env/CVE-2023-30172/bin/python -m pytest tests/tracking/test_rest_tracking.py -k "not test_log_model[file] and not test_log_model[sqlalchemy] and not test_artifacts[file] and not test_artifacts[sqlalchemy]" -p no:warning --disable-warnings