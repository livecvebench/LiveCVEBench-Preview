diff --git a/test/strip-absolute-path.js b/test/strip-absolute-path.js
index beb057ff..c50e2858 100644
--- a/test/strip-absolute-path.js
+++ b/test/strip-absolute-path.js
@@ -1,14 +1,52 @@
 const t = require('tap')
 const stripAbsolutePath = require('../lib/strip-absolute-path.js')
+const cwd = process.cwd()
+const requireInject = require('require-inject')
 
-const cases = {
-  '/': ['/', ''],
-  '////': ['////', ''],
-  'c:///a/b/c': ['c:///', 'a/b/c'],
-  '\\\\foo\\bar\\baz': ['\\\\foo\\bar\\', 'baz'],
-  '//foo//bar//baz': ['//', 'foo//bar//baz'],
-  'c:\\c:\\c:\\c:\\\\d:\\e/f/g': ['c:\\c:\\c:\\c:\\\\d:\\', 'e/f/g'],
-}
+t.only('basic', t => {
+  const cases = {
+    '/': ['/', ''],
+    '////': ['////', ''],
+    'c:///a/b/c': ['c:///', 'a/b/c'],
+    '\\\\foo\\bar\\baz': ['\\\\foo\\bar\\', 'baz'],
+    '//foo//bar//baz': ['//', 'foo//bar//baz'],
+    'c:\\c:\\c:\\c:\\\\d:\\e/f/g': ['c:\\c:\\c:\\c:\\\\d:\\', 'e/f/g'],
+  }
 
-for (const [input, [root, stripped]] of Object.entries(cases))
-  t.strictSame(stripAbsolutePath(input), [root, stripped], input)
+  for (const [input, [root, stripped]] of Object.entries(cases))
+    t.strictSame(stripAbsolutePath(input, cwd), [root, stripped], input)
+  t.end()
+})
+
+t.only('drive-local paths', t => {
+  const env = process.env
+  t.teardown(() => process.env = env)
+  const cwd = 'D:\\safety\\land'
+  const realPath = require('path')
+  // be windowsy
+  const path = {
+    ...realPath.win32,
+    win32: realPath.win32,
+    posix: realPath.posix,
+  }
+  const stripAbsolutePath = requireInject('../lib/strip-absolute-path.js', { path })
+  const cases = {
+    '/': ['/', ''],
+    '////': ['////', ''],
+    'c:///a/b/c': ['c:///', 'a/b/c'],
+    '\\\\foo\\bar\\baz': ['\\\\foo\\bar\\', 'baz'],
+    '//foo//bar//baz': ['//', 'foo//bar//baz'],
+    'c:\\c:\\c:\\c:\\\\d:\\e/f/g': ['c:\\c:\\c:\\c:\\\\d:\\', 'e/f/g'],
+    'c:..\\system\\explorer.exe': ['c:', '..\\system\\explorer.exe'],
+    'd:..\\..\\unsafe\\land': ['d:', '..\\..\\unsafe\\land'],
+    'c:foo': ['c:', 'foo'],
+    'D:mark': ['D:', 'mark'],
+    '//?/X:/y/z': ['//?/X:/', 'y/z'],
+    '\\\\?\\X:\\y\\z': ['\\\\?\\X:\\', 'y\\z'],
+  }
+  for (const [input, [root, stripped]] of Object.entries(cases)) {
+    if (!t.strictSame(stripAbsolutePath(input, cwd), [root, stripped], input))
+      break
+  }
+  t.end()
+})
