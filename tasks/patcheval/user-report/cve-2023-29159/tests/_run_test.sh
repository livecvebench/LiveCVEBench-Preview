#!/bin/bash
set -e

cd /app/starlette
git apply --whitespace=nowarn /tests/test.patch
/app/PoC_env/CVE-2023-29159/bin/python -m pytest tests/test_staticfiles.py::test_staticfiles_avoids_path_traversal tests/test_staticfiles.py::test_staticfiles_with_pathlib
/app/PoC_env/CVE-2023-29159/bin/python -m pytest tests/test_staticfiles.py -v -k "not test_staticfiles_with_invalid_dir_permissions_returns_401" 
