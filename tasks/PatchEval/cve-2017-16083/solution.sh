cat <<'EOF' > /workspace/fix.patch
diff --git a/lib/router.js b/lib/router.js
index be232b9..d8f8e30 100644
--- a/lib/router.js
+++ b/lib/router.js
@@ -351,7 +351,6 @@
       resp = {
         "multipart-data": []
       };
-      // boundary = content_type.split(/;\s+/)[1].split('=')[1].trim();
       boundary = content_type.split(/;\s+/)[1];
       if (boundary) {
         boundary = boundary.split('=')[1];
@@ -390,10 +389,10 @@
                 obj.fileLen = obj.fileData.length;
               }
               resp['multipart-data'].push(obj);
-            }   
+            }
           }
         }
-      } 
+      }
       return resp;
     };
     _bodyparser = function(body, contentType) {
@@ -731,6 +730,9 @@
     dispatch["static"] = function(pathname, req, res) {
       var full_path;
       full_path = "" + dispatch.static_route + (unescape(pathname));
+      if (full_path.indexOf('..') !== -1) {
+        return dispatch._403(null, res, pathname, "Trying to get private things through directory traversal is a nasty thing to do.");
+      }
       return fs.exists(full_path, function(exists) {
         var e, error;
         if (exists) {
@@ -1274,6 +1276,12 @@
         }
       });
     };
+    dispatch._403 = function(req, res, path, message) {
+      res.writeHead(500, {
+        'Content-Type': 'text/html'
+      });
+      return res.end("<h2>403 - Forbidden: " + message + "</h2>\n<hr/><h3>Served by " + dispatch.served_by + " v" + dispatch.version + "</h3>\n<p style=\"text-align: center;\"><button onclick='history.back();'>Back</button></p>");
+    };
     dispatch._405 = function(req, res, path, message) {
       res.writeHead(405, {
         'Content-Type': 'text/html'
         

EOF

cd /workspace/node-simple-router
git apply --whitespace=nowarn  /workspace/fix.patch