#!/bin/bash
# From ghcr.io/anonymous2578-data/cve-2021-21432:latest
# bash /workspace/fix-run.sh
set -e

cd /workspace/server
git apply --whitespace=nowarn /tests/test.patch 
go test  -timeout 30s -run ^TestGithub_Authenticate_Vela_Token$ github.com/go-vela/server/source/github

cd /workspace
#!/bin/bash
# From ghcr.io/anonymous2578-data/cve-2021-21432:latest
# bash /workspace/unit_test.sh
set -e

cd /workspace/server
go test -timeout 30s -run '^(TestGithub_Authorize_NotFound|TestGithub_Authenticate|TestGithub_Authenticate_NoCode|TestGithub_LoginWCreds|TestGithub_Authenticate_NoState|TestGithub_Authorize|TestGithub_Authenticate_Invalid_Token|TestGithub_Login|TestGithub_Authenticate_NotFound|TestGithub_Authenticate_BadToken|TestGithub_Authenticate_Token)$' github.com/go-vela/server/source/github