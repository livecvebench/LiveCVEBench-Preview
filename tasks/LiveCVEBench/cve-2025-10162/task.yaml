instruction: |-
  This is a WordPress plugin called "OrderConvo" that allows customers and admins to
  exchange messages after placing orders in WooCommerce. The plugin includes a file
  download feature that lets users download attachments from message threads.

  Users have reported that the file download endpoint (/wp-json/wooconvo/v1/download-file)
  allows access to files outside the intended upload directory. When providing a filename
  parameter like "../../../../wp-config.php" or "../../../../../../../etc/passwd", the
  system serves those files instead of returning an error.

  For example, a request to:
  /wp-json/wooconvo/v1/download-file?order_id=1&filename=../../../../wp-config.php

  Returns the contents of wp-config.php rather than only allowing downloads from the
  plugin's designated upload folder (wp-content/uploads/wooconvo/).

  The expected behavior is that the download endpoint should only serve files that are
  legitimately stored within the plugin's upload directory for that specific order.
  Any attempts to navigate outside this directory using path sequences should be
  rejected with an appropriate error message.

author_name: HIT-SCIR-LACG
author_email: xzluo@ir.hit.edu.cn

difficulty: medium
category: bug-fix
tags:
  - php
  - wordpress
  - input-validation
  - file-handling
parser_name: pytest

run_tests_in_same_shell: false
